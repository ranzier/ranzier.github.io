

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/about/dogs.jpg">
  <link rel="icon" href="/img/about/dogs.jpg">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="ranzier">
  <meta name="keywords" content="">
  
    <meta name="description" content="SpringCloudÂæÆÊúçÂä°Â≠¶‰π†Á¨îËÆ∞   ‰∏Ä. MybatisPlus1. Âø´ÈÄüÂÖ•Èó®ÂÆûÁé∞Ê≠•È™§Ôºö  ÂºïÂÖ•MybatisPlus‰æùËµñ ÂÆö‰πâMapper  1.1 ÂºïÂÖ•‰æùËµñ12345&lt;dependency&gt;    &lt;groupId&gt;com.baomidou&lt;&#x2F;groupId&gt;    &lt;artifactId&gt;mybatis-plus-boot-starter">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringCloudÂ≠¶‰π†Á¨îËÆ∞">
<meta property="og:url" content="http://example.com/2025/04/04/JAVA/SpringCloud/SpringCloud/index.html">
<meta property="og:site_name" content="RANZIER">
<meta property="og:description" content="SpringCloudÂæÆÊúçÂä°Â≠¶‰π†Á¨îËÆ∞   ‰∏Ä. MybatisPlus1. Âø´ÈÄüÂÖ•Èó®ÂÆûÁé∞Ê≠•È™§Ôºö  ÂºïÂÖ•MybatisPlus‰æùËµñ ÂÆö‰πâMapper  1.1 ÂºïÂÖ•‰æùËµñ12345&lt;dependency&gt;    &lt;groupId&gt;com.baomidou&lt;&#x2F;groupId&gt;    &lt;artifactId&gt;mybatis-plus-boot-starter">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/bg/32.jpg">
<meta property="article:published_time" content="2025-04-04T02:38:09.000Z">
<meta property="article:modified_time" content="2025-10-14T03:58:51.450Z">
<meta property="article:author" content="ranzier">
<meta property="article:tag" content="JAVA">
<meta property="article:tag" content="SpringCloud">
<meta property="article:tag" content="Â≠¶‰π†">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://example.com/img/bg/32.jpg">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>SpringCloudÂ≠¶‰π†Á¨îËÆ∞ - RANZIER</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- ‰∏ªÈ¢ò‰æùËµñÁöÑÂõæÊ†áÂ∫ìÔºå‰∏çË¶ÅËá™Ë°å‰øÆÊîπ -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="//at.alicdn.com/t/c/font_3846514_kabxni94auf.css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/bynotes/texiao/source/css/shubiao.css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/bynotes/texiao/source/css/gundongtiao.css">
<link rel="stylesheet" href="/css/bubble.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"üåü","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 8.0.0"></head>


<body><!-- hexo injector body_begin start --><div id="web_bg"></div><!-- hexo injector body_begin end -->
  

  <header>
    

<div class="header-inner" style="height: 80vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>RANZIER</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>È¶ñÈ°µ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>ÂΩíÊ°£</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>ÂàÜÁ±ª</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Ê†áÁ≠æ</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>ÂÖ≥‰∫é</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/bg/3.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.35)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="SpringCloudÂ≠¶‰π†Á¨îËÆ∞"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-04-04 10:38" pubdate>
          2025Âπ¥4Êúà4Êó• ‰∏äÂçà
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          28k Â≠ó
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          139 ÂàÜÈíü
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          Êú¨ÊñáÈòÖËØªÊ¨°Êï∞Ôºö<span id="busuanzi_value_page_pv"></span> Ê¨°
        </span>
        

      
    
  </div>


        
      </div>

      
        <div class="scroll-down-bar">
          <i class="iconfont icon-arrowdown"></i>
        </div>
      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">SpringCloudÂ≠¶‰π†Á¨îËÆ∞</h1>
            
            
              <div class="markdown-body">
                
                <h1 align="center">SpringCloudÂæÆÊúçÂä°Â≠¶‰π†Á¨îËÆ∞</h1>


<h1 id="‰∏Ä-MybatisPlus"><a href="#‰∏Ä-MybatisPlus" class="headerlink" title="‰∏Ä. MybatisPlus"></a>‰∏Ä. MybatisPlus</h1><h2 id="1-Âø´ÈÄüÂÖ•Èó®"><a href="#1-Âø´ÈÄüÂÖ•Èó®" class="headerlink" title="1. Âø´ÈÄüÂÖ•Èó®"></a>1. Âø´ÈÄüÂÖ•Èó®</h2><p>ÂÆûÁé∞Ê≠•È™§Ôºö</p>
<ul>
<li>ÂºïÂÖ•MybatisPlus‰æùËµñ</li>
<li>ÂÆö‰πâMapper</li>
</ul>
<h3 id="1-1-ÂºïÂÖ•‰æùËµñ"><a href="#1-1-ÂºïÂÖ•‰æùËµñ" class="headerlink" title="1.1 ÂºïÂÖ•‰æùËµñ"></a>1.1 ÂºïÂÖ•‰æùËµñ</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.baomidou<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.5.3.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="1-2-ÂÆö‰πâMapper"><a href="#1-2-ÂÆö‰πâMapper" class="headerlink" title="1.2 ÂÆö‰πâMapper"></a>1.2 ÂÆö‰πâMapper</h3><ul>
<li>MybatisPlusÊèê‰æõ‰∫Ü‰∏Ä‰∏™Âü∫Á°ÄÁöÑBaseMapperÊé•Âè£</li>
<li>‰øÆÊîπmp-demo‰∏≠ÁöÑcom.itheima.mp.mapperÂåÖ‰∏ãÁöÑUserMapperÊé•Âè£ÔºåËÆ©ÂÖ∂ÁªßÊâøBaseMapperÔºö</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;User&gt; &#123;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="2-Â∏∏ËßÅÊ≥®Ëß£"><a href="#2-Â∏∏ËßÅÊ≥®Ëß£" class="headerlink" title="2. Â∏∏ËßÅÊ≥®Ëß£"></a>2. Â∏∏ËßÅÊ≥®Ëß£</h2><h3 id="2-1-ÈªòËÆ§ÊÉÖÂÜµ"><a href="#2-1-ÈªòËÆ§ÊÉÖÂÜµ" class="headerlink" title="2.1 ÈªòËÆ§ÊÉÖÂÜµ"></a>2.1 ÈªòËÆ§ÊÉÖÂÜµ</h3><p>MybatisPlusÂ∞±ÊòØÊ†πÊçÆPOÂÆû‰ΩìÁöÑ‰ø°ÊÅØÊù•Êé®Êñ≠Âá∫Ë°®ÁöÑ‰ø°ÊÅØÔºå‰ªéËÄåÁîüÊàêSQLÁöÑ„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºö</p>
<ul>
<li>MybatisPlus‰ºöÊääPOÂÆû‰ΩìÁöÑÁ±ªÂêçÈ©ºÂ≥∞ËΩ¨‰∏ãÂàíÁ∫ø‰Ωú‰∏∫Ë°®Âêç</li>
<li>MybatisPlus‰ºöÊääPOÂÆû‰ΩìÁöÑÊâÄÊúâÂèòÈáèÂêçÈ©ºÂ≥∞ËΩ¨‰∏ãÂàíÁ∫ø‰Ωú‰∏∫Ë°®ÁöÑÂ≠óÊÆµÂêçÔºåÂπ∂Ê†πÊçÆÂèòÈáèÁ±ªÂûãÊé®Êñ≠Â≠óÊÆµÁ±ªÂûã</li>
<li>MybatisPlus‰ºöÊääÂêç‰∏∫idÁöÑÂ≠óÊÆµ‰Ωú‰∏∫‰∏ªÈîÆ</li>
</ul>
<h3 id="2-2-TableName"><a href="#2-2-TableName" class="headerlink" title="2.2 @TableName"></a>2.2 @TableName</h3><ul>
<li>ÊèèËø∞ÔºöË°®ÂêçÊ≥®Ëß£ÔºåÊ†áËØÜÂÆû‰ΩìÁ±ªÂØπÂ∫îÁöÑË°®</li>
<li>‰ΩøÁî®‰ΩçÁΩÆÔºöÂÆû‰ΩìÁ±ª</li>
</ul>
<h3 id="2-3-TableId"><a href="#2-3-TableId" class="headerlink" title="2.3 @TableId"></a>2.3 @TableId</h3><ul>
<li>ÊèèËø∞Ôºö‰∏ªÈîÆÊ≥®Ëß£ÔºåÊ†áËØÜÂÆû‰ΩìÁ±ª‰∏≠ÁöÑ‰∏ªÈîÆÂ≠óÊÆµ</li>
<li>‰ΩøÁî®‰ΩçÁΩÆÔºöÂÆû‰ΩìÁ±ªÁöÑ‰∏ªÈîÆÂ≠óÊÆµ</li>
</ul>
<p>IdTypeÂ±ûÊÄßÁöÑÂ∏∏ËßÅÂÄºÔºö</p>
<ul>
<li>AUTOÔºöÂà©Áî®Êï∞ÊçÆÂ∫ìÁöÑidËá™Â¢ûÈïø</li>
<li>INPUTÔºöÊâãÂä®ÁîüÊàêid</li>
<li>ASSIGN_IDÔºöÈõ™Ëä±ÁÆóÊ≥ïÁîüÊàêLongÁ±ªÂûãÁöÑÂÖ®Â±ÄÂîØ‰∏ÄidÔºåËøôÊòØÈªòËÆ§ÁöÑIDÁ≠ñÁï•</li>
</ul>
<h3 id="2-4-TableField"><a href="#2-4-TableField" class="headerlink" title="2.4 @TableField"></a>2.4 @TableField</h3><p>ÊôÆÈÄöÂ≠óÊÆµÊ≥®Ëß£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@TableName(&quot;user&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">User</span> &#123;<br>    <span class="hljs-meta">@TableId</span><br>    <span class="hljs-keyword">private</span> Long id;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-meta">@TableField(is_married&quot;)</span><br>    <span class="hljs-keyword">private</span> Boolean isMarried;<br>    <span class="hljs-meta">@TableField(&quot;`concat`&quot;)</span><br>    <span class="hljs-keyword">private</span> String concat;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Ê∑ªÂä†@TableFieldÊ≥®Ëß£ÁöÑ‰∏Ä‰∫õÁâπÊÆäÊÉÖÂÜµÔºö</p>
<ul>
<li>ÊàêÂëòÂèòÈáèÂêç‰∏éÊï∞ÊçÆÂ∫ìÂ≠óÊÆµÂêç‰∏ç‰∏ÄËá¥</li>
<li>ÊàêÂëòÂèòÈáèÊòØ‰ª•isXXXÂëΩÂêçÔºåÊåâÁÖßJavaBeanÁöÑËßÑËåÉÔºåMybatisPlusËØÜÂà´Â≠óÊÆµÊó∂‰ºöÊääisÂéªÈô§ÔºåËøôÂ∞±ÂØºËá¥‰∏éÊï∞ÊçÆÂ∫ì‰∏çÁ¨¶„ÄÇ</li>
<li>ÊàêÂëòÂèòÈáèÂêç‰∏éÊï∞ÊçÆÂ∫ì‰∏ÄËá¥Ôºå‰ΩÜÊòØ‰∏éÊï∞ÊçÆÂ∫ìÁöÑÂÖ≥ÈîÆÂ≠óÂÜ≤Á™Å„ÄÇ‰ΩøÁî®@TableFieldÊ≥®Ëß£ÁªôÂ≠óÊÆµÂêçÊ∑ªÂä†ËΩ¨‰πâÂ≠óÁ¨¶Ôºö&#96;&#96;</li>
</ul>
<h2 id="3-Ê†∏ÂøÉÂäüËÉΩ"><a href="#3-Ê†∏ÂøÉÂäüËÉΩ" class="headerlink" title="3. Ê†∏ÂøÉÂäüËÉΩ"></a>3. Ê†∏ÂøÉÂäüËÉΩ</h2><h3 id="3-1-Êù°‰ª∂ÊûÑÈÄ†Âô®"><a href="#3-1-Êù°‰ª∂ÊûÑÈÄ†Âô®" class="headerlink" title="3.1 Êù°‰ª∂ÊûÑÈÄ†Âô®"></a>3.1 Êù°‰ª∂ÊûÑÈÄ†Âô®</h3><p>Èô§‰∫ÜÊñ∞Â¢û‰ª•Â§ñÔºå‰øÆÊîπ„ÄÅÂà†Èô§„ÄÅÊü•ËØ¢ÁöÑSQLËØ≠Âè•ÈÉΩÈúÄË¶ÅÊåáÂÆöwhereÊù°‰ª∂„ÄÇÂõ†Ê≠§BaseMapper‰∏≠Êèê‰æõÁöÑÁõ∏ÂÖ≥ÊñπÊ≥ïÈô§‰∫Ü‰ª•id‰Ωú‰∏∫whereÊù°‰ª∂‰ª•Â§ñÔºåËøòÊîØÊåÅÊõ¥Âä†Â§çÊùÇÁöÑwhereÊù°‰ª∂„ÄÇ</p>
<p>WrapperÂ∞±ÊòØÊù°‰ª∂ÊûÑÈÄ†ÁöÑÊäΩË±°Á±ª</p>
<p><img src="/img/blogs/java/springcloud/mp.1.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="3-1-1-QueryWrapper"><a href="#3-1-1-QueryWrapper" class="headerlink" title="3.1.1 QueryWrapper"></a>3.1.1 QueryWrapper</h4><p>Êü•ËØ¢ÔºöÊü•ËØ¢Âá∫ÂêçÂ≠ó‰∏≠Â∏¶oÁöÑÔºåÂ≠òÊ¨æÂ§ß‰∫éÁ≠â‰∫é1000ÂÖÉÁöÑ‰∫∫„ÄÇ‰ª£Á†ÅÂ¶Ç‰∏ãÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testQueryWrapper</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// 1.ÊûÑÂª∫Êü•ËØ¢Êù°‰ª∂ where name like &quot;%o%&quot; AND balance &gt;= 1000</span><br>    QueryWrapper&lt;User&gt; wrapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">QueryWrapper</span>&lt;User&gt;()<br>            .select(<span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-string">&quot;username&quot;</span>, <span class="hljs-string">&quot;info&quot;</span>, <span class="hljs-string">&quot;balance&quot;</span>)<br>            .like(<span class="hljs-string">&quot;username&quot;</span>, <span class="hljs-string">&quot;o&quot;</span>)<br>            .ge(<span class="hljs-string">&quot;balance&quot;</span>, <span class="hljs-number">1000</span>);<br>    <span class="hljs-comment">// 2.Êü•ËØ¢Êï∞ÊçÆ</span><br>    List&lt;User&gt; users = userMapper.selectList(wrapper);<br>    users.forEach(System.out::println);<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="3-1-2-UpdateWrapper"><a href="#3-1-2-UpdateWrapper" class="headerlink" title="3.1.2 UpdateWrapper"></a>3.1.2 UpdateWrapper</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testUpdateWrapper</span><span class="hljs-params">()</span> &#123;<br>    List&lt;Long&gt; ids = List.of(<span class="hljs-number">1L</span>, <span class="hljs-number">2L</span>, <span class="hljs-number">4L</span>);<br>    <span class="hljs-comment">// 1.ÁîüÊàêSQL</span><br>    UpdateWrapper&lt;User&gt; wrapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UpdateWrapper</span>&lt;User&gt;()<br>            .setSql(<span class="hljs-string">&quot;balance = balance - 200&quot;</span>) <span class="hljs-comment">// SET balance = balance - 200</span><br>            .in(<span class="hljs-string">&quot;id&quot;</span>, ids); <span class="hljs-comment">// WHERE id in (1, 2, 4)</span><br>        <span class="hljs-comment">// 2.Êõ¥Êñ∞ÔºåÊ≥®ÊÑèÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞ÂèØ‰ª•ÁªônullÔºå‰πüÂ∞±ÊòØ‰∏çÂ°´Êõ¥Êñ∞Â≠óÊÆµÂíåÊï∞ÊçÆÔºå</span><br>    <span class="hljs-comment">// ËÄåÊòØÂü∫‰∫éUpdateWrapper‰∏≠ÁöÑsetSQLÊù•Êõ¥Êñ∞</span><br>    userMapper.update(<span class="hljs-literal">null</span>, wrapper);<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="3-1-3-LambdaQueryWrapper"><a href="#3-1-3-LambdaQueryWrapper" class="headerlink" title="3.1.3 LambdaQueryWrapper"></a>3.1.3 LambdaQueryWrapper</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testLambdaQueryWrapper</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// 1.ÊûÑÂª∫Êù°‰ª∂ WHERE username LIKE &quot;%o%&quot; AND balance &gt;= 1000</span><br>    QueryWrapper&lt;User&gt; wrapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">QueryWrapper</span>&lt;&gt;();<br>    wrapper.lambda()<br>            .select(User::getId, User::getUsername, User::getInfo, User::getBalance)<br>            .like(User::getUsername, <span class="hljs-string">&quot;o&quot;</span>)<br>            .ge(User::getBalance, <span class="hljs-number">1000</span>);<br>    <span class="hljs-comment">// 2.Êü•ËØ¢</span><br>    List&lt;User&gt; users = userMapper.selectList(wrapper);<br>    users.forEach(System.out::println);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="3-2-Ëá™ÂÆö‰πâSQL"><a href="#3-2-Ëá™ÂÆö‰πâSQL" class="headerlink" title="3.2 Ëá™ÂÆö‰πâSQL"></a>3.2 Ëá™ÂÆö‰πâSQL</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testCustomWrapper</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// 1.ÂáÜÂ§áËá™ÂÆö‰πâÊü•ËØ¢Êù°‰ª∂</span><br>    List&lt;Long&gt; ids = List.of(<span class="hljs-number">1L</span>, <span class="hljs-number">2L</span>, <span class="hljs-number">4L</span>);<br>    QueryWrapper&lt;User&gt; wrapper = <span class="hljs-keyword">new</span> <span class="hljs-title class_">QueryWrapper</span>&lt;User&gt;().in(<span class="hljs-string">&quot;id&quot;</span>, ids);<br><br>    <span class="hljs-comment">// 2.Ë∞ÉÁî®mapperÁöÑËá™ÂÆö‰πâÊñπÊ≥ïÔºåÁõ¥Êé•‰º†ÈÄíWrapper</span><br>    userMapper.deductBalanceByIds(<span class="hljs-number">200</span>, wrapper);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ÁÑ∂ÂêéÂú®UserMapper‰∏≠Ëá™ÂÆö‰πâSQLÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserMapper</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">BaseMapper</span>&lt;User&gt; &#123;<br>    <span class="hljs-meta">@Select(&quot;UPDATE user SET balance = balance - #&#123;money&#125; $&#123;ew.customSqlSegment&#125;&quot;)</span><br>    <span class="hljs-keyword">void</span> <span class="hljs-title function_">deductBalanceByIds</span><span class="hljs-params">(<span class="hljs-meta">@Param(&quot;money&quot;)</span> <span class="hljs-type">int</span> money, <span class="hljs-meta">@Param(&quot;ew&quot;)</span> QueryWrapper&lt;User&gt; wrapper)</span>;<br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="3-3-ServiceÊé•Âè£"><a href="#3-3-ServiceÊé•Âè£" class="headerlink" title="3.3 ServiceÊé•Âè£"></a>3.3 ServiceÊé•Âè£</h3><h4 id="3-3-1-‰ªãÁªç"><a href="#3-3-1-‰ªãÁªç" class="headerlink" title="3.3.1 ‰ªãÁªç"></a>3.3.1 ‰ªãÁªç</h4><p>MybatisPlus‰∏ç‰ªÖÊèê‰æõ‰∫ÜBaseMapperÔºåËøòÊèê‰æõ‰∫ÜÈÄöÁî®ÁöÑServiceÊé•Âè£ÂèäÈªòËÆ§ÂÆûÁé∞ÔºåÂ∞ÅË£Ö‰∫Ü‰∏Ä‰∫õÂ∏∏Áî®ÁöÑserviceÊ®°ÊùøÊñπÊ≥ï„ÄÇ<br><strong>ÈÄöÁî®Êé•Âè£‰∏∫IService</strong>Ôºå<strong>ÈªòËÆ§ÂÆûÁé∞‰∏∫ServiceImpl</strong>ÔºåÂÖ∂‰∏≠Â∞ÅË£ÖÁöÑÊñπÊ≥ïÂèØ‰ª•ÂàÜ‰∏∫‰ª•‰∏ãÂá†Á±ªÔºö</p>
<ul>
<li>saveÔºöÊñ∞Â¢û</li>
<li>removeÔºöÂà†Èô§</li>
<li>updateÔºöÊõ¥Êñ∞</li>
<li>getÔºöÊü•ËØ¢Âçï‰∏™ÁªìÊûú</li>
<li>listÔºöÊü•ËØ¢ÈõÜÂêàÁªìÊûú</li>
<li>countÔºöËÆ°Êï∞</li>
<li>pageÔºöÂàÜÈ°µÊü•ËØ¢</li>
</ul>
<h4 id="3-3-2-Âü∫Êú¨Áî®Ê≥ï"><a href="#3-3-2-Âü∫Êú¨Áî®Ê≥ï" class="headerlink" title="3.3.2 Âü∫Êú¨Áî®Ê≥ï"></a>3.3.2 Âü∫Êú¨Áî®Ê≥ï</h4><p>Ëá™ÂÆö‰πâServiceÊé•Âè£ÁªßÊâøIService‰ª•ÊãìÂ±ïÊñπÊ≥ï„ÄÇÂêåÊó∂ÔºåËÆ©Ëá™ÂÆö‰πâÁöÑServiceÂÆûÁé∞Á±ªÁªßÊâøServiceImpl</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">IUserService</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">IService</span>&lt;User&gt; &#123;<br>    <span class="hljs-comment">// ÊãìÂ±ïËá™ÂÆö‰πâÊñπÊ≥ï</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>ÁºñÂÜôUserServiceImplÁ±ªÔºåÁªßÊâøServiceImplÔºåÂÆûÁé∞UserService</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Service</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserServiceImpl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ServiceImpl</span>&lt;UserMapper, User&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">IUserService</span> &#123;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="3-3-3-Lambda"><a href="#3-3-3-Lambda" class="headerlink" title="3.3.3 Lambda"></a>3.3.3 Lambda</h4><p>IService‰∏≠ËøòÊèê‰æõ‰∫ÜLambdaÂäüËÉΩÊù•ÁÆÄÂåñÊàë‰ª¨ÁöÑÂ§çÊùÇÊü•ËØ¢ÂèäÊõ¥Êñ∞ÂäüËÉΩ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-meta">@Transactional</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deductBalance</span><span class="hljs-params">(Long id, Integer money)</span> &#123;<br>    <span class="hljs-comment">// 1.Êü•ËØ¢Áî®Êà∑</span><br>    <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> getById(id);<br>    <span class="hljs-comment">// 2.Ê†°È™åÁî®Êà∑Áä∂ÊÄÅ</span><br>    <span class="hljs-keyword">if</span> (user == <span class="hljs-literal">null</span> || user.getStatus() == <span class="hljs-number">2</span>) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;Áî®Êà∑Áä∂ÊÄÅÂºÇÂ∏∏ÔºÅ&quot;</span>);<br>    &#125;<br>    <span class="hljs-comment">// 3.Ê†°È™å‰ΩôÈ¢ùÊòØÂê¶ÂÖÖË∂≥</span><br>    <span class="hljs-keyword">if</span> (user.getBalance() &lt; money) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(<span class="hljs-string">&quot;Áî®Êà∑‰ΩôÈ¢ù‰∏çË∂≥ÔºÅ&quot;</span>);<br>    &#125;<br>    <span class="hljs-comment">// 4.Êâ£Âáè‰ΩôÈ¢ù update tb_user set balance = balance - ?</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">remainBalance</span> <span class="hljs-operator">=</span> user.getBalance() - money;<br>    lambdaUpdate()<br>            .set(User::getBalance, remainBalance) <span class="hljs-comment">// Êõ¥Êñ∞‰ΩôÈ¢ù</span><br>            .set(remainBalance == <span class="hljs-number">0</span>, User::getStatus, <span class="hljs-number">2</span>) <span class="hljs-comment">// Âä®ÊÄÅÂà§Êñ≠ÔºåÊòØÂê¶Êõ¥Êñ∞status</span><br>            .eq(User::getId, id)<br>            .eq(User::getBalance, user.getBalance()) <span class="hljs-comment">// ‰πêËßÇÈîÅ</span><br>            .update();<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="4-Êâ©Â±ïÂäüËÉΩ"><a href="#4-Êâ©Â±ïÂäüËÉΩ" class="headerlink" title="4. Êâ©Â±ïÂäüËÉΩ"></a>4. Êâ©Â±ïÂäüËÉΩ</h2><h3 id="4-1-‰ª£Á†ÅÁîüÊàê"><a href="#4-1-‰ª£Á†ÅÁîüÊàê" class="headerlink" title="4.1 ‰ª£Á†ÅÁîüÊàê"></a>4.1 ‰ª£Á†ÅÁîüÊàê</h3><p>‰ΩøÁî®MybatisXÊèí‰ª∂Âç≥ÂèØ</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_47025166/article/details/125362323">SpringBoot‰∏≠MybatisXÊèí‰ª∂ÁöÑÁÆÄÂçï‰ΩøÁî®ÊïôÁ®ãÔºàË∂ÖËØ¶ÁªÜÔºÅÔºÅÔºâ</a></p>
<h3 id="4-2-ÈùôÊÄÅÂ∑•ÂÖ∑"><a href="#4-2-ÈùôÊÄÅÂ∑•ÂÖ∑" class="headerlink" title="4.2 ÈùôÊÄÅÂ∑•ÂÖ∑"></a>4.2 ÈùôÊÄÅÂ∑•ÂÖ∑</h3><p>ÊúâÁöÑÊó∂ÂÄô<strong>Service‰πãÈó¥‰πü‰ºöÁõ∏‰∫íË∞ÉÁî®</strong>Ôºå‰∏∫‰∫ÜÈÅøÂÖçÂá∫Áé∞Âæ™ÁéØ‰æùËµñÈóÆÈ¢òÔºåMybatisPlusÊèê‰æõ‰∏Ä‰∏™ÈùôÊÄÅÂ∑•ÂÖ∑Á±ªÔºöDbÔºåÂÖ∂‰∏≠ÁöÑ‰∏Ä‰∫õÈùôÊÄÅÊñπÊ≥ï‰∏éIService‰∏≠ÊñπÊ≥ïÁ≠æÂêçÂü∫Êú¨‰∏ÄËá¥</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> UserVO <span class="hljs-title function_">queryUserAndAddressById</span><span class="hljs-params">(Long userId)</span> &#123;<br>    <span class="hljs-comment">// 1.Êü•ËØ¢Áî®Êà∑</span><br>    <span class="hljs-type">User</span> <span class="hljs-variable">user</span> <span class="hljs-operator">=</span> getById(userId);<br>    <span class="hljs-keyword">if</span> (user == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br>    <span class="hljs-comment">// 2.Êü•ËØ¢Êî∂Ë¥ßÂú∞ÂùÄ</span><br>    List&lt;Address&gt; addresses = Db.lambdaQuery(Address.class)<br>            .eq(Address::getUserId, userId)<br>            .list();<br>    <span class="hljs-comment">// 3.Â§ÑÁêÜvo</span><br>    <span class="hljs-type">UserVO</span> <span class="hljs-variable">userVO</span> <span class="hljs-operator">=</span> BeanUtil.copyProperties(user, UserVO.class);<br>    userVO.setAddresses(BeanUtil.copyToList(addresses, AddressVO.class));<br>    <span class="hljs-keyword">return</span> userVO;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Âú®Êü•ËØ¢Âú∞ÂùÄÊó∂ÔºåÊàë‰ª¨ÈááÁî®‰∫ÜDbÁöÑÈùôÊÄÅÊñπÊ≥ïÔºåÂõ†Ê≠§ÈÅøÂÖç‰∫ÜÊ≥®ÂÖ•AddressServiceÔºåÂáèÂ∞ë‰∫ÜÂæ™ÁéØ‰æùËµñÁöÑÈ£éÈô©„ÄÇ</p>
<h3 id="4-3-ÈÄªËæëÂà†Èô§"><a href="#4-3-ÈÄªËæëÂà†Èô§" class="headerlink" title="4.3 ÈÄªËæëÂà†Èô§"></a>4.3 ÈÄªËæëÂà†Èô§</h3><p>ÂØπ‰∫é‰∏Ä‰∫õÊØîËæÉÈáçË¶ÅÁöÑÊï∞ÊçÆÔºåÊàë‰ª¨‰∏çÂà†Èô§Êï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊï∞ÊçÆÔºåËÄåÊòØ</p>
<ul>
<li>Âú®Ë°®‰∏≠Ê∑ªÂä†‰∏Ä‰∏™Â≠óÊÆµÊ†áËÆ∞Êï∞ÊçÆÊòØÂê¶Ë¢´Âà†Èô§</li>
<li>ÂΩìÂà†Èô§Êï∞ÊçÆÊó∂ÊääÊ†áËÆ∞ÁΩÆ‰∏∫true</li>
</ul>
<p>Êàë‰ª¨Ë¶ÅÂú®application.yml‰∏≠ÈÖçÁΩÆÈÄªËæëÂà†Èô§Â≠óÊÆµ</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">mybatis-plus:</span><br>  <span class="hljs-attr">global-config:</span><br>    <span class="hljs-attr">db-config:</span><br>      <span class="hljs-attr">logic-delete-field:</span> <span class="hljs-string">deleted</span> <span class="hljs-comment"># ÂÖ®Â±ÄÈÄªËæëÂà†Èô§ÁöÑÂÆû‰ΩìÂ≠óÊÆµÂêç(since 3.3.0,ÈÖçÁΩÆÂêéÂèØ‰ª•ÂøΩÁï•‰∏çÈÖçÁΩÆÊ≠•È™§2)</span><br>      <span class="hljs-attr">logic-delete-value:</span> <span class="hljs-number">1</span> <span class="hljs-comment"># ÈÄªËæëÂ∑≤Âà†Èô§ÂÄº(ÈªòËÆ§‰∏∫ 1)</span><br>      <span class="hljs-attr">logic-not-delete-value:</span> <span class="hljs-number">0</span> <span class="hljs-comment"># ÈÄªËæëÊú™Âà†Èô§ÂÄº(ÈªòËÆ§‰∏∫ 0)</span><br></code></pre></td></tr></table></figure>

<h3 id="4-4-Êûö‰∏æÂ§ÑÁêÜÂô®"><a href="#4-4-Êûö‰∏æÂ§ÑÁêÜÂô®" class="headerlink" title="4.4 Êûö‰∏æÂ§ÑÁêÜÂô®"></a>4.4 Êûö‰∏æÂ§ÑÁêÜÂô®</h3><p>MybatisPlusÊèê‰æõ‰∫Ü‰∏Ä‰∏™Â§ÑÁêÜÊûö‰∏æÁöÑÁ±ªÂûãËΩ¨Êç¢Âô®ÔºåÂèØ‰ª•Â∏ÆÊàë‰ª¨Êää<strong>Êûö‰∏æÁ±ªÂûã‰∏éÊï∞ÊçÆÂ∫ìÁ±ªÂûãËá™Âä®ËΩ¨Êç¢</strong></p>
<h4 id="4-4-1-ÂÆö‰πâÊûö‰∏æ"><a href="#4-4-1-ÂÆö‰πâÊûö‰∏æ" class="headerlink" title="4.4.1 ÂÆö‰πâÊûö‰∏æ"></a>4.4.1 ÂÆö‰πâÊûö‰∏æ</h4><p><img src="/img/blogs/java/springcloud/mp.2.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="4-4-2-EnumValue"><a href="#4-4-2-EnumValue" class="headerlink" title="4.4.2 @EnumValue"></a>4.4.2 @EnumValue</h4><p>MybatisPlusÊèê‰æõ‰∫Ü@EnumValueÊ≥®Ëß£Êù•Ê†áËÆ∞Êûö‰∏æÂ±ûÊÄß</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@EnumValue</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> value;<br></code></pre></td></tr></table></figure>
<p>Ë°®Á§∫valueÂ≠óÊÆµÁöÑÂÄºÊòØÊï∞ÊçÆÂ∫ìÂÄº</p>
<h4 id="4-4-3-ÈÖçÁΩÆÊûö‰∏æÂ§ÑÁêÜÂô®"><a href="#4-4-3-ÈÖçÁΩÆÊûö‰∏æÂ§ÑÁêÜÂô®" class="headerlink" title="4.4.3 ÈÖçÁΩÆÊûö‰∏æÂ§ÑÁêÜÂô®"></a>4.4.3 ÈÖçÁΩÆÊûö‰∏æÂ§ÑÁêÜÂô®</h4><p>Âú®application.yamlÊñá‰ª∂‰∏≠Ê∑ªÂä†ÈÖçÁΩÆ</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">mybatis-plus:</span><br>  <span class="hljs-attr">configuration:</span><br>    <span class="hljs-attr">default-enum-type-handler:</span> <span class="hljs-string">com.baomidou.mybatisplus.core.handlers.MybatisEnumTypeHandler</span><br></code></pre></td></tr></table></figure>


<h3 id="4-5-JSONÁ±ªÂûãÂ§ÑÁêÜÂô®"><a href="#4-5-JSONÁ±ªÂûãÂ§ÑÁêÜÂô®" class="headerlink" title="4.5 JSONÁ±ªÂûãÂ§ÑÁêÜÂô®"></a>4.5 JSONÁ±ªÂûãÂ§ÑÁêÜÂô®</h3><p>Êï∞ÊçÆÂ∫ìÁöÑuserË°®‰∏≠Êúâ‰∏Ä‰∏™infoÂ≠óÊÆµÔºåÊòØJSONÁ±ªÂûã„ÄÇËÄåÁõÆÂâçUserÂÆû‰ΩìÁ±ª‰∏≠Âç¥ÊòØStringÁ±ªÂûã„ÄÇÂ§ÑÁêÜJSONÂ∞±ÂèØ‰ª•‰ΩøÁî®JacksonTypeHandlerÂ§ÑÁêÜÂô®</p>
<p><strong>‰ΩøÁî®Á±ªÂûãÂ§ÑÁêÜÂô®</strong><br>Â∞ÜUserÁ±ªÁöÑinfoÂ≠óÊÆµ‰øÆÊîπ‰∏∫UserInfoÁ±ªÂûãÔºåÂπ∂Â£∞ÊòéÁ±ªÂûãÂ§ÑÁêÜÂô®Ôºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@TableField(typeHandler = JacksonTypeHandler.class)</span><br><span class="hljs-keyword">private</span> UserInfo info;<br></code></pre></td></tr></table></figure>

<h2 id="5-Êèí‰ª∂ÂäüËÉΩ-‰ª•ÂàÜÈ°µÊèí‰ª∂‰∏∫‰æã"><a href="#5-Êèí‰ª∂ÂäüËÉΩ-‰ª•ÂàÜÈ°µÊèí‰ª∂‰∏∫‰æã" class="headerlink" title="5. Êèí‰ª∂ÂäüËÉΩ(‰ª•ÂàÜÈ°µÊèí‰ª∂‰∏∫‰æã)"></a>5. Êèí‰ª∂ÂäüËÉΩ(‰ª•ÂàÜÈ°µÊèí‰ª∂‰∏∫‰æã)</h2><p>MybatisPlusÊèê‰æõ‰∫ÜÂæàÂ§öÁöÑÊèí‰ª∂ÂäüËÉΩÔºåËøõ‰∏ÄÊ≠•ÊãìÂ±ïÂÖ∂ÂäüËÉΩ„ÄÇ</p>
<ul>
<li>PaginationInnerInterceptorÔºöËá™Âä®ÂàÜÈ°µ</li>
<li>TenantLineInnerInterceptorÔºöÂ§öÁßüÊà∑</li>
<li>DynamicTableNameInnerInterceptorÔºöÂä®ÊÄÅË°®Âêç</li>
<li>OptimisticLockerInnerInterceptorÔºö‰πêËßÇÈîÅ</li>
<li>IllegalSQLInnerInterceptorÔºösql ÊÄßËÉΩËßÑËåÉ</li>
<li>BlockAttackInnerInterceptorÔºöÈò≤Ê≠¢ÂÖ®Ë°®Êõ¥Êñ∞‰∏éÂà†Èô§</li>
</ul>
<h3 id="5-1-ÈÖçÁΩÆÂàÜÈ°µÊèí‰ª∂"><a href="#5-1-ÈÖçÁΩÆÂàÜÈ°µÊèí‰ª∂" class="headerlink" title="5.1 ÈÖçÁΩÆÂàÜÈ°µÊèí‰ª∂"></a>5.1 ÈÖçÁΩÆÂàÜÈ°µÊèí‰ª∂</h3><p>Âú®È°πÁõÆ‰∏≠Êñ∞Âª∫‰∏Ä‰∏™ÈÖçÁΩÆÁ±ªÔºöMybatisConfig.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.annotation.DbType;<br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;<br><span class="hljs-keyword">import</span> com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MybatisConfig</span> &#123;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> MybatisPlusInterceptor <span class="hljs-title function_">mybatisPlusInterceptor</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// ÂàùÂßãÂåñÊ†∏ÂøÉÊèí‰ª∂</span><br>        <span class="hljs-type">MybatisPlusInterceptor</span> <span class="hljs-variable">interceptor</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MybatisPlusInterceptor</span>();<br>        <span class="hljs-comment">// Ê∑ªÂä†ÂàÜÈ°µÊèí‰ª∂</span><br>        interceptor.addInnerInterceptor(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PaginationInnerInterceptor</span>(DbType.MYSQL));<br>        <span class="hljs-keyword">return</span> interceptor;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>


<h3 id="5-2-ÂàÜÈ°µÊü•ËØ¢ÁöÑÊµãËØï"><a href="#5-2-ÂàÜÈ°µÊü•ËØ¢ÁöÑÊµãËØï" class="headerlink" title="5.2 ÂàÜÈ°µÊü•ËØ¢ÁöÑÊµãËØï"></a>5.2 ÂàÜÈ°µÊü•ËØ¢ÁöÑÊµãËØï</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testPageQuery</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// 1.ÂàÜÈ°µÊü•ËØ¢Ôºånew Page()ÁöÑ‰∏§‰∏™ÂèÇÊï∞ÂàÜÂà´ÊòØÔºöÈ°µÁ†Å„ÄÅÊØèÈ°µÂ§ßÂ∞è</span><br>    Page&lt;User&gt; p = userService.page(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Page</span>&lt;&gt;(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>));<br>    <span class="hljs-comment">// 2.ÊÄªÊù°Êï∞</span><br>    System.out.println(<span class="hljs-string">&quot;total = &quot;</span> + p.getTotal());<br>    <span class="hljs-comment">// 3.ÊÄªÈ°µÊï∞</span><br>    System.out.println(<span class="hljs-string">&quot;pages = &quot;</span> + p.getPages());<br>    <span class="hljs-comment">// 4.Êï∞ÊçÆ</span><br>    List&lt;User&gt; records = p.getRecords();<br>    records.forEach(System.out::println);<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="‰∫å-Docker"><a href="#‰∫å-Docker" class="headerlink" title="‰∫å. Docker"></a>‰∫å. Docker</h1><h2 id="1-Docker‰ªãÁªç"><a href="#1-Docker‰ªãÁªç" class="headerlink" title="1. Docker‰ªãÁªç"></a>1. Docker‰ªãÁªç</h2><p>DockerÊú¨Ë∫´ÂåÖÂê´‰∏Ä‰∏™ÂêéÂè∞ÊúçÂä°ÔºåÊàë‰ª¨ÂèØ‰ª•Âà©Áî®DockerÂëΩ‰ª§ÂëäËØâDockerÊúçÂä°ÔºåÂ∏ÆÂä©Êàë‰ª¨Âø´ÈÄüÈÉ®ÁΩ≤ÊåáÂÆöÁöÑÂ∫îÁî®„ÄÇDockerÊúçÂä°ÈÉ®ÁΩ≤Â∫îÁî®Êó∂ÔºåÈ¶ñÂÖàË¶ÅÂéªÊêúÁ¥¢Âπ∂‰∏ãËΩΩÂ∫îÁî®ÂØπÂ∫îÁöÑÈïúÂÉèÔºåÁÑ∂ÂêéÊ†πÊçÆÈïúÂÉèÂàõÂª∫Âπ∂ÂÖÅËÆ∏ÂÆπÂô®ÔºåÂ∫îÁî®Â∞±ÈÉ®ÁΩ≤ÂÆåÊàê‰∫Ü„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/docker.1.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="2-DockerÂ∏∏ËßÅÂëΩ‰ª§"><a href="#2-DockerÂ∏∏ËßÅÂëΩ‰ª§" class="headerlink" title="2. DockerÂ∏∏ËßÅÂëΩ‰ª§"></a>2. DockerÂ∏∏ËßÅÂëΩ‰ª§</h2><h3 id="2-1-Â∏∏ËßÅÂëΩ‰ª§"><a href="#2-1-Â∏∏ËßÅÂëΩ‰ª§" class="headerlink" title="2.1 Â∏∏ËßÅÂëΩ‰ª§"></a>2.1 Â∏∏ËßÅÂëΩ‰ª§</h3><table>
<thead>
<tr>
<th>ÂëΩ‰ª§</th>
<th>ËØ¥Êòé</th>
</tr>
</thead>
<tbody><tr>
<td>docker pull</td>
<td>ÊãâÂèñÈïúÂÉè</td>
</tr>
<tr>
<td>docker push</td>
<td>Êé®ÈÄÅÈïúÂÉèÂà∞ Docker Registry</td>
</tr>
<tr>
<td>docker images</td>
<td>Êü•ÁúãÊú¨Âú∞ÈïúÂÉè</td>
</tr>
<tr>
<td>docker rmi</td>
<td>Âà†Èô§Êú¨Âú∞ÈïúÂÉè</td>
</tr>
<tr>
<td>docker run</td>
<td>ÂàõÂª∫Âπ∂ËøêË°åÂÆπÂô®Ôºà‰∏çËÉΩÈáçÂ§çÂàõÂª∫Ôºâ</td>
</tr>
<tr>
<td>docker stop</td>
<td>ÂÅúÊ≠¢ÊåáÂÆöÂÆπÂô®</td>
</tr>
<tr>
<td>docker start</td>
<td>ÂêØÂä®ÊåáÂÆöÂÆπÂô®</td>
</tr>
<tr>
<td>docker restart</td>
<td>ÈáçÊñ∞ÂêØÂä®ÂÆπÂô®</td>
</tr>
<tr>
<td>docker rm</td>
<td>Âà†Èô§ÊåáÂÆöÂÆπÂô®</td>
</tr>
<tr>
<td>docker ps</td>
<td>Êü•ÁúãÂÆπÂô®</td>
</tr>
<tr>
<td>docker logs</td>
<td>Êü•ÁúãÂÆπÂô®ËøêË°åÊó•Âøó</td>
</tr>
<tr>
<td>docker exec</td>
<td>ËøõÂÖ•ÂÆπÂô®</td>
</tr>
<tr>
<td>docker save</td>
<td>‰øùÂ≠òÈïúÂÉèÂà∞Êú¨Âú∞ÂéãÁº©Êñá‰ª∂</td>
</tr>
<tr>
<td>docker load</td>
<td>Âä†ËΩΩÊú¨Âú∞ÂéãÁº©Êñá‰ª∂Âà∞ÈïúÂÉè</td>
</tr>
<tr>
<td>docker inspect</td>
<td>Êü•ÁúãÂÆπÂô®ËØ¶ÁªÜ‰ø°ÊÅØ</td>
</tr>
</tbody></table>
<p><img src="/img/blogs/java/springcloud/docker.2.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="2-2-Á§∫‰æã"><a href="#2-2-Á§∫‰æã" class="headerlink" title="2.2 Á§∫‰æã"></a>2.2 Á§∫‰æã</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Á¨¨1Ê≠•ÔºåÂéªDockerHubÊü•ÁúãnginxÈïúÂÉè‰ªìÂ∫ìÂèäÁõ∏ÂÖ≥‰ø°ÊÅØ</span><br><br><span class="hljs-comment"># Á¨¨2Ê≠•ÔºåÊãâÂèñNginxÈïúÂÉè</span><br>docker pull nginx<br><br><span class="hljs-comment"># Á¨¨3Ê≠•ÔºåÊü•ÁúãÈïúÂÉè</span><br>docker images<br><span class="hljs-comment"># ÁªìÊûúÂ¶Ç‰∏ãÔºö</span><br>REPOSITORY   TAG       IMAGE ID       CREATED         SIZE<br>nginx        latest    605c77e624dd   16 months ago   141MB<br>mysql        latest    3218b38490ce   17 months ago   516MB<br><br><span class="hljs-comment"># Á¨¨4Ê≠•ÔºåÂàõÂª∫Âπ∂ÂÖÅËÆ∏NginxÂÆπÂô®</span><br>docker run -d --name nginx -p 80:80 nginx<br><br><span class="hljs-comment"># Á¨¨5Ê≠•ÔºåÊü•ÁúãËøêË°å‰∏≠ÂÆπÂô®</span><br>docker ps<br><span class="hljs-comment"># ‰πüÂèØ‰ª•Âä†Ê†ºÂºèÂåñÊñπÂºèËÆøÈóÆÔºåÊ†ºÂºè‰ºöÊõ¥Âä†Ê∏ÖÁàΩ</span><br>docker ps --format <span class="hljs-string">&quot;table &#123;&#123;.ID&#125;&#125;\t&#123;&#123;.Image&#125;&#125;\t&#123;&#123;.Ports&#125;&#125;\t&#123;&#123;.Status&#125;&#125;\t&#123;&#123;.Names&#125;&#125;&quot;</span><br><br><span class="hljs-comment"># Á¨¨6Ê≠•ÔºåËÆøÈóÆÁΩëÈ°µÔºåÂú∞ÂùÄÔºöhttp://ËôöÊãüÊú∫Âú∞ÂùÄ</span><br><br><span class="hljs-comment"># Á¨¨7Ê≠•ÔºåÂÅúÊ≠¢ÂÆπÂô®</span><br>docker stop nginx<br><br><span class="hljs-comment"># Á¨¨8Ê≠•ÔºåÊü•ÁúãÊâÄÊúâÂÆπÂô®</span><br>docker ps -a --format <span class="hljs-string">&quot;table &#123;&#123;.ID&#125;&#125;\t&#123;&#123;.Image&#125;&#125;\t&#123;&#123;.Ports&#125;&#125;\t&#123;&#123;.Status&#125;&#125;\t&#123;&#123;.Names&#125;&#125;&quot;</span><br><br><span class="hljs-comment"># Á¨¨9Ê≠•ÔºåÂÜçÊ¨°ÂêØÂä®nginxÂÆπÂô®</span><br>docker start nginx<br><br><span class="hljs-comment"># Á¨¨10Ê≠•ÔºåÂÜçÊ¨°Êü•ÁúãÂÆπÂô®</span><br>docker ps --format <span class="hljs-string">&quot;table &#123;&#123;.ID&#125;&#125;\t&#123;&#123;.Image&#125;&#125;\t&#123;&#123;.Ports&#125;&#125;\t&#123;&#123;.Status&#125;&#125;\t&#123;&#123;.Names&#125;&#125;&quot;</span><br><br><span class="hljs-comment"># Á¨¨11Ê≠•ÔºåÊü•ÁúãÂÆπÂô®ËØ¶ÁªÜ‰ø°ÊÅØ</span><br>docker inspect nginx<br><br><span class="hljs-comment"># Á¨¨12Ê≠•ÔºåËøõÂÖ•ÂÆπÂô®,Êü•ÁúãÂÆπÂô®ÂÜÖÁõÆÂΩï</span><br>docker <span class="hljs-built_in">exec</span> -it nginx bash<br><span class="hljs-comment"># ÊàñËÄÖÔºåÂèØ‰ª•ËøõÂÖ•MySQL</span><br>docker <span class="hljs-built_in">exec</span> -it mysql mysql -uroot -p<br><br><span class="hljs-comment"># Á¨¨13Ê≠•ÔºåÂà†Èô§ÂÆπÂô®</span><br>docker <span class="hljs-built_in">rm</span> nginx<br><span class="hljs-comment"># ÂèëÁé∞Êó†Ê≥ïÂà†Èô§ÔºåÂõ†‰∏∫ÂÆπÂô®ËøêË°å‰∏≠ÔºåÂº∫Âà∂Âà†Èô§ÂÆπÂô®</span><br>docker <span class="hljs-built_in">rm</span> -f nginx<br></code></pre></td></tr></table></figure>

<h3 id="2-3-ÂëΩ‰ª§Âà´Âêç"><a href="#2-3-ÂëΩ‰ª§Âà´Âêç" class="headerlink" title="2.3 ÂëΩ‰ª§Âà´Âêç"></a>2.3 ÂëΩ‰ª§Âà´Âêç</h3><p>ÁªôÂ∏∏Áî®DockerÂëΩ‰ª§Ëµ∑Âà´ÂêçÔºåÊñπ‰æøÊàë‰ª¨ËÆøÈóÆ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># ‰øÆÊîπ/root/.bashrcÊñá‰ª∂</span><br>vi /root/.bashrc<br>ÂÜÖÂÆπÂ¶Ç‰∏ãÔºö<br><span class="hljs-comment"># .bashrc</span><br><br><span class="hljs-comment"># User specific aliases and functions</span><br><br><span class="hljs-built_in">alias</span> <span class="hljs-built_in">rm</span>=<span class="hljs-string">&#x27;rm -i&#x27;</span><br><span class="hljs-built_in">alias</span> <span class="hljs-built_in">cp</span>=<span class="hljs-string">&#x27;cp -i&#x27;</span><br><span class="hljs-built_in">alias</span> <span class="hljs-built_in">mv</span>=<span class="hljs-string">&#x27;mv -i&#x27;</span><br><span class="hljs-built_in">alias</span> dps=<span class="hljs-string">&#x27;docker ps --format &quot;table &#123;&#123;.ID&#125;&#125;\t&#123;&#123;.Image&#125;&#125;\t&#123;&#123;.Ports&#125;&#125;\t&#123;&#123;.Status&#125;&#125;\t&#123;&#123;.Names&#125;&#125;&quot;&#x27;</span><br><span class="hljs-built_in">alias</span> dis=<span class="hljs-string">&#x27;docker images&#x27;</span><br><br><span class="hljs-comment"># Source global definitions</span><br><span class="hljs-keyword">if</span> [ -f /etc/bashrc ]; <span class="hljs-keyword">then</span><br>        . /etc/bashrc<br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure>

<p>ÊâßË°åÂëΩ‰ª§‰ΩøÂà´ÂêçÁîüÊïà</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">source</span> /root/.bashrc<br></code></pre></td></tr></table></figure>

<h2 id="3-Êï∞ÊçÆÂç∑"><a href="#3-Êï∞ÊçÆÂç∑" class="headerlink" title="3. Êï∞ÊçÆÂç∑"></a>3. Êï∞ÊçÆÂç∑</h2><h3 id="3-1-Êï∞ÊçÆÂç∑‰ªãÁªç"><a href="#3-1-Êï∞ÊçÆÂç∑‰ªãÁªç" class="headerlink" title="3.1 Êï∞ÊçÆÂç∑‰ªãÁªç"></a>3.1 Êï∞ÊçÆÂç∑‰ªãÁªç</h3><p>ÂÆπÂô®ÊòØÈöîÁ¶ªÁéØÂ¢ÉÔºåÂÆπÂô®ÂÜÖÁ®ãÂ∫èÁöÑÊñá‰ª∂„ÄÅÈÖçÁΩÆ„ÄÅËøêË°åÊó∂‰∫ßÁîüÁöÑÂÆπÂô®ÈÉΩÂú®ÂÆπÂô®ÂÜÖÈÉ®ÔºåÊàë‰ª¨Ë¶ÅËØªÂÜôÂÆπÂô®ÂÜÖÁöÑÊñá‰ª∂ÈùûÂ∏∏‰∏çÊñπ‰æø„ÄÇ<br><strong>Êï∞ÊçÆÂç∑ÔºàvolumeÔºâÊòØ‰∏Ä‰∏™ËôöÊãüÁõÆÂΩïÔºåÊòØÂÆπÂô®ÂÜÖÁõÆÂΩï‰∏éÂÆø‰∏ªÊú∫ÁõÆÂΩï‰πãÈó¥Êò†Â∞ÑÁöÑÊ°•Ê¢Å</strong></p>
<p><img src="/img/blogs/java/springcloud/docker.3.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>Êàë‰ª¨ÂàõÂª∫‰∫Ü‰∏§‰∏™Êï∞ÊçÆÂç∑Ôºöconf„ÄÅhtml</li>
<li>NginxÂÆπÂô®ÂÜÖÈÉ®ÁöÑconfÁõÆÂΩïÂíåhtmlÁõÆÂΩïÂàÜÂà´‰∏é‰∏§‰∏™Êï∞ÊçÆÂç∑ÂÖ≥ËÅî„ÄÇ</li>
<li>ËÄåÊï∞ÊçÆÂç∑confÂíåhtmlÂàÜÂà´ÊåáÂêë‰∫ÜÂÆø‰∏ªÊú∫ÁöÑ&#x2F;var&#x2F;lib&#x2F;docker&#x2F;volumes&#x2F;conf&#x2F;_dataÁõÆÂΩïÂíå&#x2F;var&#x2F;lib&#x2F;docker&#x2F;volumes&#x2F;html&#x2F;_dataÁõÆÂΩï<br>ËøôÊ†∑‰ª•Êù•ÔºåÂÆπÂô®ÂÜÖÁöÑconfÂíåhtmlÁõÆÂΩïÂ∞± ‰∏éÂÆø‰∏ªÊú∫ÁöÑconfÂíåhtmlÁõÆÂΩïÂÖ≥ËÅîËµ∑Êù•ÔºåÊàë‰ª¨Áß∞‰∏∫ÊåÇËΩΩ„ÄÇÊ≠§Êó∂ÔºåÊàë‰ª¨Êìç‰ΩúÂÆø‰∏ªÊú∫ÁöÑ&#x2F;var&#x2F;lib&#x2F;docker&#x2F;volumes&#x2F;html&#x2F;_dataÂ∞±ÊòØÂú®Êìç‰ΩúÂÆπÂô®ÂÜÖÁöÑ&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html&#x2F;_dataÁõÆÂΩï„ÄÇÂè™Ë¶ÅÊàë‰ª¨Â∞ÜÈùôÊÄÅËµÑÊ∫êÊîæÂÖ•ÂÆø‰∏ªÊú∫ÂØπÂ∫îÁõÆÂΩïÔºåÂ∞±ÂèØ‰ª•Ë¢´Nginx‰ª£ÁêÜ‰∫Ü„ÄÇ</li>
</ul>
<h3 id="3-2-Êï∞ÊçÆÂç∑ÂëΩ‰ª§"><a href="#3-2-Êï∞ÊçÆÂç∑ÂëΩ‰ª§" class="headerlink" title="3.2 Êï∞ÊçÆÂç∑ÂëΩ‰ª§"></a>3.2 Êï∞ÊçÆÂç∑ÂëΩ‰ª§</h3><table>
<thead>
<tr>
<th>ÂëΩ‰ª§</th>
<th>ËØ¥Êòé</th>
</tr>
</thead>
<tbody><tr>
<td>docker volume create</td>
<td>ÂàõÂª∫Êï∞ÊçÆÂç∑</td>
</tr>
<tr>
<td>docker volume ls</td>
<td>Êü•ÁúãÊâÄÊúâÊï∞ÊçÆÂç∑</td>
</tr>
<tr>
<td>docker volume rm</td>
<td>Âà†Èô§ÊåáÂÆöÊï∞ÊçÆÂç∑</td>
</tr>
<tr>
<td>docker volume inspect</td>
<td>Êü•ÁúãÊüê‰∏™Êï∞ÊçÆÂç∑ÁöÑËØ¶ÊÉÖ</td>
</tr>
<tr>
<td>docker volume prune</td>
<td>Ê∏ÖÈô§Êï∞ÊçÆÂç∑</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 1.È¶ñÂÖàÂàõÂª∫ÂÆπÂô®Âπ∂ÊåáÂÆöÊï∞ÊçÆÂç∑ÔºåÊ≥®ÊÑèÈÄöËøá -v ÂèÇÊï∞Êù•ÊåáÂÆöÊï∞ÊçÆÂç∑</span><br>docker run -d --name nginx -p 80:80 -v html:/usr/share/nginx/html nginx<br><br><span class="hljs-comment"># 2.ÁÑ∂ÂêéÊü•ÁúãÊï∞ÊçÆÂç∑</span><br>docker volume <span class="hljs-built_in">ls</span><br><span class="hljs-comment"># ÁªìÊûú</span><br>DRIVER    VOLUME NAME<br><span class="hljs-built_in">local</span>     29524ff09715d3688eae3f99803a2796558dbd00ca584a25a4bbc193ca82459f<br><span class="hljs-built_in">local</span>     html<br><br><span class="hljs-comment"># 3.Êü•ÁúãÊï∞ÊçÆÂç∑ËØ¶ÊÉÖ</span><br>docker volume inspect html<br><span class="hljs-comment"># ÁªìÊûú</span><br>[<br>    &#123;<br>        <span class="hljs-string">&quot;CreatedAt&quot;</span>: <span class="hljs-string">&quot;2024-05-17T19:57:08+08:00&quot;</span>,<br>        <span class="hljs-string">&quot;Driver&quot;</span>: <span class="hljs-string">&quot;local&quot;</span>,<br>        <span class="hljs-string">&quot;Labels&quot;</span>: null,<br>        <span class="hljs-string">&quot;Mountpoint&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/volumes/html/_data&quot;</span>,<br>        <span class="hljs-string">&quot;Name&quot;</span>: <span class="hljs-string">&quot;html&quot;</span>,<br>        <span class="hljs-string">&quot;Options&quot;</span>: null,<br>        <span class="hljs-string">&quot;Scope&quot;</span>: <span class="hljs-string">&quot;local&quot;</span><br>    &#125;<br>]<br><br><span class="hljs-comment"># 4.Êü•Áúã/var/lib/docker/volumes/html/_dataÁõÆÂΩï</span><br>ll /var/lib/docker/volumes/html/_data<br><span class="hljs-comment"># ÂèØ‰ª•ÁúãÂà∞‰∏énginxÁöÑhtmlÁõÆÂΩïÂÜÖÂÆπ‰∏ÄÊ†∑ÔºåÁªìÊûúÂ¶Ç‰∏ãÔºö</span><br>ÊÄªÁî®Èáè 8<br>-rw-r--r--. 1 root root 497 12Êúà 28 2021 50x.html<br>-rw-r--r--. 1 root root 615 12Êúà 28 2021 index.html<br><br><span class="hljs-comment"># 5.ËøõÂÖ•ËØ•ÁõÆÂΩïÔºåÂπ∂ÈöèÊÑè‰øÆÊîπindex.htmlÂÜÖÂÆπ</span><br><span class="hljs-built_in">cd</span> /var/lib/docker/volumes/html/_data<br>vi index.html<br><br><span class="hljs-comment"># 6.ÊâìÂºÄÈ°µÈù¢ÔºåÊü•ÁúãÊïàÊûú</span><br><br><span class="hljs-comment"># 7.ËøõÂÖ•ÂÆπÂô®ÂÜÖÈÉ®ÔºåÊü•Áúã/usr/share/nginx/htmlÁõÆÂΩïÂÜÖÁöÑÊñá‰ª∂ÊòØÂê¶ÂèòÂåñ</span><br>docker <span class="hljs-built_in">exec</span> -it nginx bash<br></code></pre></td></tr></table></figure>

<h3 id="3-3-ÊåÇËΩΩÊú¨Âú∞ÁõÆÂΩïÊàñÊñá‰ª∂"><a href="#3-3-ÊåÇËΩΩÊú¨Âú∞ÁõÆÂΩïÊàñÊñá‰ª∂" class="headerlink" title="3.3 ÊåÇËΩΩÊú¨Âú∞ÁõÆÂΩïÊàñÊñá‰ª∂"></a>3.3 ÊåÇËΩΩÊú¨Âú∞ÁõÆÂΩïÊàñÊñá‰ª∂</h3><p>Êï∞ÊçÆÂç∑ÁöÑÁõÆÂΩïÁªìÊûÑËæÉÊ∑±ÔºåÂ¶ÇÊûúÊàë‰ª¨ÂéªÊìç‰ΩúÊï∞ÊçÆÂç∑ÁõÆÂΩï‰ºö‰∏çÂ§™Êñπ‰æø„ÄÇÂú®ÂæàÂ§öÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨‰ºöÁõ¥Êé•Â∞ÜÂÆπÂô®ÁõÆÂΩï‰∏éÂÆø‰∏ªÊú∫ÊåáÂÆöÁõÆÂΩïÊåÇËΩΩ„ÄÇÊåÇËΩΩËØ≠Ê≥ï‰∏éÊï∞ÊçÆÂç∑Á±ª‰ººÔºö</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># ÊåÇËΩΩÊú¨Âú∞ÁõÆÂΩï</span><br>-v Êú¨Âú∞ÁõÆÂΩï:ÂÆπÂô®ÂÜÖÁõÆÂΩï<br><span class="hljs-comment"># ÊåÇËΩΩÊú¨Âú∞Êñá‰ª∂</span><br>-v Êú¨Âú∞Êñá‰ª∂:ÂÆπÂô®ÂÜÖÊñá‰ª∂<br></code></pre></td></tr></table></figure>

<p>ÊºîÁ§∫Ôºö</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br><span class="hljs-comment"># 1.Âà†Èô§ÂéüÊù•ÁöÑMySQLÂÆπÂô®</span><br>docker <span class="hljs-built_in">rm</span> -f mysql<br><br><span class="hljs-comment"># 2.ËøõÂÖ•rootÁõÆÂΩï</span><br><span class="hljs-built_in">cd</span> ~<br><br><span class="hljs-comment"># 3.ÂàõÂª∫Âπ∂ËøêË°åÊñ∞mysqlÂÆπÂô®ÔºåÊåÇËΩΩÊú¨Âú∞ÁõÆÂΩï</span><br>docker run -d \<br>  --name mysql \<br>  -p 3306:3306 \<br>  -e TZ=Asia/Shanghai \<br>  -e MYSQL_ROOT_PASSWORD=123 \<br>  -v ./mysql/data:/var/lib/mysql \<br>  -v ./mysql/conf:/etc/mysql/conf.d \<br>  -v ./mysql/init:/docker-entrypoint-initdb.d \<br>  mysql<br><br><span class="hljs-comment"># 4.Êü•ÁúãrootÁõÆÂΩïÔºåÂèØ‰ª•ÂèëÁé∞~/mysql/dataÁõÆÂΩïÂ∑≤ÁªèËá™Âä®ÂàõÂª∫Â•Ω‰∫Ü</span><br><span class="hljs-built_in">ls</span> -l mysql<br><span class="hljs-comment"># ÁªìÊûúÔºö</span><br>ÊÄªÁî®Èáè 4<br>drwxr-xr-x. 2 root    root   20 5Êúà  19 15:11 conf<br>drwxr-xr-x. 7 polkitd root 4096 5Êúà  19 15:11 data<br>drwxr-xr-x. 2 root    root   23 5Êúà  19 15:11 init<br><br><span class="hljs-comment"># Êü•ÁúãdataÁõÆÂΩïÔºå‰ºöÂèëÁé∞ÈáåÈù¢ÊúâÂ§ßÈáèÊï∞ÊçÆÂ∫ìÊï∞ÊçÆÔºåËØ¥ÊòéÊï∞ÊçÆÂ∫ìÂÆåÊàê‰∫ÜÂàùÂßãÂåñ</span><br><span class="hljs-built_in">ls</span> -l data<br><br><span class="hljs-comment"># 5.Êü•ÁúãMySQLÂÆπÂô®ÂÜÖÊï∞ÊçÆ</span><br><span class="hljs-comment"># 5.1.ËøõÂÖ•MySQL</span><br>docker <span class="hljs-built_in">exec</span> -it mysql mysql -uroot -p123<br><span class="hljs-comment"># 5.2.Êü•ÁúãÁºñÁ†ÅË°®</span><br>show variables like <span class="hljs-string">&quot;%char%&quot;</span>;<br><span class="hljs-comment"># 5.3.ÁªìÊûúÔºåÂèëÁé∞ÁºñÁ†ÅÊòØutf8mb4Ê≤°ÊúâÈóÆÈ¢ò</span><br>+--------------------------+--------------------------------+<br>| Variable_name            | Value                          |<br>+--------------------------+--------------------------------+<br>| character_set_client     | utf8mb4                        |<br>| character_set_connection | utf8mb4                        |<br>| character_set_database   | utf8mb4                        |<br>| character_set_filesystem | binary                         |<br>| character_set_results    | utf8mb4                        |<br>| character_set_server     | utf8mb4                        |<br>| character_set_system     | utf8mb3                        |<br>| character_sets_dir       | /usr/share/mysql-8.0/charsets/ |<br>+--------------------------+--------------------------------+<br><br><span class="hljs-comment"># 6.Êü•ÁúãÊï∞ÊçÆ</span><br><span class="hljs-comment"># 6.1.Êü•ÁúãÊï∞ÊçÆÂ∫ì</span><br>show databases;<br><span class="hljs-comment"># ÁªìÊûúÔºåhmallÊòØÈªëÈ©¨ÂïÜÂüéÊï∞ÊçÆÂ∫ì</span><br>+--------------------+<br>| Database           |<br>+--------------------+<br>| hmall              |<br>| information_schema |<br>| mysql              |<br>| performance_schema |<br>| sys                |<br>+--------------------+<br>5 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.00 sec)<br><span class="hljs-comment"># 6.2.ÂàáÊç¢Âà∞hmallÊï∞ÊçÆÂ∫ì</span><br>use hmall;<br><span class="hljs-comment"># 6.3.Êü•ÁúãË°®</span><br>show tables;<br><span class="hljs-comment"># ÁªìÊûúÔºö</span><br>+-----------------+<br>| Tables_in_hmall |<br>+-----------------+<br>| address         |<br>| cart            |<br>| item            |<br>| order           |<br>| order_detail    |<br>| order_logistics |<br>| pay_order       |<br>| user            |<br>+-----------------+<br><span class="hljs-comment"># 6.4.Êü•ÁúãaddressË°®Êï∞ÊçÆ</span><br>+----+---------+----------+--------+----------+-------------+---------------+-----------+------------+-------+<br>| <span class="hljs-built_in">id</span> | user_id | province | city   | town     | mobile      | street        | contact   | is_default | notes |<br>+----+---------+----------+--------+----------+-------------+---------------+-----------+------------+-------+<br>| 59 |       1 | Âåó‰∫¨     | Âåó‰∫¨   | ÊúùÈò≥Âå∫    | 13900112222 | ÈáëÁáïÈæôÂäûÂÖ¨Ê•º   | Êùé‰Ω≥ËØö    | 0          | NULL  |<br>| 60 |       1 | Âåó‰∫¨     | Âåó‰∫¨   | ÊúùÈò≥Âå∫    | 13700221122 | ‰øÆÊ≠£Â§ßÂé¶       | Êùé‰Ω≥Á∫¢    | 0          | NULL  |<br>| 61 |       1 | ‰∏äÊµ∑     | ‰∏äÊµ∑   | Êµ¶‰∏úÊñ∞Âå∫  | 13301212233 | Ëà™Â§¥ÈïáËà™Â§¥Ë∑Ø   | Êùé‰Ω≥Êòü    | 1          | NULL  |<br>| 63 |       1 | Âπø‰∏ú     | ‰ΩõÂ±±   | Ê∞∏Êò•      | 13301212233 | Ê∞∏Êò•Ê≠¶È¶Ü       | ÊùéÊôìÈæô    | 0          | NULL  |<br>+----+---------+----------+--------+----------+-------------+---------------+-----------+------------+-------+<br>4 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.00 sec)<br><br></code></pre></td></tr></table></figure>

<h2 id="4-ÈïúÂÉè"><a href="#4-ÈïúÂÉè" class="headerlink" title="4. ÈïúÂÉè"></a>4. ÈïúÂÉè</h2><h3 id="4-1-ÊûÑÂª∫Ëá™Â∑±ÁöÑÈïúÂÉè"><a href="#4-1-ÊûÑÂª∫Ëá™Â∑±ÁöÑÈïúÂÉè" class="headerlink" title="4.1 ÊûÑÂª∫Ëá™Â∑±ÁöÑÈïúÂÉè"></a>4.1 ÊûÑÂª∫Ëá™Â∑±ÁöÑÈïúÂÉè</h3><p>Êàë‰ª¨ÊâìÂåÖÈïúÂÉè‰πüÊòØÂàÜÊàêËøô‰πàÂá†Ê≠•Ôºö</p>
<ul>
<li>ÂáÜÂ§áLinuxËøêË°åÁéØÂ¢ÉÔºàjavaÈ°πÁõÆÂπ∂‰∏çÈúÄË¶ÅÂÆåÊï¥ÁöÑÊìç‰ΩúÁ≥ªÁªüÔºå‰ªÖ‰ªÖÊòØÂü∫Á°ÄËøêË°åÁéØÂ¢ÉÂç≥ÂèØÔºâ</li>
<li>ÂÆâË£ÖÂπ∂ÈÖçÁΩÆJDK</li>
<li>Êã∑Ë¥ùjarÂåÖ</li>
<li>ÈÖçÁΩÆÂêØÂä®ËÑöÊú¨</li>
</ul>
<h3 id="4-2-Dockerfile"><a href="#4-2-Dockerfile" class="headerlink" title="4.2 Dockerfile"></a>4.2 Dockerfile</h3><table>
<thead>
<tr>
<th>Êåá‰ª§</th>
<th>ËØ¥Êòé</th>
</tr>
</thead>
<tbody><tr>
<td>FROM</td>
<td>ÊåáÂÆöÂü∫Á°ÄÈïúÂÉè</td>
</tr>
<tr>
<td>ENV</td>
<td>ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáèÔºåÂèØÂú®ÂêéÈù¢Êåá‰ª§‰ΩøÁî®</td>
</tr>
<tr>
<td>COPY</td>
<td>Êã∑Ë¥ùÊú¨Âú∞Êñá‰ª∂Âà∞ÈïúÂÉèÁöÑÊåáÂÆöÁõÆÂΩï</td>
</tr>
<tr>
<td>RUN</td>
<td>ÊâßË°å Linux ÁöÑ shell ÂëΩ‰ª§Ôºå‰∏ÄËà¨ÊòØÂÆâË£ÖËøáÁ®ãÁöÑÂëΩ‰ª§</td>
</tr>
<tr>
<td>EXPOSE</td>
<td>ÊåáÂÆöÂÆπÂô®ËøêË°åÊó∂ÁõëÂê¨ÁöÑÁ´ØÂè£ÔºåÊòØÁªôÈïúÂÉè‰ΩøÁî®ËÄÖÁúãÁöÑ</td>
</tr>
<tr>
<td>ENTRYPOINT</td>
<td>ÈïúÂÉè‰∏≠Â∫îÁî®ÁöÑÂêØÂä®ÂëΩ‰ª§ÔºåÂÆπÂô®ËøêË°åÊó∂Ë∞ÉÁî®</td>
</tr>
</tbody></table>
<p>Êúâ‰∫∫Êèê‰æõ‰∫ÜÂü∫Á°ÄÁöÑÁ≥ªÁªüÂä†JDKÁéØÂ¢ÉÔºåÊàë‰ª¨Âú®Ê≠§Âü∫Á°Ä‰∏äÂà∂‰ΩújavaÈïúÂÉè:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Âü∫Á°ÄÈïúÂÉè</span><br>FROM openjdk:11.0-jre-buster<br><span class="hljs-comment"># ËÆæÂÆöÊó∂Âå∫</span><br>ENV TZ=Asia/Shanghai<br>RUN <span class="hljs-built_in">ln</span> -snf /usr/share/zoneinfo/<span class="hljs-variable">$TZ</span> /etc/localtime &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-variable">$TZ</span> &gt; /etc/timezone<br><span class="hljs-comment"># Êã∑Ë¥ùjarÂåÖ</span><br>COPY docker-demo.jar /app.jar<br><span class="hljs-comment"># ÂÖ•Âè£</span><br>ENTRYPOINT [<span class="hljs-string">&quot;java&quot;</span>, <span class="hljs-string">&quot;-jar&quot;</span>, <span class="hljs-string">&quot;/app.jar&quot;</span>]<br></code></pre></td></tr></table></figure>

<h2 id="5-Ëá™ÂÆö‰πâÁΩëÁªú"><a href="#5-Ëá™ÂÆö‰πâÁΩëÁªú" class="headerlink" title="5. Ëá™ÂÆö‰πâÁΩëÁªú"></a>5. Ëá™ÂÆö‰πâÁΩëÁªú</h2><p>ÂÆπÂô®ÁöÑÁΩëÁªúIPÂÖ∂ÂÆûÊòØ‰∏Ä‰∏™ËôöÊãüÁöÑIPÔºåÂÖ∂ÂÄº<strong>Âπ∂‰∏çÂõ∫ÂÆö</strong>‰∏éÊüê‰∏Ä‰∏™ÂÆπÂô®ÁªëÂÆö</p>
<ul>
<li>Âú®Ëá™ÂÆö‰πâÁΩëÁªú‰∏≠ÔºåÂèØ‰ª•ÁªôÂÆπÂô®Ëµ∑Â§ö‰∏™Âà´ÂêçÔºåÈªòËÆ§ÁöÑÂà´ÂêçÊòØÂÆπÂô®ÂêçÊú¨Ë∫´</li>
<li>Âú®Âêå‰∏Ä‰∏™Ëá™ÂÆö‰πâÁΩëÁªú‰∏≠ÁöÑÂÆπÂô®ÔºåÂèØ‰ª•ÈÄöËøáÂà´Âêç‰∫íÁõ∏ËÆøÈóÆ</li>
</ul>
<table>
<thead>
<tr>
<th>ÂëΩ‰ª§</th>
<th>ËØ¥Êòé</th>
</tr>
</thead>
<tbody><tr>
<td>docker network create</td>
<td>ÂàõÂª∫‰∏Ä‰∏™ÁΩëÁªú</td>
</tr>
<tr>
<td>docker network ls</td>
<td>Êü•ÁúãÊâÄÊúâÁΩëÁªú</td>
</tr>
<tr>
<td>docker network rm</td>
<td>Âà†Èô§ÊåáÂÆöÁΩëÁªú</td>
</tr>
<tr>
<td>docker network prune</td>
<td>Ê∏ÖÈô§Êú™‰ΩøÁî®ÁöÑÁΩëÁªú</td>
</tr>
<tr>
<td>docker network connect</td>
<td>‰ΩøÊåáÂÆöÂÆπÂô®ËøûÊé•Âä†ÂÖ•ÊüêÁΩëÁªú</td>
</tr>
<tr>
<td>docker network disconnect</td>
<td>‰ΩøÊåáÂÆöÂÆπÂô®ËøûÊé•Á¶ªÂºÄÊüêÁΩëÁªú</td>
</tr>
<tr>
<td>docker network inspect</td>
<td>Êü•ÁúãÁΩëÁªúËØ¶ÁªÜ‰ø°ÊÅØ</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 1.È¶ñÂÖàÈÄöËøáÂëΩ‰ª§ÂàõÂª∫‰∏Ä‰∏™ÁΩëÁªú</span><br>docker network create hmall<br><br><span class="hljs-comment"># 2.ÁÑ∂ÂêéÊü•ÁúãÁΩëÁªú</span><br>docker network <span class="hljs-built_in">ls</span><br><span class="hljs-comment"># ÁªìÊûúÔºö</span><br>NETWORK ID     NAME      DRIVER    SCOPE<br>639bc44d0a87   bridge    bridge    <span class="hljs-built_in">local</span><br>403f16ec62a2   hmall     bridge    <span class="hljs-built_in">local</span><br>0dc0f72a0fbb   host      host      <span class="hljs-built_in">local</span><br>cd8d3e8df47b   none      null      <span class="hljs-built_in">local</span><br><span class="hljs-comment"># ÂÖ∂‰∏≠ÔºåÈô§‰∫Ühmall‰ª•Â§ñÔºåÂÖ∂ÂÆÉÈÉΩÊòØÈªòËÆ§ÁöÑÁΩëÁªú</span><br><br><span class="hljs-comment"># 3.ËÆ©ddÂíåmysqlÈÉΩÂä†ÂÖ•ËØ•ÁΩëÁªúÔºåÊ≥®ÊÑèÔºåÂú®Âä†ÂÖ•ÁΩëÁªúÊó∂ÂèØ‰ª•ÈÄöËøá--aliasÁªôÂÆπÂô®Ëµ∑Âà´Âêç</span><br><span class="hljs-comment"># ËøôÊ†∑ËØ•ÁΩëÁªúÂÜÖÁöÑÂÖ∂ÂÆÉÂÆπÂô®ÂèØ‰ª•Áî®Âà´Âêç‰∫íÁõ∏ËÆøÈóÆÔºÅ</span><br><span class="hljs-comment"># 3.1.mysqlÂÆπÂô®ÔºåÊåáÂÆöÂà´Âêç‰∏∫dbÔºåÂè¶Â§ñÊØè‰∏Ä‰∏™ÂÆπÂô®ÈÉΩÊúâ‰∏Ä‰∏™Âà´ÂêçÊòØÂÆπÂô®Âêç</span><br>docker network connect hmall mysql --<span class="hljs-built_in">alias</span> db<br><span class="hljs-comment"># 3.2.dbÂÆπÂô®Ôºå‰πüÂ∞±ÊòØÊàë‰ª¨ÁöÑjavaÈ°πÁõÆ</span><br>docker network connect hmall <span class="hljs-built_in">dd</span><br><br><span class="hljs-comment"># 4.ËøõÂÖ•ddÂÆπÂô®ÔºåÂ∞ùËØïÂà©Áî®Âà´ÂêçËÆøÈóÆdb</span><br><span class="hljs-comment"># 4.1.ËøõÂÖ•ÂÆπÂô®</span><br>docker <span class="hljs-built_in">exec</span> -it <span class="hljs-built_in">dd</span> bash<br><span class="hljs-comment"># 4.2.Áî®dbÂà´ÂêçËÆøÈóÆ</span><br>ping db<br><span class="hljs-comment"># ÁªìÊûú</span><br>PING db (172.18.0.2) 56(84) bytes of data.<br>64 bytes from mysql.hmall (172.18.0.2): icmp_seq=1 ttl=64 <span class="hljs-keyword">time</span>=0.070 ms<br>64 bytes from mysql.hmall (172.18.0.2): icmp_seq=2 ttl=64 <span class="hljs-keyword">time</span>=0.056 ms<br><span class="hljs-comment"># 4.3.Áî®ÂÆπÂô®ÂêçËÆøÈóÆ</span><br>ping mysql<br><span class="hljs-comment"># ÁªìÊûúÔºö</span><br>PING mysql (172.18.0.2) 56(84) bytes of data.<br>64 bytes from mysql.hmall (172.18.0.2): icmp_seq=1 ttl=64 <span class="hljs-keyword">time</span>=0.044 ms<br>64 bytes from mysql.hmall (172.18.0.2): icmp_seq=2 ttl=64 <span class="hljs-keyword">time</span>=0.054 ms<br></code></pre></td></tr></table></figure>

<h2 id="6-DockerCompose"><a href="#6-DockerCompose" class="headerlink" title="6. DockerCompose"></a>6. DockerCompose</h2><p>Docker ComposeÂèØ‰ª•Â∏ÆÂä©Êàë‰ª¨<strong>ÂÆûÁé∞Â§ö‰∏™Áõ∏‰∫íÂÖ≥ËÅîÁöÑDockerÂÆπÂô®ÁöÑÂø´ÈÄüÈÉ®ÁΩ≤</strong>„ÄÇÂÆÉÂÖÅËÆ∏Áî®Êà∑ÈÄöËøá‰∏Ä‰∏™ÂçïÁã¨ÁöÑ docker-compose.yml Ê®°ÊùøÊñá‰ª∂ÔºàYAML Ê†ºÂºèÔºâÊù•ÂÆö‰πâ‰∏ÄÁªÑÁõ∏ÂÖ≥ËÅîÁöÑÂ∫îÁî®ÂÆπÂô®„ÄÇ</p>
<p>ÈÉ®ÁΩ≤mysqlÔºåÂèØ‰ª•‰ΩøÁî®docker-compose.ymlËøõË°åÈÉ®ÁΩ≤</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">version:</span> <span class="hljs-string">&quot;3.8&quot;</span><br><br><span class="hljs-attr">services:</span><br>  <span class="hljs-attr">mysql:</span><br>    <span class="hljs-attr">image:</span> <span class="hljs-string">mysql</span><br>    <span class="hljs-attr">container_name:</span> <span class="hljs-string">mysql</span><br>    <span class="hljs-attr">ports:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;3306:3306&quot;</span><br>    <span class="hljs-attr">environment:</span><br>      <span class="hljs-attr">TZ:</span> <span class="hljs-string">Asia/Shanghai</span><br>      <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-number">123</span><br>    <span class="hljs-attr">volumes:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;./mysql/conf:/etc/mysql/conf.d&quot;</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;./mysql/data:/var/lib/mysql&quot;</span><br>    <span class="hljs-attr">networks:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">new</span><br><span class="hljs-attr">networks:</span><br>  <span class="hljs-attr">new:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">hmall</span><br></code></pre></td></tr></table></figure>

<p>Âü∫Êú¨ËØ≠Ê≥ïÂ¶Ç‰∏ãÔºö</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker compose [OPTIONS] [COMMAND]<br></code></pre></td></tr></table></figure>

<table>
  <thead>
    <tr>
      <th>Á±ªÂûã</th>
      <th>ÂèÇÊï∞ÊàñÊåá‰ª§</th>
      <th>ËØ¥Êòé</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="2">Options</td>
      <td>-f</td>
      <td>ÊåáÂÆö compose Êñá‰ª∂ÁöÑË∑ØÂæÑÂíåÂêçÁß∞</td>
    </tr>
    <tr>
      <td>-p</td>
      <td>ÊåáÂÆö project ÂêçÁß∞„ÄÇproject Â∞±ÊòØÂΩìÂâç compose Êñá‰ª∂‰∏≠ËÆæÁΩÆÁöÑÂ§ö‰∏™ service ÁöÑÈõÜÂêàÔºåÊòØÈÄªËæëÊ¶ÇÂøµ</td>
    </tr>
    <tr>
     <td rowspan="9">Commands</td>
      <td>up</td>
      <td>ÂàõÂª∫Âπ∂ÂêØÂä®ÊâÄÊúâ service ÂÆπÂô®</td>
    </tr>
    <tr>
      <td>down</td>
      <td>ÂÅúÊ≠¢Âπ∂ÁßªÈô§ÊâÄÊúâÂÆπÂô®„ÄÅÁΩëÁªú</td>
    </tr>
    <tr>
      <td>ps</td>
      <td>ÂàóÂá∫ÊâÄÊúâÂêØÂä®ÁöÑÂÆπÂô®</td>
    </tr>
    <tr>
      <td>logs</td>
      <td>Êü•ÁúãÊåáÂÆöÂÆπÂô®ÁöÑÊó•Âøó</td>
    </tr>
    <tr>
      <td>stop</td>
      <td>ÂÅúÊ≠¢ÂÆπÂô®</td>
    </tr>
    <tr>
      <td>start</td>
      <td>ÂêØÂä®ÂÆπÂô®</td>
    </tr>
    <tr>
      <td>restart</td>
      <td>ÈáçÂêØÂÆπÂô®</td>
    </tr>
    <tr>
      <td>top</td>
      <td>Êü•ÁúãËøêË°åÁöÑËøõÁ®ã</td>
    </tr>
    <tr>
      <td>exec</td>
      <td>Âú®ÊåáÂÆöÁöÑËøêË°å‰∏≠ÂÆπÂô®‰∏≠ÊâßË°åÂëΩ‰ª§</td>
    </tr>
  </tbody>
</table>

<h1 id="‰∏â-ÂæÆÊúçÂä°"><a href="#‰∏â-ÂæÆÊúçÂä°" class="headerlink" title="‰∏â. ÂæÆÊúçÂä°"></a>‰∏â. ÂæÆÊúçÂä°</h1><h2 id="1-ËÆ§ËØÜÂæÆÊúçÂä°"><a href="#1-ËÆ§ËØÜÂæÆÊúçÂä°" class="headerlink" title="1. ËÆ§ËØÜÂæÆÊúçÂä°"></a>1. ËÆ§ËØÜÂæÆÊúçÂä°</h2><h3 id="1-1-Âçï‰ΩìÊû∂ÊûÑ"><a href="#1-1-Âçï‰ΩìÊû∂ÊûÑ" class="headerlink" title="1.1.Âçï‰ΩìÊû∂ÊûÑ"></a>1.1.Âçï‰ΩìÊû∂ÊûÑ</h3><p>Âçï‰ΩìÊû∂ÊûÑÔºàmonolithic structureÔºâÔºöÈ°æÂêçÊÄù‰πâÔºåÊï¥‰∏™È°πÁõÆ‰∏≠<strong>ÊâÄÊúâÂäüËÉΩÊ®°ÂùóÈÉΩÂú®‰∏Ä‰∏™Â∑•Á®ã‰∏≠ÂºÄÂèë</strong>ÔºõÈ°πÁõÆÈÉ®ÁΩ≤Êó∂ÈúÄË¶Å<strong>ÂØπÊâÄÊúâÊ®°Âùó‰∏ÄËµ∑ÁºñËØë„ÄÅÊâìÂåÖ</strong>ÔºõÈ°πÁõÆÁöÑÊû∂ÊûÑËÆæËÆ°„ÄÅÂºÄÂèëÊ®°ÂºèÈÉΩÈùûÂ∏∏ÁÆÄÂçï„ÄÇ</p>
<h3 id="1-2-ÂæÆÊúçÂä°"><a href="#1-2-ÂæÆÊúçÂä°" class="headerlink" title="1.2 ÂæÆÊúçÂä°"></a>1.2 ÂæÆÊúçÂä°</h3><p>ÂæÆÊúçÂä°Êû∂ÊûÑÔºåÈ¶ñÂÖàÊòØÊúçÂä°ÂåñÔºåÂ∞±ÊòØ<strong>Â∞ÜÂçï‰ΩìÊû∂ÊûÑ‰∏≠ÁöÑÂäüËÉΩÊ®°Âùó‰ªéÂçï‰ΩìÂ∫îÁî®‰∏≠ÊãÜÂàÜÂá∫Êù•</strong>ÔºåÁã¨Á´ãÈÉ®ÁΩ≤‰∏∫Â§ö‰∏™ÊúçÂä°„ÄÇÂêåÊó∂Ë¶ÅÊª°Ë∂≥‰∏ãÈù¢ÁöÑ‰∏Ä‰∫õÁâπÁÇπÔºö</p>
<ul>
<li>Âçï‰∏ÄËÅåË¥£Ôºö‰∏Ä‰∏™ÂæÆÊúçÂä°Ë¥üË¥£‰∏ÄÈÉ®ÂàÜ‰∏öÂä°ÂäüËÉΩÔºåÂπ∂‰∏îÂÖ∂Ê†∏ÂøÉÊï∞ÊçÆ‰∏ç‰æùËµñ‰∫éÂÖ∂ÂÆÉÊ®°Âùó„ÄÇ</li>
<li>Âõ¢ÈòüËá™Ê≤ªÔºöÊØè‰∏™ÂæÆÊúçÂä°ÈÉΩÊúâËá™Â∑±Áã¨Á´ãÁöÑÂºÄÂèë„ÄÅÊµãËØï„ÄÅÂèëÂ∏É„ÄÅËøêÁª¥‰∫∫ÂëòÔºåÂõ¢Èòü‰∫∫ÂëòËßÑÊ®°‰∏çË∂ÖËøá10‰∫∫Ôºà2Âº†Êä´Ëê®ËÉΩÂñÇÈ•±Ôºâ</li>
<li>ÊúçÂä°Ëá™Ê≤ªÔºö<strong>ÊØè‰∏™ÂæÆÊúçÂä°ÈÉΩÁã¨Á´ãÊâìÂåÖÈÉ®ÁΩ≤ÔºåËÆøÈóÆËá™Â∑±Áã¨Á´ãÁöÑÊï∞ÊçÆÂ∫ì</strong>„ÄÇÂπ∂‰∏îË¶ÅÂÅöÂ•ΩÊúçÂä°ÈöîÁ¶ªÔºåÈÅøÂÖçÂØπÂÖ∂ÂÆÉÊúçÂä°‰∫ßÁîüÂΩ±Âìç</li>
</ul>
<p><img src="/img/blogs/java/springcloud/3.1.1.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="1-3-SpringCloud"><a href="#1-3-SpringCloud" class="headerlink" title="1.3 SpringCloud"></a>1.3 SpringCloud</h3><p>SpringCloudÊ°ÜÊû∂ÊòØÁõÆÂâçJavaÈ¢ÜÂüüÊúÄÂÖ®Èù¢ÁöÑÂæÆÊúçÂä°ÁªÑ‰ª∂ÁöÑÈõÜÂêà</p>
<h2 id="2-ÂæÆÊúçÂä°ÊãÜÂàÜ"><a href="#2-ÂæÆÊúçÂä°ÊãÜÂàÜ" class="headerlink" title="2. ÂæÆÊúçÂä°ÊãÜÂàÜ"></a>2. ÂæÆÊúçÂä°ÊãÜÂàÜ</h2><h3 id="2-1-ÂæÆÊúçÂä°ÊãÜÂàÜÂéüÂàô"><a href="#2-1-ÂæÆÊúçÂä°ÊãÜÂàÜÂéüÂàô" class="headerlink" title="2.1 ÂæÆÊúçÂä°ÊãÜÂàÜÂéüÂàô"></a>2.1 ÂæÆÊúçÂä°ÊãÜÂàÜÂéüÂàô</h3><h4 id="2-1-1-‰ªÄ‰πàÊó∂ÂÄôÊãÜ"><a href="#2-1-1-‰ªÄ‰πàÊó∂ÂÄôÊãÜ" class="headerlink" title="2.1.1 ‰ªÄ‰πàÊó∂ÂÄôÊãÜ"></a>2.1.1 ‰ªÄ‰πàÊó∂ÂÄôÊãÜ</h4><ul>
<li>ÂØπ‰∫é<strong>Â§ßÂ§öÊï∞Â∞èÂûãÈ°πÁõÆÊù•ËØ¥Ôºå‰∏ÄËà¨ÊòØÂÖàÈááÁî®Âçï‰ΩìÊû∂ÊûÑ</strong>ÔºåÈöèÁùÄÁî®Êà∑ËßÑÊ®°Êâ©Â§ß„ÄÅ<strong>‰∏öÂä°Â§çÊùÇÂêéÂÜçÈÄêÊ∏êÊãÜÂàÜ‰∏∫ÂæÆÊúçÂä°Êû∂ÊûÑ</strong>„ÄÇËøôÊ†∑ÂàùÊúüÊàêÊú¨‰ºöÊØîËæÉ‰ΩéÔºåÂèØ‰ª•Âø´ÈÄüËØïÈîô„ÄÇ‰ΩÜÊòØÔºåËøô‰πàÂÅöÁöÑÈóÆÈ¢òÂ∞±Âú®‰∫éÂêéÊúüÂÅöÊúçÂä°ÊãÜÂàÜÊó∂ÔºåÂèØËÉΩ‰ºöÈÅáÂà∞ÂæàÂ§ö‰ª£Á†ÅËÄ¶ÂêàÂ∏¶Êù•ÁöÑÈóÆÈ¢òÔºåÊãÜÂàÜÊØîËæÉÂõ∞ÈöæÔºà<strong>ÂâçÊòìÂêéÈöæ</strong>Ôºâ„ÄÇ</li>
<li>ËÄå<strong>ÂØπ‰∫é‰∏Ä‰∫õÂ§ßÂûãÈ°πÁõÆ</strong>ÔºåÂú®Á´ãÈ°π‰πãÂàùÁõÆÁöÑÂ∞±ÂæàÊòéÁ°ÆÔºå‰∏∫‰∫ÜÈïøËøúËÄÉËôëÔºåÂú®Êû∂ÊûÑËÆæËÆ°Êó∂Â∞±<strong>Áõ¥Êé•ÈÄâÊã©ÂæÆÊúçÂä°Êû∂ÊûÑ</strong>„ÄÇËôΩÁÑ∂ÂâçÊúüÊäïÂÖ•ËæÉÂ§öÔºå‰ΩÜÂêéÊúüÂ∞±Â∞ë‰∫ÜÊãÜÂàÜÊúçÂä°ÁöÑÁÉ¶ÊÅºÔºà<strong>ÂâçÈöæÂêéÊòì</strong>Ôºâ„ÄÇ</li>
</ul>
<h4 id="2-1-2-ÊÄé‰πàÊãÜ"><a href="#2-1-2-ÊÄé‰πàÊãÜ" class="headerlink" title="2.1.2 ÊÄé‰πàÊãÜ"></a>2.1.2 ÊÄé‰πàÊãÜ</h4><ul>
<li>ÁõÆÊ†áÔºöÂæÆÊúçÂä°ÊãÜÂàÜÊó∂Á≤íÂ∫¶Ë¶ÅÂ∞è</li>
<li><strong>È´òÂÜÖËÅö</strong>ÔºöÊØè‰∏™ÂæÆÊúçÂä°ÁöÑËÅåË¥£Ë¶ÅÂ∞ΩÈáèÂçï‰∏ÄÔºåÂåÖÂê´ÁöÑ‰∏öÂä°Áõ∏‰∫íÂÖ≥ËÅîÂ∫¶È´ò„ÄÅÂÆåÊï¥Â∫¶È´ò„ÄÇ</li>
<li><strong>‰ΩéËÄ¶Âêà</strong>ÔºöÊØè‰∏™ÂæÆÊúçÂä°ÁöÑÂäüËÉΩË¶ÅÁõ∏ÂØπÁã¨Á´ãÔºåÂ∞ΩÈáèÂáèÂ∞ëÂØπÂÖ∂ÂÆÉÂæÆÊúçÂä°ÁöÑ‰æùËµñÔºåÊàñËÄÖ‰æùËµñÊé•Âè£ÁöÑÁ®≥ÂÆöÊÄßË¶ÅÂº∫„ÄÇ</li>
</ul>
<p>Êàë‰ª¨Âú®ÂÅöÊúçÂä°ÊãÜÂàÜÊó∂‰∏ÄËà¨Êúâ‰∏§ÁßçÊñπÂºèÔºö</p>
<ul>
<li>Á∫µÂêëÊãÜÂàÜÔºö<strong>ÊåâÁÖßÈ°πÁõÆÁöÑÂäüËÉΩÊ®°ÂùóÊù•ÊãÜÂàÜ</strong>„ÄÇ‰æãÂ¶ÇÈªëÈ©¨ÂïÜÂüé‰∏≠ÔºåÂ∞±ÊúâÁî®Êà∑ÁÆ°ÁêÜÂäüËÉΩ„ÄÅËÆ¢ÂçïÁÆ°ÁêÜÂäüËÉΩ„ÄÅË¥≠Áâ©ËΩ¶ÂäüËÉΩ„ÄÅÂïÜÂìÅÁÆ°ÁêÜÂäüËÉΩ„ÄÅÊîØ‰ªòÂäüËÉΩÁ≠â„ÄÇÈÇ£‰πàÊåâÁÖßÂäüËÉΩÊ®°ÂùóÂ∞Ü‰ªñ‰ª¨ÊãÜÂàÜ‰∏∫‰∏Ä‰∏™‰∏™ÊúçÂä°ÔºåÂ∞±Â±û‰∫éÁ∫µÂêëÊãÜÂàÜ„ÄÇËøôÁßçÊãÜÂàÜÊ®°ÂºèÂèØ‰ª•Â∞ΩÂèØËÉΩÊèêÈ´òÊúçÂä°ÁöÑÂÜÖËÅöÊÄß„ÄÇ</li>
<li>Ê®™ÂêëÊãÜÂàÜÔºöÂêÑ‰∏™ÂäüËÉΩÊ®°Âùó‰πãÈó¥ÊúâÊ≤°Êúâ<strong>ÂÖ¨ÂÖ±ÁöÑ‰∏öÂä°ÈÉ®ÂàÜÔºåÂ¶ÇÊûúÊúâÂ∞ÜÂÖ∂ÊäΩÂèñÂá∫Êù•‰Ωú‰∏∫ÈÄöÁî®ÊúçÂä°</strong>„ÄÇ‰æãÂ¶ÇÁî®Êà∑ÁôªÂΩïÊòØÈúÄË¶ÅÂèëÈÄÅÊ∂àÊÅØÈÄöÁü•ÔºåËÆ∞ÂΩïÈ£éÊéßÊï∞ÊçÆÔºå‰∏ãÂçïÊó∂‰πüË¶ÅÂèëÈÄÅÁü≠‰ø°ÔºåËÆ∞ÂΩïÈ£éÊéßÊï∞ÊçÆ„ÄÇ</li>
</ul>
<p>‰∏ÄËà¨ÂæÆÊúçÂä°È°πÁõÆÊúâ‰∏§Áßç‰∏çÂêåÁöÑÂ∑•Á®ãÁªìÊûÑÔºö</p>
<ul>
<li>ÂÆåÂÖ®Ëß£ËÄ¶ÔºöÊØè‰∏Ä‰∏™ÂæÆÊúçÂä°ÈÉΩÂàõÂª∫‰∏∫‰∏Ä‰∏™Áã¨Á´ãÁöÑÂ∑•Á®ãÔºåÁîöËá≥ÂèØ‰ª•‰ΩøÁî®‰∏çÂêåÁöÑÂºÄÂèëËØ≠Ë®ÄÊù•ÂºÄÂèëÔºåÈ°πÁõÆÂÆåÂÖ®Ëß£ËÄ¶„ÄÇ<ul>
<li>‰ºòÁÇπÔºöÊúçÂä°‰πãÈó¥ËÄ¶ÂêàÂ∫¶‰Ωé</li>
<li>Áº∫ÁÇπÔºöÊØè‰∏™È°πÁõÆÈÉΩÊúâËá™Â∑±ÁöÑÁã¨Á´ã‰ªìÂ∫ìÔºåÁÆ°ÁêÜËµ∑Êù•ÊØîËæÉÈ∫ªÁÉ¶</li>
</ul>
</li>
<li>MavenËÅöÂêàÔºöÊï¥‰∏™È°πÁõÆ‰∏∫‰∏Ä‰∏™ProjectÔºåÁÑ∂ÂêéÊØè‰∏™ÂæÆÊúçÂä°ÊòØÂÖ∂‰∏≠ÁöÑ‰∏Ä‰∏™Module<ul>
<li>‰ºòÁÇπÔºöÈ°πÁõÆ‰ª£Á†ÅÈõÜ‰∏≠ÔºåÁÆ°ÁêÜÂíåËøêÁª¥Êñπ‰æø</li>
<li>Áº∫ÁÇπÔºöÊúçÂä°‰πãÈó¥ËÄ¶ÂêàÔºåÁºñËØëÊó∂Èó¥ËæÉÈïø</li>
</ul>
</li>
</ul>
<h3 id="2-2-ÈªëÈ©¨ÂïÜÂüéÁöÑÊãÜÂàÜ"><a href="#2-2-ÈªëÈ©¨ÂïÜÂüéÁöÑÊãÜÂàÜ" class="headerlink" title="2.2 ÈªëÈ©¨ÂïÜÂüéÁöÑÊãÜÂàÜ"></a>2.2 ÈªëÈ©¨ÂïÜÂüéÁöÑÊãÜÂàÜ</h3><p><img src="/img/blogs/java/springcloud/3.2.1.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/blogs/java/springcloud/3.2.2.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="/img/blogs/java/springcloud/3.2.3.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="3-ÊúçÂä°Ê≥®ÂÜåÂíåÂèëÁé∞-‰∏é-OpenFeign"><a href="#3-ÊúçÂä°Ê≥®ÂÜåÂíåÂèëÁé∞-‰∏é-OpenFeign" class="headerlink" title="3. ÊúçÂä°Ê≥®ÂÜåÂíåÂèëÁé∞ ‰∏é OpenFeign"></a>3. ÊúçÂä°Ê≥®ÂÜåÂíåÂèëÁé∞ ‰∏é OpenFeign</h2><h3 id="3-1-Ê≥®ÂÜå‰∏≠ÂøÉÂéüÁêÜ"><a href="#3-1-Ê≥®ÂÜå‰∏≠ÂøÉÂéüÁêÜ" class="headerlink" title="3.1 Ê≥®ÂÜå‰∏≠ÂøÉÂéüÁêÜ"></a>3.1 Ê≥®ÂÜå‰∏≠ÂøÉÂéüÁêÜ</h3><p>Âú®ÂæÆÊúçÂä°<strong>ËøúÁ®ãË∞ÉÁî®</strong>ÁöÑËøáÁ®ã‰∏≠ÔºåÂåÖÊã¨‰∏§‰∏™ËßíËâ≤Ôºö</p>
<ul>
<li><strong>ÊúçÂä°Êèê‰æõËÄÖ</strong>ÔºöÊèê‰æõÊé•Âè£‰æõÂÖ∂ÂÆÉÂæÆÊúçÂä°ËÆøÈóÆÔºåÊØîÂ¶Çitem-service</li>
<li><strong>ÊúçÂä°Ê∂àË¥πËÄÖ</strong>ÔºöË∞ÉÁî®ÂÖ∂ÂÆÉÂæÆÊúçÂä°Êèê‰æõÁöÑÊé•Âè£ÔºåÊØîÂ¶Çcart-service</li>
</ul>
<p>Âú®Â§ßÂûãÂæÆÊúçÂä°È°πÁõÆ‰∏≠ÔºåÊúçÂä°Êèê‰æõËÄÖÁöÑÊï∞Èáè‰ºöÈùûÂ∏∏Â§öÔºå‰∏∫‰∫ÜÁÆ°ÁêÜËøô‰∫õÊúçÂä°Â∞±ÂºïÂÖ•‰∫ÜÊ≥®ÂÜå‰∏≠ÂøÉÁöÑÊ¶ÇÂøµ„ÄÇÊ≥®ÂÜå‰∏≠ÂøÉ„ÄÅÊúçÂä°Êèê‰æõËÄÖ„ÄÅÊúçÂä°Ê∂àË¥πËÄÖ‰∏âËÄÖÈó¥ÂÖ≥Á≥ªÂ¶Ç‰∏ãÔºö</p>
<p><img src="/img/blogs/java/springcloud/3.3.1.png" srcset="/img/loading.gif" lazyload></p>
<p>ÊµÅÁ®ãÂ¶Ç‰∏ãÔºö</p>
<ol>
<li>ÊúçÂä°ÂêØÂä®Êó∂Â∞±‰ºö<strong>Ê≥®ÂÜåËá™Â∑±ÁöÑÊúçÂä°‰ø°ÊÅØ</strong>ÔºàÊúçÂä°Âêç„ÄÅIP„ÄÅÁ´ØÂè£ÔºâÂà∞Ê≥®ÂÜå‰∏≠ÂøÉ</li>
<li>Ë∞ÉÁî®ËÄÖÂèØ‰ª•‰ªéÊ≥®ÂÜå‰∏≠ÂøÉËÆ¢ÈòÖÊÉ≥Ë¶ÅÁöÑÊúçÂä°ÔºåËé∑ÂèñÊúçÂä°ÂØπÂ∫îÁöÑÂÆû‰æãÂàóË°®Ôºà1‰∏™ÊúçÂä°ÂèØËÉΩÂ§öÂÆû‰æãÈÉ®ÁΩ≤Ôºâ</li>
<li>Ë∞ÉÁî®ËÄÖËá™Â∑±ÂØπÂÆû‰æãÂàóË°®Ë¥üËΩΩÂùáË°°Ôºå<strong>ÊåëÈÄâ‰∏Ä‰∏™ÂÆû‰æã</strong></li>
<li>Ë∞ÉÁî®ËÄÖÂêëËØ•ÂÆû‰æãÂèëËµ∑ËøúÁ®ãË∞ÉÁî®</li>
</ol>
<h3 id="3-2-NacosÊ≥®ÂÜå‰∏≠ÂøÉ"><a href="#3-2-NacosÊ≥®ÂÜå‰∏≠ÂøÉ" class="headerlink" title="3.2 NacosÊ≥®ÂÜå‰∏≠ÂøÉ"></a>3.2 NacosÊ≥®ÂÜå‰∏≠ÂøÉ</h3><p>Nacos: AlibabaÂÖ¨Âè∏Âá∫ÂìÅÔºåÁõÆÂâçË¢´ÈõÜÊàêÂú®SpringCloudAlibaba‰∏≠Ôºå‰∏ÄËà¨Áî®‰∫éJavaÂ∫îÁî®</p>
<h3 id="3-3-ÊúçÂä°Ê≥®ÂÜå"><a href="#3-3-ÊúçÂä°Ê≥®ÂÜå" class="headerlink" title="3.3 ÊúçÂä°Ê≥®ÂÜå"></a>3.3 ÊúçÂä°Ê≥®ÂÜå</h3><p>ÊääÈ°πÁõÆÊ≥®ÂÜåÂà∞Nacos, Ê≠•È™§Â¶Ç‰∏ãÔºö</p>
<ul>
<li>ÂºïÂÖ•‰æùËµñ</li>
<li>ÈÖçÁΩÆNacosÂú∞ÂùÄ</li>
<li>ÈáçÂêØ</li>
</ul>
<h4 id="3-3-1-Ê∑ªÂä†‰æùËµñ"><a href="#3-3-1-Ê∑ªÂä†‰æùËµñ" class="headerlink" title="3.3.1 Ê∑ªÂä†‰æùËµñ"></a>3.3.1 Ê∑ªÂä†‰æùËµñ</h4><p>pom.xml:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--nacos ÊúçÂä°Ê≥®ÂÜåÂèëÁé∞--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="3-3-2-ÈÖçÁΩÆNacos"><a href="#3-3-2-ÈÖçÁΩÆNacos" class="headerlink" title="3.3.2 ÈÖçÁΩÆNacos"></a>3.3.2 ÈÖçÁΩÆNacos</h4><p>application.yml:</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">application:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">item-service</span> <span class="hljs-comment"># ÊúçÂä°ÂêçÁß∞</span><br>  <span class="hljs-attr">cloud:</span><br>    <span class="hljs-attr">nacos:</span><br>      <span class="hljs-attr">server-addr:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.150</span><span class="hljs-number">.101</span><span class="hljs-string">:8848</span> <span class="hljs-comment"># nacosÂú∞ÂùÄ</span><br></code></pre></td></tr></table></figure>

<h3 id="3-4-ÊúçÂä°ÂèëÁé∞"><a href="#3-4-ÊúçÂä°ÂèëÁé∞" class="headerlink" title="3.4 ÊúçÂä°ÂèëÁé∞"></a>3.4 ÊúçÂä°ÂèëÁé∞</h3><p>ÊúçÂä°ÁöÑÊ∂àË¥πËÄÖË¶ÅÂéªnacosËÆ¢ÈòÖÊúçÂä°ÔºåËøô‰∏™ËøáÁ®ãÂ∞±ÊòØÊúçÂä°ÂèëÁé∞ÔºåÊ≠•È™§Â¶Ç‰∏ãÔºö</p>
<ul>
<li>ÂºïÂÖ•‰æùËµñ</li>
<li>ÈÖçÁΩÆNacosÂú∞ÂùÄ</li>
<li>ÂèëÁé∞Âπ∂Ë∞ÉÁî®ÊúçÂä°</li>
</ul>
<h3 id="3-5-OpenFeign"><a href="#3-5-OpenFeign" class="headerlink" title="3.5 OpenFeign"></a>3.5 OpenFeign</h3><p>ÂÖ∂ÂÆûËøúÁ®ãË∞ÉÁî®ÁöÑÂÖ≥ÈîÆÁÇπÂ∞±Âú®‰∫éÂõõ‰∏™Ôºö</p>
<ul>
<li>ËØ∑Ê±ÇÊñπÂºè</li>
<li>ËØ∑Ê±ÇË∑ØÂæÑ</li>
<li>ËØ∑Ê±ÇÂèÇÊï∞</li>
<li>ËøîÂõûÂÄºÁ±ªÂûã<br>ÊâÄ‰ª•ÔºåOpenFeignÂ∞±Âà©Áî®SpringMVCÁöÑÁõ∏ÂÖ≥Ê≥®Ëß£Êù•Â£∞Êòé‰∏äËø∞4‰∏™ÂèÇÊï∞ÔºåÁÑ∂ÂêéÂü∫‰∫éÂä®ÊÄÅ‰ª£ÁêÜÂ∏ÆÊàë‰ª¨ÁîüÊàêËøúÁ®ãË∞ÉÁî®ÁöÑ‰ª£Á†ÅÔºåËÄåÊó†ÈúÄÊàë‰ª¨ÊâãÂä®ÂÜçÁºñÂÜôÔºåÈùûÂ∏∏Êñπ‰æø„ÄÇ</li>
</ul>
<h3 id="3-6-ÊäΩÂèñÂæÆÊúçÂä°"><a href="#3-6-ÊäΩÂèñÂæÆÊúçÂä°" class="headerlink" title="3.6 ÊäΩÂèñÂæÆÊúçÂä°"></a>3.6 ÊäΩÂèñÂæÆÊúçÂä°</h3><p>ÈÅøÂÖçÈáçÂ§çÁºñÁ†ÅÁöÑÂäûÊ≥ïÂ∞±ÊòØÊäΩÂèñ„ÄÇËøôÈáåÊúâ‰∏§ÁßçÊäΩÂèñÊÄùË∑ØÔºö</p>
<ul>
<li>ÊÄùË∑Ø1ÔºöÊäΩÂèñÂà∞ÂæÆÊúçÂä°‰πãÂ§ñÁöÑÂÖ¨ÂÖ±module</li>
<li>ÊÄùË∑Ø2ÔºöÊØè‰∏™ÂæÆÊúçÂä°Ëá™Â∑±ÊäΩÂèñ‰∏Ä‰∏™module</li>
</ul>
<p><img src="/img/blogs/java/springcloud/3.3.2.png" srcset="/img/loading.gif" lazyload></p>
<p>ÊñπÊ°à1ÊäΩÂèñÊõ¥Âä†ÁÆÄÂçïÔºåÂ∑•Á®ãÁªìÊûÑ‰πüÊØîËæÉÊ∏ÖÊô∞Ôºå‰ΩÜÁº∫ÁÇπÊòØÊï¥‰∏™È°πÁõÆËÄ¶ÂêàÂ∫¶ÂÅèÈ´ò„ÄÇ<br>ÊñπÊ°à2ÊäΩÂèñÁõ∏ÂØπÈ∫ªÁÉ¶ÔºåÂ∑•Á®ãÁªìÊûÑÁõ∏ÂØπÊõ¥Â§çÊùÇÔºå‰ΩÜÊúçÂä°‰πãÈó¥ËÄ¶ÂêàÂ∫¶Èôç‰Ωé„ÄÇ</p>
<h2 id="4-ÁΩëÂÖ≥"><a href="#4-ÁΩëÂÖ≥" class="headerlink" title="4. ÁΩëÂÖ≥"></a>4. ÁΩëÂÖ≥</h2><h3 id="4-1-ËÆ§ËØÜÁΩëÂÖ≥"><a href="#4-1-ËÆ§ËØÜÁΩëÂÖ≥" class="headerlink" title="4.1 ËÆ§ËØÜÁΩëÂÖ≥"></a>4.1 ËÆ§ËØÜÁΩëÂÖ≥</h3><p>ÁΩëÂÖ≥Â∞±ÊòØÁΩëÁªúÁöÑÂÖ≥Âè£„ÄÇÊï∞ÊçÆÂú®ÁΩëÁªúÈó¥‰º†ËæìÔºå‰ªé‰∏Ä‰∏™ÁΩëÁªú‰º†ËæìÂà∞Âè¶‰∏ÄÁΩëÁªúÊó∂Â∞±ÈúÄË¶ÅÁªèËøá<strong>ÁΩëÂÖ≥Êù•ÂÅöÊï∞ÊçÆÁöÑË∑ØÁî±ÂíåËΩ¨Âèë‰ª•ÂèäÊï∞ÊçÆÂÆâÂÖ®ÁöÑÊ†°È™å„ÄÇ</strong></p>
<p><img src="/img/blogs/java/springcloud/3.4.1.png" srcset="/img/loading.gif" lazyload></p>
<p>ÂâçÁ´ØËØ∑Ê±Ç‰∏çËÉΩÁõ¥Êé•ËÆøÈóÆÂæÆÊúçÂä°ÔºåËÄåÊòØË¶ÅËØ∑Ê±ÇÁΩëÂÖ≥Ôºö</p>
<ul>
<li>ÁΩëÂÖ≥ÂèØ‰ª•ÂÅöÂÆâÂÖ®ÊéßÂà∂Ôºå‰πüÂ∞±ÊòØ<strong>ÁôªÂΩïË∫´‰ªΩÊ†°È™å</strong>ÔºåÊ†°È™åÈÄöËøáÊâçÊîæË°å</li>
<li>ÈÄöËøáËÆ§ËØÅÂêéÔºåÁΩëÂÖ≥ÂÜçÊ†πÊçÆËØ∑Ê±ÇÂà§Êñ≠Â∫îËØ•ËÆøÈóÆÂì™‰∏™ÂæÆÊúçÂä°ÔºåÂ∞ÜËØ∑Ê±ÇËΩ¨ÂèëËøáÂéª</li>
</ul>
<h3 id="4-2-ÁΩëÂÖ≥Ë∑ØÁî±Âø´ÈÄüÂÖ•Èó®"><a href="#4-2-ÁΩëÂÖ≥Ë∑ØÁî±Âø´ÈÄüÂÖ•Èó®" class="headerlink" title="4.2 ÁΩëÂÖ≥Ë∑ØÁî±Âø´ÈÄüÂÖ•Èó®"></a>4.2 ÁΩëÂÖ≥Ë∑ØÁî±Âø´ÈÄüÂÖ•Èó®</h3><p>Ê≠•È™§Â¶Ç‰∏ãÔºö</p>
<ul>
<li>ÂàõÂª∫ÁΩëÂÖ≥ÂæÆÊúçÂä°</li>
<li>ÂºïÂÖ•SpringCloudGateway„ÄÅNacosDiscovery‰æùËµñ</li>
<li>ÁºñÂÜôÂêØÂä®Á±ª</li>
<li>ÈÖçÁΩÆÁΩëÂÖ≥Ë∑ØÁî±</li>
</ul>
<p>Âú®hm-gatewayÊ®°ÂùóÁöÑresourcesÁõÆÂΩïÊñ∞Âª∫‰∏Ä‰∏™application.yamlÊñá‰ª∂,ÈÖçÁΩÆÁΩëÂÖ≥Ë∑ØÁî±Ôºö</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8080</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">application:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">gateway</span><br>  <span class="hljs-attr">cloud:</span><br>    <span class="hljs-attr">nacos:</span><br>      <span class="hljs-attr">server-addr:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.150</span><span class="hljs-number">.101</span><span class="hljs-string">:8848</span><br>    <span class="hljs-attr">gateway:</span><br>      <span class="hljs-attr">routes:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">id:</span> <span class="hljs-string">item</span> <span class="hljs-comment"># Ë∑ØÁî±ËßÑÂàôidÔºåËá™ÂÆö‰πâÔºåÂîØ‰∏Ä</span><br>          <span class="hljs-attr">uri:</span> <span class="hljs-string">lb://item-service</span> <span class="hljs-comment"># Ë∑ØÁî±ÁöÑÁõÆÊ†áÊúçÂä°Ôºålb‰ª£Ë°®Ë¥üËΩΩÂùáË°°Ôºå‰ºö‰ªéÊ≥®ÂÜå‰∏≠ÂøÉÊãâÂèñÊúçÂä°ÂàóË°®</span><br>          <span class="hljs-attr">predicates:</span> <span class="hljs-comment"># Ë∑ØÁî±Êñ≠Ë®ÄÔºåÂà§Êñ≠ÂΩìÂâçËØ∑Ê±ÇÊòØÂê¶Á¨¶ÂêàÂΩìÂâçËßÑÂàôÔºåÁ¨¶ÂêàÂàôË∑ØÁî±Âà∞ÁõÆÊ†áÊúçÂä°</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-string">Path=/items/**,/search/**</span> <span class="hljs-comment"># ËøôÈáåÊòØ‰ª•ËØ∑Ê±ÇË∑ØÂæÑ‰Ωú‰∏∫Âà§Êñ≠ËßÑÂàô</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">id:</span> <span class="hljs-string">cart</span><br>          <span class="hljs-attr">uri:</span> <span class="hljs-string">lb://cart-service</span><br>          <span class="hljs-attr">predicates:</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-string">Path=/carts/**</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">id:</span> <span class="hljs-string">user</span><br>          <span class="hljs-attr">uri:</span> <span class="hljs-string">lb://user-service</span><br>          <span class="hljs-attr">predicates:</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-string">Path=/users/**,/addresses/**</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">id:</span> <span class="hljs-string">trade</span><br>          <span class="hljs-attr">uri:</span> <span class="hljs-string">lb://trade-service</span><br>          <span class="hljs-attr">predicates:</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-string">Path=/orders/**</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">id:</span> <span class="hljs-string">pay</span><br>          <span class="hljs-attr">uri:</span> <span class="hljs-string">lb://pay-service</span><br>          <span class="hljs-attr">predicates:</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-string">Path=/pay-orders/**</span><br></code></pre></td></tr></table></figure>

<h3 id="4-3-Ë∑ØÁî±ËøáÊª§"><a href="#4-3-Ë∑ØÁî±ËøáÊª§" class="headerlink" title="4.3 Ë∑ØÁî±ËøáÊª§"></a>4.3 Ë∑ØÁî±ËøáÊª§</h3><p>Ë∑ØÁî±ËßÑÂàôÔºö</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">cloud:</span><br>    <span class="hljs-attr">gateway:</span><br>      <span class="hljs-attr">routes:</span><br>        <span class="hljs-bullet">-</span> <span class="hljs-attr">id:</span> <span class="hljs-string">item</span><br>          <span class="hljs-attr">uri:</span> <span class="hljs-string">lb://item-service</span><br>          <span class="hljs-attr">predicates:</span><br>            <span class="hljs-bullet">-</span> <span class="hljs-string">Path=/items/**,/search/**</span><br></code></pre></td></tr></table></figure>

<p>Âõõ‰∏™Â±ûÊÄßÂê´‰πâÂ¶Ç‰∏ãÔºö</p>
<ul>
<li>idÔºöË∑ØÁî±ÁöÑÂîØ‰∏ÄÊ†áÁ§∫</li>
<li>predicatesÔºöË∑ØÁî±Êñ≠Ë®ÄÔºåÂÖ∂ÂÆûÂ∞±ÊòØ<strong>ÂåπÈÖçÊù°‰ª∂</strong></li>
<li>filtersÔºö<strong>Ë∑ØÁî±ËøáÊª§</strong>Êù°‰ª∂</li>
<li>uriÔºö<strong>Ë∑ØÁî±ÁõÆÊ†áÂú∞ÂùÄ</strong>Ôºålb:&#x2F;&#x2F;‰ª£Ë°®Ë¥üËΩΩÂùáË°°Ôºå‰ªéÊ≥®ÂÜå‰∏≠ÂøÉËé∑ÂèñÁõÆÊ†áÂæÆÊúçÂä°ÁöÑÂÆû‰æãÂàóË°®ÔºåÂπ∂‰∏îË¥üËΩΩÂùáË°°ÈÄâÊã©‰∏Ä‰∏™ËÆøÈóÆ„ÄÇ</li>
</ul>
<ul>
<li>predicatesÔºåË∑ØÁî±Êñ≠Ë®ÄÁöÑÁ±ªÂûã:</li>
</ul>
<table>
<thead>
<tr>
<th>ÂêçÁß∞</th>
<th>ËØ¥Êòé</th>
</tr>
</thead>
<tbody><tr>
<td>After</td>
<td>ÊòØÊüê‰∏™Êó∂Èó¥ÁÇπÂêéÁöÑËØ∑Ê±Ç</td>
</tr>
<tr>
<td>Before</td>
<td>ÊòØÊüê‰∏™Êó∂Èó¥ÁÇπ‰πãÂâçÁöÑËØ∑Ê±Ç</td>
</tr>
<tr>
<td>Between</td>
<td>ÊòØÊüê‰∏§‰∏™Êó∂Èó¥ÁÇπ‰πãÂâçÁöÑËØ∑Ê±Ç</td>
</tr>
<tr>
<td>Cookie</td>
<td>ËØ∑Ê±ÇÂøÖÈ°ªÂåÖÂê´Êüê‰∫õ cookie</td>
</tr>
<tr>
<td>Header</td>
<td>ËØ∑Ê±ÇÂøÖÈ°ªÂåÖÂê´Êüê‰∫õ header</td>
</tr>
<tr>
<td>Host</td>
<td>ËØ∑Ê±ÇÂøÖÈ°ªÊòØËÆøÈóÆÊüê‰∏™ hostÔºàÂüüÂêçÔºâ</td>
</tr>
<tr>
<td>Method</td>
<td>ËØ∑Ê±ÇÊñπÂºèÂøÖÈ°ªÊòØÊåáÂÆöÊñπÂºè</td>
</tr>
<tr>
<td>Path</td>
<td>ËØ∑Ê±ÇË∑ØÂæÑÂøÖÈ°ªÁ¨¶ÂêàÊåáÂÆöËßÑÂàô</td>
</tr>
<tr>
<td>Query</td>
<td>ËØ∑Ê±ÇÂèÇÊï∞ÂøÖÈ°ªÂåÖÂê´ÊåáÂÆöÂèÇÊï∞</td>
</tr>
<tr>
<td>RemoteAddr</td>
<td>ËØ∑Ê±ÇËÄÖÁöÑ IP ÂøÖÈ°ªÊòØÊåáÂÆöËåÉÂõ¥</td>
</tr>
<tr>
<td>weight</td>
<td>ÊùÉÈáçÂ§ÑÁêÜ</td>
</tr>
</tbody></table>
<h3 id="4-4-ÁΩëÂÖ≥ÁôªÂΩïÊ†°È™å"><a href="#4-4-ÁΩëÂÖ≥ÁôªÂΩïÊ†°È™å" class="headerlink" title="4.4 ÁΩëÂÖ≥ÁôªÂΩïÊ†°È™å"></a>4.4 ÁΩëÂÖ≥ÁôªÂΩïÊ†°È™å</h3><p>Êó¢ÁÑ∂ÁΩëÂÖ≥ÊòØÊâÄÊúâÂæÆÊúçÂä°ÁöÑÂÖ•Âè£Ôºå‰∏ÄÂàáËØ∑Ê±ÇÈÉΩÈúÄË¶ÅÂÖàÁªèËøáÁΩëÂÖ≥„ÄÇÊàë‰ª¨ÂÆåÂÖ®<strong>ÂèØ‰ª•ÊääÁôªÂΩïÊ†°È™åÁöÑÂ∑•‰ΩúÊîæÂà∞ÁΩëÂÖ≥ÂéªÂÅö</strong>ÔºåËøôÊ†∑‰πãÂâçËØ¥ÁöÑÈóÆÈ¢òÂ∞±Ëß£ÂÜ≥‰∫ÜÔºö</p>
<ul>
<li>Âè™ÈúÄË¶Å<strong>Âú®ÁΩëÂÖ≥ÂíåÁî®Êà∑ÊúçÂä°‰øùÂ≠òÁßòÈí•</strong></li>
<li>Âè™ÈúÄË¶Å<strong>Âú®ÁΩëÂÖ≥ÂºÄÂèëÁôªÂΩïÊ†°È™åÂäüËÉΩ</strong></li>
</ul>
<p><img src="/img/blogs/java/springcloud/4.4.1.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="4-4-1-ÁΩëÂÖ≥ËøáÊª§Âô®"><a href="#4-4-1-ÁΩëÂÖ≥ËøáÊª§Âô®" class="headerlink" title="4.4.1 ÁΩëÂÖ≥ËøáÊª§Âô®"></a>4.4.1 ÁΩëÂÖ≥ËøáÊª§Âô®</h4><p><img src="/img/blogs/java/springcloud/4.4.2.png" srcset="/img/loading.gif" lazyload></p>
<ol>
<li>ÂÆ¢Êà∑Á´ØËØ∑Ê±ÇËøõÂÖ•ÁΩëÂÖ≥ÂêéÁî±HandlerMappingÂØπËØ∑Ê±ÇÂÅöÂà§Êñ≠ÔºåÊâæÂà∞‰∏éÂΩìÂâçËØ∑Ê±ÇÂåπÈÖçÁöÑË∑ØÁî±ËßÑÂàôÔºàRouteÔºâÔºåÁÑ∂ÂêéÂ∞ÜËØ∑Ê±Ç‰∫§ÁªôWebHandlerÂéªÂ§ÑÁêÜ„ÄÇ</li>
<li>WebHandlerÂàô‰ºöÂä†ËΩΩÂΩìÂâçË∑ØÁî±‰∏ãÈúÄË¶ÅÊâßË°åÁöÑËøáÊª§Âô®ÈìæÔºàFilter chainÔºâÔºåÁÑ∂ÂêéÊåâÁÖßÈ°∫Â∫èÈÄê‰∏ÄÊâßË°åËøáÊª§Âô®ÔºàÂêéÈù¢Áß∞‰∏∫FilterÔºâ„ÄÇ</li>
<li>Âõæ‰∏≠FilterË¢´ËôöÁ∫øÂàÜ‰∏∫Â∑¶Âè≥‰∏§ÈÉ®ÂàÜÔºåÊòØÂõ†‰∏∫FilterÂÜÖÈÉ®ÁöÑÈÄªËæëÂàÜ‰∏∫preÂíåpost‰∏§ÈÉ®ÂàÜÔºåÂàÜÂà´‰ºöÂú®ËØ∑Ê±ÇË∑ØÁî±Âà∞ÂæÆÊúçÂä°‰πãÂâçÂíå‰πãÂêéË¢´ÊâßË°å„ÄÇ</li>
<li>Âè™ÊúâÊâÄÊúâFilterÁöÑpreÈÄªËæëÈÉΩ‰æùÊ¨°È°∫Â∫èÊâßË°åÈÄöËøáÂêéÔºåËØ∑Ê±ÇÊâç‰ºöË¢´Ë∑ØÁî±Âà∞ÂæÆÊúçÂä°„ÄÇ</li>
<li>ÂæÆÊúçÂä°ËøîÂõûÁªìÊûúÂêéÔºåÂÜçÂÄíÂ∫èÊâßË°åFilterÁöÑpostÈÄªËæë„ÄÇ</li>
<li>ÊúÄÁªàÊääÂìçÂ∫îÁªìÊûúËøîÂõû</li>
</ol>
<p>ÁΩëÂÖ≥ËøáÊª§Âô®Èìæ‰∏≠ÁöÑËøáÊª§Âô®Êúâ‰∏§ÁßçÔºö</p>
<ul>
<li><strong>GatewayFilter</strong>Ôºö<strong>Ë∑ØÁî±ËøáÊª§Âô®</strong>Ôºå‰ΩúÁî®ËåÉÂõ¥ÊØîËæÉÁÅµÊ¥ªÔºåÂèØ‰ª•ÊòØ‰ªªÊÑèÊåáÂÆöÁöÑË∑ØÁî±Route. </li>
<li><strong>GlobalFilter</strong>Ôºö<strong>ÂÖ®Â±ÄËøáÊª§Âô®</strong>Ôºå‰ΩúÁî®ËåÉÂõ¥ÊòØÊâÄÊúâË∑ØÁî±Ôºå‰∏çÂèØÈÖçÁΩÆ„ÄÇ</li>
</ul>
<h4 id="4-4-2-Ëá™ÂÆö‰πâËøáÊª§Âô®"><a href="#4-4-2-Ëá™ÂÆö‰πâËøáÊª§Âô®" class="headerlink" title="4.4.2 Ëá™ÂÆö‰πâËøáÊª§Âô®"></a>4.4.2 Ëá™ÂÆö‰πâËøáÊª§Âô®</h4><p>Ëá™ÂÆö‰πâGlobalFilterÂàôÁÆÄÂçïÂæàÂ§öÔºåÁõ¥Êé•ÂÆûÁé∞GlobalFilterÂç≥ÂèØÔºåËÄå‰∏î‰πüÊó†Ê≥ïËÆæÁΩÆÂä®ÊÄÅÂèÇÊï∞Ôºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PrintAnyGlobalFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">GlobalFilter</span>, Ordered &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Mono&lt;Void&gt; <span class="hljs-title function_">filter</span><span class="hljs-params">(ServerWebExchange exchange, GatewayFilterChain chain)</span> &#123;<br>        <span class="hljs-comment">// ÁºñÂÜôËøáÊª§Âô®ÈÄªËæë</span><br>        System.out.println(<span class="hljs-string">&quot;Êú™ÁôªÂΩïÔºåÊó†Ê≥ïËÆøÈóÆ&quot;</span>);<br>        <span class="hljs-comment">// ÊîæË°å</span><br>        <span class="hljs-comment">// return chain.filter(exchange);</span><br><br>        <span class="hljs-comment">// Êã¶Êà™</span><br>        <span class="hljs-type">ServerHttpResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> exchange.getResponse();<br>        response.setRawStatusCode(<span class="hljs-number">401</span>);<br>        <span class="hljs-keyword">return</span> response.setComplete();<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getOrder</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// ËøáÊª§Âô®ÊâßË°åÈ°∫Â∫èÔºåÂÄºË∂äÂ∞èÔºå‰ºòÂÖàÁ∫ßË∂äÈ´ò</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="4-4-3-ÂæÆÊúçÂä°Ëé∑ÂèñÁî®Êà∑"><a href="#4-4-3-ÂæÆÊúçÂä°Ëé∑ÂèñÁî®Êà∑" class="headerlink" title="4.4.3 ÂæÆÊúçÂä°Ëé∑ÂèñÁî®Êà∑"></a>4.4.3 ÂæÆÊúçÂä°Ëé∑ÂèñÁî®Êà∑</h4><p>Áî±‰∫éÁΩëÂÖ≥ÂèëÈÄÅËØ∑Ê±ÇÂà∞ÂæÆÊúçÂä°‰æùÁÑ∂ÈááÁî®ÁöÑÊòØHttpËØ∑Ê±ÇÔºåÂõ†Ê≠§Êàë‰ª¨ÂèØ‰ª•Â∞ÜÁî®Êà∑‰ø°ÊÅØ‰ª•ËØ∑Ê±ÇÂ§¥ÁöÑÊñπÂºè‰º†ÈÄíÂà∞‰∏ãÊ∏∏ÂæÆÊúçÂä°„ÄÇÁÑ∂ÂêéÂæÆÊúçÂä°ÂèØ‰ª•<strong>‰ªéËØ∑Ê±ÇÂ§¥‰∏≠Ëé∑ÂèñÁôªÂΩïÁî®Êà∑‰ø°ÊÅØ</strong>„ÄÇËÄÉËôëÂà∞ÂæÆÊúçÂä°ÂÜÖÈÉ®ÂèØËÉΩÂæàÂ§öÂú∞ÊñπÈÉΩÈúÄË¶ÅÁî®Âà∞ÁôªÂΩïÁî®Êà∑‰ø°ÊÅØÔºåÂõ†Ê≠§Êàë‰ª¨ÂèØ‰ª•Âà©Áî®SpringMVCÁöÑÊã¶Êà™Âô®Êù•ÂÆûÁé∞ÁôªÂΩïÁî®Êà∑‰ø°ÊÅØËé∑ÂèñÔºåÂπ∂Â≠òÂÖ•ThreadLocalÔºåÊñπ‰æøÂêéÁª≠‰ΩøÁî®„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/4.4.3.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>ÊîπÈÄ†ÁΩëÂÖ≥ËøáÊª§Âô®ÔºåÂú®Ëé∑ÂèñÁî®Êà∑‰ø°ÊÅØÂêé‰øùÂ≠òÂà∞ËØ∑Ê±ÇÂ§¥ÔºåËΩ¨ÂèëÂà∞‰∏ãÊ∏∏ÂæÆÊúçÂä°</li>
<li>ÁºñÂÜôÂæÆÊúçÂä°Êã¶Êà™Âô®ÔºåÊã¶Êà™ËØ∑Ê±ÇËé∑ÂèñÁî®Êà∑‰ø°ÊÅØÔºå‰øùÂ≠òÂà∞ThreadLocalÂêéÊîæË°å</li>
</ul>
<h4 id="4-4-4-OpenFeign‰º†ÈÄíÁî®Êà∑"><a href="#4-4-4-OpenFeign‰º†ÈÄíÁî®Êà∑" class="headerlink" title="4.4.4 OpenFeign‰º†ÈÄíÁî®Êà∑"></a>4.4.4 OpenFeign‰º†ÈÄíÁî®Êà∑</h4><p>ÂâçÁ´ØÂèëËµ∑ÁöÑËØ∑Ê±ÇÈÉΩ‰ºöÁªèËøáÁΩëÂÖ≥ÂÜçÂà∞ÂæÆÊúçÂä°ÔºåÁî±‰∫éÊàë‰ª¨‰πãÂâçÁºñÂÜôÁöÑËøáÊª§Âô®ÂíåÊã¶Êà™Âô®ÂäüËÉΩÔºåÂæÆÊúçÂä°ÂèØ‰ª•ËΩªÊùæËé∑ÂèñÁôªÂΩïÁî®Êà∑‰ø°ÊÅØ„ÄÇ</p>
<p>Áî±‰∫éÂæÆÊúçÂä°Ëé∑ÂèñÁî®Êà∑‰ø°ÊÅØÊòØÈÄöËøáÊã¶Êà™Âô®Âú®ËØ∑Ê±ÇÂ§¥‰∏≠ËØªÂèñÔºåÂõ†Ê≠§Ë¶ÅÊÉ≥ÂÆûÁé∞ÂæÆÊúçÂä°‰πãÈó¥ÁöÑÁî®Êà∑‰ø°ÊÅØ‰º†ÈÄíÔºåÂ∞±ÂøÖÈ°ªÂú®ÂæÆÊúçÂä°ÂèëËµ∑Ë∞ÉÁî®Êó∂ÊääÁî®Êà∑‰ø°ÊÅØÂ≠òÂÖ•ËØ∑Ê±ÇÂ§¥„ÄÇ</p>
<p>ÂæÆÊúçÂä°‰πãÈó¥Ë∞ÉÁî®ÊòØÂü∫‰∫éOpenFeignÊù•ÂÆûÁé∞ÁöÑÔºåÂπ∂‰∏çÊòØÊàë‰ª¨Ëá™Â∑±ÂèëÈÄÅÁöÑËØ∑Ê±Ç„ÄÇÊàë‰ª¨Â¶Ç‰ΩïÊâçËÉΩËÆ©ÊØè‰∏Ä‰∏™Áî±OpenFeignÂèëËµ∑ÁöÑËØ∑Ê±ÇËá™Âä®Êê∫Â∏¶ÁôªÂΩïÁî®Êà∑‰ø°ÊÅØÂë¢Ôºü<br>ËøôÈáåË¶ÅÂÄüÂä©Feign‰∏≠Êèê‰æõÁöÑ‰∏Ä‰∏™Êã¶Êà™Âô®Êé•Âè£Ôºöfeign.RequestInterceptor</p>
<h2 id="5-ÈÖçÁΩÆÁÆ°ÁêÜ"><a href="#5-ÈÖçÁΩÆÁÆ°ÁêÜ" class="headerlink" title="5. ÈÖçÁΩÆÁÆ°ÁêÜ"></a>5. ÈÖçÁΩÆÁÆ°ÁêÜ</h2><p>Nacos‰∏ç‰ªÖ‰ªÖÂÖ∑Â§áÊ≥®ÂÜå‰∏≠ÂøÉÂäüËÉΩÔºå‰πüÂÖ∑Â§áÈÖçÁΩÆÁÆ°ÁêÜÁöÑÂäüËÉΩ</p>
<p><img src="/img/blogs/java/springcloud/4.5.1.png" srcset="/img/loading.gif" lazyload></p>
<p><strong>ÂæÆÊúçÂä°ÂÖ±‰∫´ÁöÑÈÖçÁΩÆÂèØ‰ª•Áªü‰∏Ä‰∫§ÁªôNacos‰øùÂ≠òÂíåÁÆ°ÁêÜ</strong>ÔºåÂú®NacosÊéßÂà∂Âè∞‰øÆÊîπÈÖçÁΩÆÂêéÔºåNacos‰ºöÂ∞ÜÈÖçÁΩÆÂèòÊõ¥Êé®ÈÄÅÁªôÁõ∏ÂÖ≥ÁöÑÂæÆÊúçÂä°ÔºåÂπ∂‰∏î<strong>Êó†ÈúÄÈáçÂêØÂç≥ÂèØÁîüÊïà</strong>ÔºåÂÆûÁé∞<strong>ÈÖçÁΩÆÁÉ≠Êõ¥Êñ∞</strong>„ÄÇ<br>ÁΩëÂÖ≥ÁöÑË∑ØÁî±ÂêåÊ†∑ÊòØÈÖçÁΩÆÔºåÂõ†Ê≠§ÂêåÊ†∑ÂèØ‰ª•Âü∫‰∫éËøô‰∏™ÂäüËÉΩÂÆûÁé∞Âä®ÊÄÅË∑ØÁî±ÂäüËÉΩÔºåÊó†ÈúÄÈáçÂêØÁΩëÂÖ≥Âç≥ÂèØ‰øÆÊîπË∑ØÁî±ÈÖçÁΩÆ„ÄÇ</p>
<h3 id="5-1-ÈÖçÁΩÆÂÖ±‰∫´"><a href="#5-1-ÈÖçÁΩÆÂÖ±‰∫´" class="headerlink" title="5.1 ÈÖçÁΩÆÂÖ±‰∫´"></a>5.1 ÈÖçÁΩÆÂÖ±‰∫´</h3><p>ÊääÂæÆÊúçÂä°ÂÖ±‰∫´ÁöÑÈÖçÁΩÆÊäΩÂèñÂà∞Nacos‰∏≠Áªü‰∏ÄÁÆ°ÁêÜÔºåËøôÊ†∑Â∞±‰∏çÈúÄË¶ÅÊØè‰∏™ÂæÆÊúçÂä°ÈÉΩÈáçÂ§çÈÖçÁΩÆ‰∫Ü„ÄÇÂàÜ‰∏∫‰∏§Ê≠•Ôºö</p>
<ul>
<li><strong>Âú®Nacos‰∏≠Ê∑ªÂä†ÂÖ±‰∫´ÈÖçÁΩÆ</strong></li>
<li><strong>ÂæÆÊúçÂä°ÊãâÂèñÈÖçÁΩÆ</strong></li>
</ul>
<p>SpringCloudÂú®ÂàùÂßãÂåñ‰∏ä‰∏ãÊñáÁöÑÊó∂ÂÄô‰ºöÂÖàËØªÂèñ‰∏Ä‰∏™Âêç‰∏∫bootstrap.yaml(ÊàñËÄÖbootstrap.properties)ÁöÑÊñá‰ª∂ÔºåÂ¶ÇÊûúÊàë‰ª¨Â∞ÜnacosÂú∞ÂùÄÈÖçÁΩÆÂà∞bootstrap.yaml‰∏≠ÔºåÈÇ£‰πàÂú®È°πÁõÆÂºïÂØºÈò∂ÊÆµÂ∞±ÂèØ‰ª•ËØªÂèñnacos‰∏≠ÁöÑÈÖçÁΩÆ‰∫Ü„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/4.5.2.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="5-2-Âä®ÊÄÅË∑ØÁî±"><a href="#5-2-Âä®ÊÄÅË∑ØÁî±" class="headerlink" title="5.2 Âä®ÊÄÅË∑ØÁî±"></a>5.2 Âä®ÊÄÅË∑ØÁî±</h3><p>Â¶ÇÊûúÂ∏åÊúõ Nacos Êé®ÈÄÅÈÖçÁΩÆÂèòÊõ¥ÔºåÂèØ‰ª•‰ΩøÁî® Nacos Âä®ÊÄÅÁõëÂê¨ÈÖçÁΩÆÊé•Âè£Êù•ÂÆûÁé∞„ÄÇ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">addListener</span><span class="hljs-params">(String dataId, String group, Listener listener)</span><br></code></pre></td></tr></table></figure>
<p>Á§∫‰æã:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">serverAddr</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;serverAddr&#125;&quot;</span>;<br><span class="hljs-type">String</span> <span class="hljs-variable">dataId</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;dataId&#125;&quot;</span>;<br><span class="hljs-type">String</span> <span class="hljs-variable">group</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;group&#125;&quot;</span>;<br><span class="hljs-comment">// 1.ÂàõÂª∫ConfigServiceÔºåËøûÊé•Nacos</span><br><span class="hljs-type">Properties</span> <span class="hljs-variable">properties</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();<br>properties.put(<span class="hljs-string">&quot;serverAddr&quot;</span>, serverAddr);<br><span class="hljs-type">ConfigService</span> <span class="hljs-variable">configService</span> <span class="hljs-operator">=</span> NacosFactory.createConfigService(properties);<br><span class="hljs-comment">// 2.ËØªÂèñÈÖçÁΩÆ</span><br><span class="hljs-type">String</span> <span class="hljs-variable">content</span> <span class="hljs-operator">=</span> configService.getConfig(dataId, group, <span class="hljs-number">5000</span>);<br><span class="hljs-comment">// 3.Ê∑ªÂä†ÈÖçÁΩÆÁõëÂê¨Âô®</span><br>configService.addListener(dataId, group, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Listener</span>() &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">receiveConfigInfo</span><span class="hljs-params">(String configInfo)</span> &#123;<br>        <span class="hljs-comment">// ÈÖçÁΩÆÂèòÊõ¥ÁöÑÈÄöÁü•Â§ÑÁêÜ</span><br>                System.out.println(<span class="hljs-string">&quot;recieve1:&quot;</span> + configInfo);<br>        &#125;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> Executor <span class="hljs-title function_">getExecutor</span><span class="hljs-params">()</span> &#123;<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>        &#125;<br>&#125;);<br></code></pre></td></tr></table></figure>
<p>Ê†∏ÂøÉÁöÑÊ≠•È™§Êúâ2Ê≠•Ôºö</p>
<ul>
<li>ÂàõÂª∫ConfigServiceÔºåÁõÆÁöÑÊòØËøûÊé•Âà∞Nacos</li>
<li>Ê∑ªÂä†ÈÖçÁΩÆÁõëÂê¨Âô®ÔºåÁºñÂÜôÈÖçÁΩÆÂèòÊõ¥ÁöÑÈÄöÁü•Â§ÑÁêÜÈÄªËæë</li>
</ul>
<h1 id="Âõõ-ÊúçÂä°‰øùÊä§ÂíåÂàÜÂ∏ÉÂºè‰∫ãÂä°"><a href="#Âõõ-ÊúçÂä°‰øùÊä§ÂíåÂàÜÂ∏ÉÂºè‰∫ãÂä°" class="headerlink" title="Âõõ. ÊúçÂä°‰øùÊä§ÂíåÂàÜÂ∏ÉÂºè‰∫ãÂä°"></a>Âõõ. ÊúçÂä°‰øùÊä§ÂíåÂàÜÂ∏ÉÂºè‰∫ãÂä°</h1><h2 id="1-Èõ™Â¥©ÈóÆÈ¢ò"><a href="#1-Èõ™Â¥©ÈóÆÈ¢ò" class="headerlink" title="1. Èõ™Â¥©ÈóÆÈ¢ò"></a>1. Èõ™Â¥©ÈóÆÈ¢ò</h2><p>Èõ™Â¥©ÈóÆÈ¢òÊåáÁöÑÊòØ<strong>Êüê‰∏™ÊúçÂä°‰∏çÂèØÁî®ÊàñÂìçÂ∫îÂèòÊÖ¢ÔºåÂØºËá¥‰æùËµñËØ•ÊúçÂä°ÁöÑÂÖ∂‰ªñÊúçÂä°‰πüÊó†Ê≥ïÊ≠£Â∏∏Â∑•‰ΩúÔºåËøõËÄåÂºïÂèëËøûÈîÅÂèçÂ∫îÔºåÊúÄÁªàÂØºËá¥Êï¥‰∏™Á≥ªÁªüÂ¥©Ê∫É</strong>„ÄÇËøôÁßçÁé∞Ë±°Á±ª‰ºº‰∫éÈõ™Â¥©ÔºåÁî±‰∏Ä‰∏™Â∞èÈóÆÈ¢òÈÄêÊ≠•Êâ©Êï£ÔºåÊúÄÁªàÂΩ±ÂìçÊï¥‰∏™Á≥ªÁªüÁöÑÁ®≥ÂÆöÊÄß„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/4.1.1.png" srcset="/img/loading.gif" lazyload></p>
<p>Èõ™Â¥©ÈóÆÈ¢ò‰∫ßÁîüÁöÑÂéüÂõ†Ôºö</p>
<ul>
<li>ÂæÆÊúçÂä°Áõ∏‰∫íË∞ÉÁî®,<strong>ÊúçÂä°Êèê‰æõËÄÖÂá∫Áé∞ÊïÖÈöúÊàñÈòªÂ°û</strong>„ÄÇ</li>
<li><strong>ÊúçÂä°Ë∞ÉÁî®ËÄÖ</strong>Ê≤°ÊúâÂÅöÂ•ΩÂºÇÂ∏∏Â§ÑÁêÜ,ÂØºËá¥<strong>Ëá™Ë∫´ÊïÖÈöú</strong>„ÄÇ</li>
<li>Ë∞ÉÁî®Èìæ‰∏≠ÁöÑÊâÄÊúâÊúçÂä°Á∫ßËÅîÂ§±Ë¥•,ÂØºËá¥Êï¥‰∏™ÈõÜÁæ§ÊïÖÈöú</li>
</ul>
<p>Ëß£ÂÜ≥ÈóÆÈ¢òÁöÑÊÄùË∑ØÔºö</p>
<ul>
<li>Â∞ΩÈáèÈÅøÂÖçÊúçÂä°Âá∫Áé∞ÊïÖÈöúÊàñÈòªÂ°û</li>
<li>‰øùËØÅ‰ª£Á†ÅÁöÑÂÅ•Â£ÆÊÄß</li>
<li>‰øùËØÅÁΩëÁªúÁïÖÈÄö</li>
<li>ËÉΩÂ∫îÂØπËæÉÈ´òÁöÑÂπ∂ÂèëËØ∑Ê±Ç</li>
</ul>
<h2 id="2-ÂæÆÊúçÂä°‰øùÊä§"><a href="#2-ÂæÆÊúçÂä°‰øùÊä§" class="headerlink" title="2. ÂæÆÊúçÂä°‰øùÊä§"></a>2. ÂæÆÊúçÂä°‰øùÊä§</h2><h3 id="2-1-ÂæÆÊúçÂä°‰øùÊä§ÊñπÊ°à"><a href="#2-1-ÂæÆÊúçÂä°‰øùÊä§ÊñπÊ°à" class="headerlink" title="2.1 ÂæÆÊúçÂä°‰øùÊä§ÊñπÊ°à"></a>2.1 ÂæÆÊúçÂä°‰øùÊä§ÊñπÊ°à</h3><ul>
<li><strong>ËØ∑Ê±ÇÈôêÊµÅ</strong></li>
<li><strong>Á∫øÁ®ãÈöîÁ¶ª</strong></li>
<li><strong>ÊúçÂä°ÁÜîÊñ≠</strong></li>
</ul>
<h4 id="2-1-1-ËØ∑Ê±ÇÈôêÊµÅ"><a href="#2-1-1-ËØ∑Ê±ÇÈôêÊµÅ" class="headerlink" title="2.1.1 ËØ∑Ê±ÇÈôêÊµÅ"></a>2.1.1 ËØ∑Ê±ÇÈôêÊµÅ</h4><p>ÊúçÂä°ÊïÖÈöúÊúÄÈáçË¶ÅÂéüÂõ†ÔºåÂ∞±ÊòØ<strong>Âπ∂ÂèëÂ§™È´òÔºÅÂõ†Ê≠§ËØ∑Ê±ÇÈôêÊµÅ</strong>ÔºåÂ∞±ÊòØ<strong>ÈôêÂà∂ÊàñÊéßÂà∂Êé•Âè£ËÆøÈóÆÁöÑÂπ∂ÂèëÊµÅÈáè</strong>ÔºåÈÅøÂÖçÊúçÂä°Âõ†ÊµÅÈáèÊøÄÂ¢ûËÄåÂá∫Áé∞ÊïÖÈöú„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/4.2.1.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="2-1-2-Á∫øÁ®ãÈöîÁ¶ª"><a href="#2-1-2-Á∫øÁ®ãÈöîÁ¶ª" class="headerlink" title="2.1.2 Á∫øÁ®ãÈöîÁ¶ª"></a>2.1.2 Á∫øÁ®ãÈöîÁ¶ª</h4><p>ÂΩì‰∏Ä‰∏™‰∏öÂä°Êé•Âè£ÂìçÂ∫îÊó∂Èó¥ÈïøÔºåËÄå‰∏îÂπ∂ÂèëÈ´òÊó∂ÔºåÂ∞±ÂèØËÉΩËÄóÂ∞ΩÊúçÂä°Âô®ÁöÑÁ∫øÁ®ãËµÑÊ∫êÔºåÂØºËá¥ÊúçÂä°ÂÜÖÁöÑÂÖ∂ÂÆÉÊé•Âè£ÂèóÂà∞ÂΩ±Âìç„ÄÇÊâÄ‰ª•Êàë‰ª¨ÂøÖÈ°ªÊääËøôÁßçÂΩ±ÂìçÈôç‰ΩéÔºåÊàñËÄÖÁº©ÂáèÂΩ±ÂìçÁöÑËåÉÂõ¥„ÄÇ<br>‰∏∫‰∫ÜÈÅøÂÖçÊüê‰∏™Êé•Âè£ÊïÖÈöúÊàñÂéãÂäõËøáÂ§ßÂØºËá¥Êï¥‰∏™ÊúçÂä°‰∏çÂèØÁî®ÔºåÊàë‰ª¨ÂèØ‰ª•<strong>ÈôêÂÆöÊØè‰∏™Êé•Âè£ÂèØ‰ª•‰ΩøÁî®ÁöÑËµÑÊ∫êËåÉÂõ¥</strong>Ôºå‰πüÂ∞±ÊòØÂ∞ÜÂÖ∂‚ÄúÈöîÁ¶ª‚ÄùËµ∑Êù•„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/4.2.2.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="2-1-3-ÊúçÂä°ÁÜîÊñ≠"><a href="#2-1-3-ÊúçÂä°ÁÜîÊñ≠" class="headerlink" title="2.1.3 ÊúçÂä°ÁÜîÊñ≠"></a>2.1.3 ÊúçÂä°ÁÜîÊñ≠</h4><p>ÁªüËÆ°ÊúçÂä°Êèê‰æõÊñπÁöÑ<strong>ÂºÇÂ∏∏ÊØî‰æãÔºåÂΩìÊØî‰æãËøáÈ´ò</strong>Ë°®ÊòéËØ•Êé•Âè£‰ºöÂΩ±ÂìçÂà∞ÂÖ∂ÂÆÉÊúçÂä°Ôºå<strong>Â∫îËØ•ÊãíÁªùË∞ÉÁî®ËØ•Êé•Âè£</strong>ÔºåËÄåÊòØÁõ¥Êé•Ëµ∞ÈôçÁ∫ßÈÄªËæë„ÄÇ<br>ÊúçÂä°Ë∞ÉÁî®Â§±Ë¥•ÂêéÁöÑÂ§ÑÁêÜÈÄªËæëÔºåÊ†πÊçÆ‰∏öÂä°Âú∫ÊôØÔºå<strong>ÂèØ‰ª•ÊäõÂá∫ÂºÇÂ∏∏Ôºå‰πüÂèØ‰ª•ËøîÂõûÂèãÂ•ΩÊèêÁ§∫ÊàñÈªòËÆ§Êï∞ÊçÆ</strong>„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/4.2.3.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="2-1-4-Ëß£ÂÜ≥Èõ™Â¥©ÈóÆÈ¢òÁöÑÂ∏∏ËßÅÊñπÊ°à"><a href="#2-1-4-Ëß£ÂÜ≥Èõ™Â¥©ÈóÆÈ¢òÁöÑÂ∏∏ËßÅÊñπÊ°à" class="headerlink" title="2.1.4 Ëß£ÂÜ≥Èõ™Â¥©ÈóÆÈ¢òÁöÑÂ∏∏ËßÅÊñπÊ°à"></a>2.1.4 Ëß£ÂÜ≥Èõ™Â¥©ÈóÆÈ¢òÁöÑÂ∏∏ËßÅÊñπÊ°à</h4><ul>
<li>ËØ∑Ê±ÇÈôêÊµÅ:<strong>ÈôêÂà∂ÊµÅÈáè</strong>Âú®ÊúçÂä°ÂèØ‰ª•Â§ÑÁêÜÁöÑËåÉÂõ¥,ÈÅøÂÖçÂõ†Á™ÅÂèëÊµÅÈáèËÄåÊïÖÈöú</li>
<li>Á∫øÁ®ãÈöîÁ¶ª:<strong>ÊéßÂà∂‰∏öÂä°ÂèØÁî®ÁöÑÁ∫øÁ®ãÊï∞Èáè</strong>,Â∞ÜÊïÖÈöúÈöîÁ¶ªÂú®‰∏ÄÂÆöËåÉÂõ¥</li>
<li>ÊúçÂä°ÁÜîÊñ≠:<strong>Â∞ÜÂºÇÂ∏∏ÊØî‰æãËøáÈ´òÁöÑÊé•Âè£Êñ≠ÂºÄ</strong>,ÊãíÁªùÊâÄÊúâËØ∑Ê±Ç,Áõ¥Êé•Ëµ∞fallback</li>
<li>Â§±Ë¥•Â§ÑÁêÜ:<strong>ÂÆö‰πâfallbackÈÄªËæë</strong>,ËÆ©‰∏öÂä°Â§±Ë¥•Êó∂‰∏çÂÜçÊäõÂá∫ÂºÇÂ∏∏,ËÄåÊòØ<strong>ËøîÂõûÈªòËÆ§Êï∞ÊçÆÊàñÂèãÂ•ΩÊèêÁ§∫</strong></li>
</ul>
<h3 id="2-2-Sentinel-ÂæÆÊúçÂä°‰øùÊä§ÊäÄÊúØ"><a href="#2-2-Sentinel-ÂæÆÊúçÂä°‰øùÊä§ÊäÄÊúØ" class="headerlink" title="2.2 Sentinel(ÂæÆÊúçÂä°‰øùÊä§ÊäÄÊúØ)"></a>2.2 Sentinel(ÂæÆÊúçÂä°‰øùÊä§ÊäÄÊúØ)</h3><h4 id="2-2-1-Sentinel‰∏ãËΩΩÂÆâË£ÖÂíåËøêË°å"><a href="#2-2-1-Sentinel‰∏ãËΩΩÂÆâË£ÖÂíåËøêË°å" class="headerlink" title="2.2.1 Sentinel‰∏ãËΩΩÂÆâË£ÖÂíåËøêË°å"></a>2.2.1 Sentinel‰∏ãËΩΩÂÆâË£ÖÂíåËøêË°å</h4><p><a target="_blank" rel="noopener" href="https://sentinelguard.io/zh-cn/">sentinelÂÆòÁΩë</a></p>
<p>Âú®ÁõÆÂΩïÊñá‰ª∂Â§π‰∏≠cmdÊâìÂºÄÊéßÂà∂Âè∞ËøêË°åÔºö</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">java -Dserver.port=8090 -Dcsp.sentinel.dashboard.server=localhost:8090 -Dproject.name=sentinel-dashboard -jar sentinel-dashboard.jar<br></code></pre></td></tr></table></figure>

<p>ËÆøÈóÆ<code>http://localhost:8090</code>È°µÈù¢ÔºåÂ∞±ÂèØ‰ª•ÁúãÂà∞sentinelÁöÑÊéßÂà∂Âè∞‰∫Ü</p>
<h4 id="2-2-2-ËØ∑Ê±ÇÈôêÊµÅ"><a href="#2-2-2-ËØ∑Ê±ÇÈôêÊµÅ" class="headerlink" title="2.2.2 ËØ∑Ê±ÇÈôêÊµÅ"></a>2.2.2 ËØ∑Ê±ÇÈôêÊµÅ</h4><p>Âú®sentinelÈÖçÁΩÆÔºö</p>
<p><img src="/img/blogs/java/springcloud/4.2.4.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="2-2-3-Á∫øÁ®ãÈöîÁ¶ª"><a href="#2-2-3-Á∫øÁ®ãÈöîÁ¶ª" class="headerlink" title="2.2.3 Á∫øÁ®ãÈöîÁ¶ª"></a>2.2.3 Á∫øÁ®ãÈöîÁ¶ª</h4><p><strong>‰øÆÊîπtomcatËøûÊé•</strong>Ôºö</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8082</span><br>  <span class="hljs-attr">tomcat:</span><br>    <span class="hljs-attr">threads:</span><br>      <span class="hljs-attr">max:</span> <span class="hljs-number">50</span> <span class="hljs-comment"># ÂÖÅËÆ∏ÁöÑÊúÄÂ§ßÁ∫øÁ®ãÊï∞</span><br>    <span class="hljs-attr">accept-count:</span> <span class="hljs-number">50</span> <span class="hljs-comment"># ÊúÄÂ§ßÊéíÈòüÁ≠âÂæÖÊï∞Èáè</span><br>    <span class="hljs-attr">max-connections:</span> <span class="hljs-number">100</span> <span class="hljs-comment"># ÂÖÅËÆ∏ÁöÑÊúÄÂ§ßËøûÊé•</span><br></code></pre></td></tr></table></figure>

<p><img src="/img/blogs/java/springcloud/4.2.5.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="2-2-4-ÊúçÂä°ÁÜîÊñ≠"><a href="#2-2-4-ÊúçÂä°ÁÜîÊñ≠" class="headerlink" title="2.2.4 ÊúçÂä°ÁÜîÊñ≠"></a>2.2.4 ÊúçÂä°ÁÜîÊñ≠</h4><h5 id="2-2-4-1-Fallback"><a href="#2-2-4-1-Fallback" class="headerlink" title="2.2.4.1 Fallback"></a>2.2.4.1 Fallback</h5><p>Ë∂ÖÂá∫ÁöÑQPS‰∏äÈôêÁöÑËØ∑Ê±ÇÂ∞±Âè™ËÉΩÊäõÂá∫ÂºÇÂ∏∏Ôºå‰ªéËÄåÂØºËá¥Ë¥≠Áâ©ËΩ¶ÁöÑÊü•ËØ¢Â§±Ë¥•„ÄÇ‰ΩÜ‰ªé‰∏öÂä°ËßíÂ∫¶Êù•ËØ¥ÔºåÂç≥‰æøÊ≤°ÊúâÊü•ËØ¢Âà∞ÊúÄÊñ∞ÁöÑÂïÜÂìÅ‰ø°ÊÅØÔºåË¥≠Áâ©ËΩ¶‰πüÂ∫îËØ•Â±ïÁ§∫ÁªôÁî®Êà∑ÔºåÁî®Êà∑‰ΩìÈ™åÊõ¥Â•Ω„ÄÇ‰πüÂ∞±ÊòØÁªôÊü•ËØ¢Â§±Ë¥•ËÆæÁΩÆ‰∏Ä‰∏™ÈôçÁ∫ßÂ§ÑÁêÜÈÄªËæë„ÄÇ<br>Ëß¶ÂèëÈôêÊµÅÊàñÁÜîÊñ≠ÂêéÁöÑËØ∑Ê±Ç<strong>‰∏ç‰∏ÄÂÆöË¶ÅÁõ¥Êé•Êä•ÈîôÔºå‰πüÂèØ‰ª•ËøîÂõû‰∏Ä‰∫õÈªòËÆ§Êï∞ÊçÆÊàñËÄÖÂèãÂ•ΩÊèêÁ§∫</strong>ÔºåÁî®Êà∑‰ΩìÈ™å‰ºöÊõ¥Â•Ω„ÄÇ</p>
<ul>
<li>ÂÆö‰πâÈôçÁ∫ßÂ§ÑÁêÜÁ±ªÔºåÂÆûÁé∞FallbackFactory:</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Slf4j</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ItemClientFallback</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">FallbackFactory</span>&lt;ItemClient&gt; &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> ItemClient <span class="hljs-title function_">create</span><span class="hljs-params">(Throwable cause)</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ItemClient</span>() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> List&lt;ItemDTO&gt; <span class="hljs-title function_">queryItemByIds</span><span class="hljs-params">(Collection&lt;Long&gt; ids)</span> &#123;<br>                log.error(<span class="hljs-string">&quot;ËøúÁ®ãË∞ÉÁî®ItemClient#queryItemByIdsÊñπÊ≥ïÂá∫Áé∞ÂºÇÂ∏∏ÔºåÂèÇÊï∞Ôºö&#123;&#125;&quot;</span>, ids, cause);<br>                <span class="hljs-comment">// Êü•ËØ¢Ë¥≠Áâ©ËΩ¶ÂÖÅËÆ∏Â§±Ë¥•ÔºåÊü•ËØ¢Â§±Ë¥•ÔºåËøîÂõûÁ©∫ÈõÜÂêà</span><br>                <span class="hljs-keyword">return</span> CollUtils.emptyList();<br>            &#125;<br><br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">deductStock</span><span class="hljs-params">(List&lt;OrderDetailDTO&gt; items)</span> &#123;<br>                <span class="hljs-comment">// Â∫ìÂ≠òÊâ£Âáè‰∏öÂä°ÈúÄË¶ÅËß¶Âèë‰∫ãÂä°ÂõûÊªöÔºåÊü•ËØ¢Â§±Ë¥•ÔºåÊäõÂá∫ÂºÇÂ∏∏</span><br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BizIllegalException</span>(cause);<br>            &#125;<br>        &#125;;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="2-2-4-2-ÊúçÂä°ÁÜîÊñ≠"><a href="#2-2-4-2-ÊúçÂä°ÁÜîÊñ≠" class="headerlink" title="2.2.4.2 ÊúçÂä°ÁÜîÊñ≠"></a>2.2.4.2 ÊúçÂä°ÁÜîÊñ≠</h5><p>Sentinel‰∏≠ÁöÑÊñ≠Ë∑ØÂô®‰∏ç‰ªÖÂèØ‰ª•ÁªüËÆ°Êüê‰∏™Êé•Âè£ÁöÑ<strong>ÊÖ¢ËØ∑Ê±ÇÊØî‰æã</strong>ÔºåËøòÂèØ‰ª•ÁªüËÆ°<strong>ÂºÇÂ∏∏ËØ∑Ê±ÇÊØî‰æã</strong>„ÄÇÂΩìËøô‰∫õÊØî‰æãË∂ÖÂá∫ÈòàÂÄºÊó∂ÔºåÂ∞±‰ºöÁÜîÊñ≠ËØ•Êé•Âè£ÔºåÂç≥<strong>Êã¶Êà™ËÆøÈóÆËØ•Êé•Âè£ÁöÑ‰∏ÄÂàáËØ∑Ê±Ç</strong>ÔºåÈôçÁ∫ßÂ§ÑÁêÜÔºõÂΩìËØ•Êé•Âè£<strong>ÊÅ¢Â§çÊ≠£Â∏∏Êó∂ÔºåÂÜçÊîæË°å</strong>ÂØπ‰∫éËØ•Êé•Âè£ÁöÑËØ∑Ê±Ç„ÄÇ<br>Êñ≠Ë∑ØÂô®ÁöÑÂ∑•‰ΩúÁä∂ÊÄÅÂàáÊç¢Êúâ‰∏Ä‰∏™Áä∂ÊÄÅÊú∫Êù•ÊéßÂà∂Ôºö</p>
<p><img src="/img/blogs/java/springcloud/4.2.6.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>closedÔºö<strong>ÂÖ≥Èó≠Áä∂ÊÄÅÔºåÊñ≠Ë∑ØÂô®ÊîæË°åÊâÄÊúâËØ∑Ê±Ç</strong>ÔºåÂπ∂ÂºÄÂßãÁªüËÆ°ÂºÇÂ∏∏ÊØî‰æã„ÄÅÊÖ¢ËØ∑Ê±ÇÊØî‰æã„ÄÇË∂ÖËøáÈòàÂÄºÂàôÂàáÊç¢Âà∞openÁä∂ÊÄÅ</li>
<li>openÔºö<strong>ÊâìÂºÄÁä∂ÊÄÅÔºåÊúçÂä°Ë∞ÉÁî®Ë¢´ÁÜîÊñ≠</strong>ÔºåËÆøÈóÆË¢´ÁÜîÊñ≠ÊúçÂä°ÁöÑËØ∑Ê±Ç‰ºöË¢´ÊãíÁªùÔºåÂø´ÈÄüÂ§±Ë¥•ÔºåÁõ¥Êé•Ëµ∞ÈôçÁ∫ßÈÄªËæë„ÄÇOpenÁä∂ÊÄÅÊåÅÁª≠‰∏ÄÊÆµÊó∂Èó¥Âêé‰ºöËøõÂÖ•half-openÁä∂ÊÄÅ</li>
<li>half-openÔºö<strong>ÂçäÂºÄÁä∂ÊÄÅÔºåÊîæË°å‰∏ÄÊ¨°ËØ∑Ê±Ç</strong>ÔºåÊ†πÊçÆÊâßË°åÁªìÊûúÊù•Âà§Êñ≠Êé•‰∏ãÊù•ÁöÑÊìç‰Ωú„ÄÇ <ul>
<li>ËØ∑Ê±ÇÊàêÂäüÔºöÂàôÂàáÊç¢Âà∞closedÁä∂ÊÄÅ</li>
<li>ËØ∑Ê±ÇÂ§±Ë¥•ÔºöÂàôÂàáÊç¢Âà∞openÁä∂ÊÄÅ</li>
</ul>
</li>
</ul>
<p><img src="/img/blogs/java/springcloud/4.2.7.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="3-ÂàÜÂ∏ÉÂºè‰∫ãÂä°"><a href="#3-ÂàÜÂ∏ÉÂºè‰∫ãÂä°" class="headerlink" title="3. ÂàÜÂ∏ÉÂºè‰∫ãÂä°"></a>3. ÂàÜÂ∏ÉÂºè‰∫ãÂä°</h2><p><strong>ÊØè‰∏™ÂæÆÊúçÂä°ÁöÑÊú¨Âú∞‰∫ãÂä°Ôºå‰πüÂèØ‰ª•Áß∞‰∏∫ÂàÜÊîØ‰∫ãÂä°</strong>„ÄÇ<strong>Â§ö‰∏™ÊúâÂÖ≥ËÅîÁöÑÂàÜÊîØ‰∫ãÂä°‰∏ÄËµ∑Â∞±ÁªÑÊàê‰∫ÜÂÖ®Â±Ä‰∫ãÂä°</strong>„ÄÇÊàë‰ª¨ÂøÖÈ°ª‰øùËØÅÊï¥‰∏™ÂÖ®Â±Ä‰∫ãÂä°ÂêåÊó∂ÊàêÂäüÊàñÂ§±Ë¥•„ÄÇÊª°Ë∂≥ACIDÁâπÊÄß„ÄÇ</p>
<h3 id="3-1-Seata"><a href="#3-1-Seata" class="headerlink" title="3.1 Seata"></a>3.1 Seata</h3><p>SeataÊòØÈòøÈáåÂ∑¥Â∑¥ÁöÑÂºÄÊ∫êÂàÜÂ∏ÉÂºè‰∫ãÂä°Ê°ÜÊû∂<br>Ëß£ÂÜ≥ÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁöÑÊñπÊ≥ïÊòØ<strong>Êâæ‰∏Ä‰∏™Áªü‰∏ÄÁöÑ‰∫ãÂä°ÂçèË∞ÉËÄÖÔºå‰∏éÂ§ö‰∏™ÂàÜÊîØ‰∫ãÂä°ÈÄö‰ø°ÔºåÊ£ÄÊµãÊØè‰∏™ÂàÜÊîØ‰∫ãÂä°ÁöÑÊâßË°åÁä∂ÊÄÅ</strong>Ôºå<strong>‰øùËØÅÂÖ®Â±Ä‰∫ãÂä°‰∏ãÁöÑÊØè‰∏Ä‰∏™ÂàÜÊîØ‰∫ãÂä°ÂêåÊó∂ÊàêÂäüÊàñÂ§±Ë¥•</strong>Âç≥ÂèØ„ÄÇ</p>
<p>Âú®SeataÁöÑ‰∫ãÂä°ÁÆ°ÁêÜ‰∏≠Êúâ‰∏â‰∏™ÈáçË¶ÅÁöÑËßíËâ≤Ôºö</p>
<ul>
<li><strong>TC</strong> (Transaction Coordinator) - <strong>‰∫ãÂä°ÂçèË∞ÉËÄÖ</strong>Ôºö<strong>Áª¥Êä§ÂÖ®Â±ÄÂíåÂàÜÊîØ‰∫ãÂä°ÁöÑÁä∂ÊÄÅ</strong>ÔºåÂçèË∞É<strong>ÂÖ®Â±Ä‰∫ãÂä°Êèê‰∫§ÊàñÂõûÊªö</strong>„ÄÇ </li>
<li><strong>TM</strong> (Transaction Manager) - <strong>‰∫ãÂä°ÁÆ°ÁêÜÂô®</strong>Ôºö<strong>ÂÆö‰πâÂÖ®Â±Ä‰∫ãÂä°ÁöÑËåÉÂõ¥</strong>„ÄÅÂºÄÂßãÂÖ®Â±Ä‰∫ãÂä°„ÄÅÊèê‰∫§ÊàñÂõûÊªöÂÖ®Â±Ä‰∫ãÂä°„ÄÇ </li>
<li><strong>RM</strong> (Resource Manager) - <strong>ËµÑÊ∫êÁÆ°ÁêÜÂô®</strong>Ôºö<strong>ÁÆ°ÁêÜÂàÜÊîØ‰∫ãÂä°</strong>Ôºå‰∏éTC‰∫§Ë∞à‰ª•Ê≥®ÂÜåÂàÜÊîØ‰∫ãÂä°ÂíåÊä•ÂëäÂàÜÊîØ‰∫ãÂä°ÁöÑÁä∂ÊÄÅÔºåÂπ∂<strong>È©±Âä®ÂàÜÊîØ‰∫ãÂä°Êèê‰∫§ÊàñÂõûÊªö</strong>„ÄÇ</li>
</ul>
<p><img src="/img/blogs/java/springcloud/4.3.1.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li><strong>TCÊúçÂä°ÂàôÊòØ‰∫ãÂä°ÂçèË∞É‰∏≠ÂøÉÔºåÊòØ‰∏Ä‰∏™Áã¨Á´ãÁöÑÂæÆÊúçÂä°ÔºåÈúÄË¶ÅÂçïÁã¨ÈÉ®ÁΩ≤</strong></li>
<li>TMÂíåRMÂ∞±‰ºöÂçèÂä©ÂæÆÊúçÂä°Ôºå<strong>ÂÆûÁé∞Êú¨Âú∞ÂàÜÊîØ‰∫ãÂä°‰∏éTC‰πãÈó¥‰∫§‰∫í</strong>ÔºåÂÆûÁé∞‰∫ãÂä°ÁöÑÊèê‰∫§ÊàñÂõûÊªö„ÄÇ</li>
</ul>
<h3 id="3-2-ÈÉ®ÁΩ≤TCÊúçÂä°"><a href="#3-2-ÈÉ®ÁΩ≤TCÊúçÂä°" class="headerlink" title="3.2 ÈÉ®ÁΩ≤TCÊúçÂä°"></a>3.2 ÈÉ®ÁΩ≤TCÊúçÂä°</h3><p>Áª¥Êä§ÂÖ®Â±ÄÂíåÂàÜÊîØ‰∫ãÂä°ÁöÑÁä∂ÊÄÅÔºåÂçèË∞ÉÂÖ®Â±Ä‰∫ãÂä°Êèê‰∫§ÊàñÂõûÊªö„ÄÇ </p>
<h3 id="3-3-ÂæÆÊúçÂä°ÈõÜÊàêSeata"><a href="#3-3-ÂæÆÊúçÂä°ÈõÜÊàêSeata" class="headerlink" title="3.3 ÂæÆÊúçÂä°ÈõÜÊàêSeata"></a>3.3 ÂæÆÊúçÂä°ÈõÜÊàêSeata</h3><h4 id="3-3-1-ÂºïÂÖ•‰æùËµñ"><a href="#3-3-1-ÂºïÂÖ•‰æùËµñ" class="headerlink" title="3.3.1 ÂºïÂÖ•‰æùËµñ"></a>3.3.1 ÂºïÂÖ•‰æùËµñ</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--Áªü‰∏ÄÈÖçÁΩÆÁÆ°ÁêÜ--&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-comment">&lt;!--ËØªÂèñbootstrapÊñá‰ª∂--&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-bootstrap<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-comment">&lt;!--seata--&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba.cloud<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-seata<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="3-3-2-ÈÖçÁΩÆseata"><a href="#3-3-2-ÈÖçÁΩÆseata" class="headerlink" title="3.3.2 ÈÖçÁΩÆseata"></a>3.3.2 ÈÖçÁΩÆseata</h4><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">seata:</span><br>  <span class="hljs-attr">registry:</span> <span class="hljs-comment"># TCÊúçÂä°Ê≥®ÂÜå‰∏≠ÂøÉÁöÑÈÖçÁΩÆÔºåÂæÆÊúçÂä°Ê†πÊçÆËøô‰∫õ‰ø°ÊÅØÂéªÊ≥®ÂÜå‰∏≠ÂøÉËé∑ÂèñtcÊúçÂä°Âú∞ÂùÄ</span><br>    <span class="hljs-attr">type:</span> <span class="hljs-string">nacos</span> <span class="hljs-comment"># Ê≥®ÂÜå‰∏≠ÂøÉÁ±ªÂûã nacos</span><br>    <span class="hljs-attr">nacos:</span><br>      <span class="hljs-attr">server-addr:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.150</span><span class="hljs-number">.101</span><span class="hljs-string">:8848</span> <span class="hljs-comment"># nacosÂú∞ÂùÄ</span><br>      <span class="hljs-attr">namespace:</span> <span class="hljs-string">&quot;&quot;</span> <span class="hljs-comment"># namespaceÔºåÈªòËÆ§‰∏∫Á©∫</span><br>      <span class="hljs-attr">group:</span> <span class="hljs-string">DEFAULT_GROUP</span> <span class="hljs-comment"># ÂàÜÁªÑÔºåÈªòËÆ§ÊòØDEFAULT_GROUP</span><br>      <span class="hljs-attr">application:</span> <span class="hljs-string">seata-server</span> <span class="hljs-comment"># seataÊúçÂä°ÂêçÁß∞</span><br>      <span class="hljs-attr">username:</span> <span class="hljs-string">nacos</span><br>      <span class="hljs-attr">password:</span> <span class="hljs-string">nacos</span><br>  <span class="hljs-attr">tx-service-group:</span> <span class="hljs-string">hmall</span> <span class="hljs-comment"># ‰∫ãÂä°ÁªÑÂêçÁß∞</span><br>  <span class="hljs-attr">service:</span><br>    <span class="hljs-attr">vgroup-mapping:</span> <span class="hljs-comment"># ‰∫ãÂä°ÁªÑ‰∏étcÈõÜÁæ§ÁöÑÊò†Â∞ÑÂÖ≥Á≥ª</span><br>      <span class="hljs-attr">hmall:</span> <span class="hljs-string">&quot;default&quot;</span><br></code></pre></td></tr></table></figure>

<h3 id="3-4-XAÊ®°Âºè"><a href="#3-4-XAÊ®°Âºè" class="headerlink" title="3.4 XAÊ®°Âºè"></a>3.4 XAÊ®°Âºè</h3><p>SeataÊîØÊåÅ<strong>ÂõõÁßç‰∏çÂêåÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°Ëß£ÂÜ≥ÊñπÊ°à</strong>Ôºö</p>
<ul>
<li>XA</li>
<li>TCC</li>
<li>AT</li>
<li>SAGA</li>
</ul>
<p><img src="/img/blogs/java/springcloud/4.3.2.png" srcset="/img/loading.gif" lazyload></p>
<p>RM‰∏ÄÈò∂ÊÆµÁöÑÂ∑•‰ΩúÔºö</p>
<ol>
<li>Ê≥®ÂÜåÂàÜÊîØ‰∫ãÂä°Âà∞TC</li>
<li>ÊâßË°åÂàÜÊîØ‰∏öÂä°sql‰ΩÜ‰∏çÊèê‰∫§</li>
<li>Êä•ÂëäÊâßË°åÁä∂ÊÄÅÂà∞TC</li>
</ol>
<p>TC‰∫åÈò∂ÊÆµÁöÑÂ∑•‰ΩúÔºö</p>
<ul>
<li>TCÊ£ÄÊµãÂêÑÂàÜÊîØ‰∫ãÂä°ÊâßË°åÁä∂ÊÄÅ<ol>
<li>Â¶ÇÊûúÈÉΩÊàêÂäüÔºåÈÄöÁü•ÊâÄÊúâRMÊèê‰∫§‰∫ãÂä°</li>
<li>Â¶ÇÊûúÊúâÂ§±Ë¥•ÔºåÈÄöÁü•ÊâÄÊúâRMÂõûÊªö‰∫ãÂä°</li>
</ol>
</li>
</ul>
<p>RM‰∫åÈò∂ÊÆµÁöÑÂ∑•‰ΩúÔºö</p>
<ul>
<li>Êé•Êî∂TCÊåá‰ª§ÔºåÊèê‰∫§ÊàñÂõûÊªö‰∫ãÂä°</li>
</ul>
<p><strong>‰ºòÁº∫ÁÇπ</strong><br>XAÊ®°ÂºèÁöÑ‰ºòÁÇπÊòØ‰ªÄ‰πàÔºü</p>
<ul>
<li>‰∫ãÂä°ÁöÑ<strong>Âº∫‰∏ÄËá¥ÊÄß</strong>ÔºåÊª°Ë∂≥ACIDÂéüÂàô</li>
<li>Â∏∏Áî®Êï∞ÊçÆÂ∫ìÈÉΩÊîØÊåÅÔºåÂÆûÁé∞ÁÆÄÂçïÔºåÂπ∂‰∏îÊ≤°Êúâ‰ª£Á†Å‰æµÂÖ•</li>
</ul>
<p>XAÊ®°ÂºèÁöÑÁº∫ÁÇπÊòØ‰ªÄ‰πàÔºü</p>
<ul>
<li>Âõ†‰∏∫<strong>‰∏ÄÈò∂ÊÆµÈúÄË¶ÅÈîÅÂÆöÊï∞ÊçÆÂ∫ìËµÑÊ∫êÔºåÁ≠âÂæÖ‰∫åÈò∂ÊÆµÁªìÊùüÊâçÈáäÊîæÔºåÊÄßËÉΩËæÉÂ∑Æ</strong></li>
<li>‰æùËµñÂÖ≥Á≥ªÂûãÊï∞ÊçÆÂ∫ìÂÆûÁé∞‰∫ãÂä°</li>
</ul>
<h3 id="3-5-ATÊ®°Âºè"><a href="#3-5-ATÊ®°Âºè" class="headerlink" title="3.5 ATÊ®°Âºè"></a>3.5 ATÊ®°Âºè</h3><p>ATÊ®°ÂºèÂêåÊ†∑ÊòØÂàÜÈò∂ÊÆµÊèê‰∫§ÁöÑ‰∫ãÂä°Ê®°ÂûãÔºå‰∏çËøáÁº∫Âº•Ë°•‰∫ÜXAÊ®°Âûã‰∏≠ËµÑÊ∫êÈîÅÂÆöÂë®ÊúüËøáÈïøÁöÑÁº∫Èô∑„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/4.3.3.png" srcset="/img/loading.gif" lazyload></p>
<p>Èò∂ÊÆµ‰∏ÄRMÁöÑÂ∑•‰ΩúÔºö</p>
<ul>
<li>Ê≥®ÂÜåÂàÜÊîØ‰∫ãÂä°</li>
<li>ËÆ∞ÂΩïundo-logÔºàÊï∞ÊçÆÂø´ÁÖßÔºâ</li>
<li>ÊâßË°å‰∏öÂä°sqlÂπ∂Êèê‰∫§</li>
<li>Êä•Âëä‰∫ãÂä°Áä∂ÊÄÅ<br>Èò∂ÊÆµ‰∫åÊèê‰∫§Êó∂RMÁöÑÂ∑•‰ΩúÔºö</li>
<li>Âà†Èô§undo-logÂç≥ÂèØ<br>Èò∂ÊÆµ‰∫åÂõûÊªöÊó∂RMÁöÑÂ∑•‰ΩúÔºö</li>
<li>Ê†πÊçÆundo-logÊÅ¢Â§çÊï∞ÊçÆÂà∞Êõ¥Êñ∞Ââç</li>
</ul>
<p><img src="/img/blogs/java/springcloud/4.3.4.png" srcset="/img/loading.gif" lazyload></p>
<p><strong>AT‰∏éXAÁöÑÂå∫Âà´</strong></p>
<ul>
<li>XAÊ®°Âºè‰∏ÄÈò∂ÊÆµ‰∏çÊèê‰∫§‰∫ãÂä°ÔºåÈîÅÂÆöËµÑÊ∫êÔºõATÊ®°Âºè‰∏ÄÈò∂ÊÆµÁõ¥Êé•Êèê‰∫§Ôºå‰∏çÈîÅÂÆöËµÑÊ∫ê„ÄÇ</li>
<li>XAÊ®°Âºè‰æùËµñÊï∞ÊçÆÂ∫ìÊú∫Âà∂ÂÆûÁé∞ÂõûÊªöÔºõATÊ®°ÂºèÂà©Áî®Êï∞ÊçÆÂø´ÁÖßÂÆûÁé∞Êï∞ÊçÆÂõûÊªö„ÄÇ</li>
<li>XAÊ®°ÂºèÂº∫‰∏ÄËá¥ÔºõATÊ®°ÂºèÊúÄÁªà‰∏ÄËá¥</li>
</ul>
<p>ÂèØËßÅÔºåATÊ®°Âºè‰ΩøÁî®Ëµ∑Êù•Êõ¥Âä†ÁÆÄÂçïÔºåÊó†‰∏öÂä°‰æµÂÖ•ÔºåÊÄßËÉΩÊõ¥Â•Ω„ÄÇÂõ†Ê≠§‰ºÅ‰∏ö90%ÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°ÈÉΩÂèØ‰ª•Áî®ATÊ®°ÂºèÊù•Ëß£ÂÜ≥„ÄÇ</p>
<h1 id="‰∫î-MQ"><a href="#‰∫î-MQ" class="headerlink" title="‰∫î. MQ"></a>‰∫î. MQ</h1><h2 id="1-ËÆ§ËØÜMQ"><a href="#1-ËÆ§ËØÜMQ" class="headerlink" title="1. ËÆ§ËØÜMQ"></a>1. ËÆ§ËØÜMQ</h2><h3 id="1-1-ÂêåÊ≠•Ë∞ÉÁî®"><a href="#1-1-ÂêåÊ≠•Ë∞ÉÁî®" class="headerlink" title="1.1 ÂêåÊ≠•Ë∞ÉÁî®"></a>1.1 ÂêåÊ≠•Ë∞ÉÁî®</h3><p>Âú®ÂæÆÊúçÂä°Êû∂ÊûÑ‰∏≠ÔºåÂêåÊ≠•Ë∞ÉÁî®ÔºàSynchronous InvocationÔºâÈÄöÂ∏∏<strong>Êåá‰∏Ä‰∏™ÊúçÂä°Ë∞ÉÁî®Âè¶‰∏Ä‰∏™ÊúçÂä°Êó∂ÔºåË∞ÉÁî®ÊñπÂøÖÈ°ªÁ≠âÂæÖË¢´Ë∞ÉÁî®ÊñπÂ§ÑÁêÜÂÆåËØ∑Ê±ÇÂπ∂ËøîÂõûÂìçÂ∫îÂêéÔºåÊâçËÉΩÁªßÁª≠ÊâßË°åÂêéÁª≠ÈÄªËæë</strong>„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/mq.1.png" srcset="/img/loading.gif" lazyload></p>
<p><strong>ÁâπÁÇπ</strong>Ôºö</p>
<ul>
<li><strong>ÈòªÂ°ûÊâßË°å</strong>ÔºöË∞ÉÁî®ÊñπÂú®Á≠âÂæÖËøîÂõûÁªìÊûúÊó∂Êó†Ê≥ïÊâßË°åÂÖ∂‰ªñ‰ªªÂä°„ÄÇ</li>
<li>ÊâßË°åÈ°∫Â∫è‰∏•Ê†ºÔºö<strong>ÂøÖÈ°ªÊåâÈ°∫Â∫èÁ≠âÂæÖ‰∏ä‰∏Ä‰∏™‰ªªÂä°ÂÆåÊàêÂêéÊâçËÉΩÁªßÁª≠‰∏ã‰∏Ä‰∏™‰ªªÂä°</strong>„ÄÇ</li>
<li><strong>ÈÄÇÁî®‰∫éÁü≠Êó∂Èó¥ÊâßË°åÁöÑ‰ªªÂä°</strong>ÔºöÂ¶ÇÊûúË¢´Ë∞ÉÁî®ÁöÑÊñπÊ≥ïÊâßË°åÊó∂Èó¥ËæÉÈïøÔºå‰ºöÂΩ±ÂìçÁ≥ªÁªüÁöÑÂìçÂ∫îÈÄüÂ∫¶ÂíåÂπ∂ÂèëËÉΩÂäõ„ÄÇ</li>
</ul>
<p><strong>Â≠òÂú®ÁöÑÈóÆÈ¢ò</strong>Ôºö</p>
<ul>
<li>ÊãìÂ±ïÊÄßÂ∑ÆÔºöÊØèÊ¨°ÊúâÊñ∞ÁöÑÈúÄÊ±ÇÔºåÁé∞ÊúâÊîØ‰ªòÈÄªËæëÈÉΩË¶ÅË∑üÁùÄÂèòÂåñÔºå‰ª£Á†ÅÁªèÂ∏∏ÂèòÂä®Ôºå‰∏çÁ¨¶ÂêàÂºÄÈó≠ÂéüÂàôÔºåÊãìÂ±ïÊÄß‰∏çÂ•Ω„ÄÇ</li>
<li>ÊÄßËÉΩ‰∏ãÈôçÔºöÊØèÊ¨°ËøúÁ®ãË∞ÉÁî®ÔºåË∞ÉÁî®ËÄÖÈÉΩÊòØÈòªÂ°ûÁ≠âÂæÖÁä∂ÊÄÅ„ÄÇÊúÄÁªàÊï¥‰∏™‰∏öÂä°ÁöÑÂìçÂ∫îÊó∂ÈïøÂ∞±ÊòØÊØèÊ¨°ËøúÁ®ãË∞ÉÁî®ÁöÑÊâßË°åÊó∂Èïø‰πãÂíå</li>
<li>Á∫ßËÅîÂ§±Ë¥•(Èõ™Â¥©ÈóÆÈ¢ò)ÔºöÂΩì‰∫§ÊòìÊúçÂä°„ÄÅÈÄöÁü•ÊúçÂä°Âá∫Áé∞ÊïÖÈöúÊó∂ÔºåÊï¥‰∏™‰∫ãÂä°ÈÉΩ‰ºöÂõûÊªöÔºå‰∫§ÊòìÂ§±Ë¥•„ÄÇ</li>
</ul>
<h3 id="1-2-ÂºÇÊ≠•Ë∞ÉÁî®"><a href="#1-2-ÂºÇÊ≠•Ë∞ÉÁî®" class="headerlink" title="1.2 ÂºÇÊ≠•Ë∞ÉÁî®"></a>1.2 ÂºÇÊ≠•Ë∞ÉÁî®</h3><p>Âú®ÂæÆÊúçÂä°Êû∂ÊûÑ‰∏≠ÔºåÂºÇÊ≠•Ë∞ÉÁî®ÔºàAsynchronous InvocationÔºâÊåáÁöÑÊòØ<strong>Ë∞ÉÁî®ÊñπÂú®Ë∞ÉÁî®Êüê‰∏™ÊúçÂä°Êó∂Ôºå‰∏çÈúÄË¶ÅÁ≠âÂæÖÂÖ∂ÂÆåÊàêÔºåËÄåÊòØÁ´ãÂç≥ËøîÂõûÂπ∂ÁªßÁª≠ÊâßË°åÂÖ∂‰ªñ‰ªªÂä°</strong>„ÄÇ<strong>Ë¢´Ë∞ÉÁî®ÊñπÂú®ÂÆåÊàêÂ§ÑÁêÜÂêé</strong>ÔºåÂèØ‰ª•ÈÄöËøáÂõûË∞É„ÄÅËΩÆËØ¢„ÄÅ<strong>Ê∂àÊÅØÈòüÂàó</strong>Á≠âÊñπÂºèÈÄöÁü•Ë∞ÉÁî®Êñπ„ÄÇ</p>
<p>ÂºÇÊ≠•Ë∞ÉÁî®ÊñπÂºèÂÖ∂ÂÆûÂ∞±ÊòØÂü∫‰∫éÊ∂àÊÅØÈÄöÁü•ÁöÑÊñπÂºèÔºå‰∏ÄËà¨ÂåÖÂê´‰∏â‰∏™ËßíËâ≤Ôºö</p>
<ul>
<li>Ê∂àÊÅØÂèëÈÄÅËÄÖÔºöÊäïÈÄíÊ∂àÊÅØÁöÑ‰∫∫ÔºåÂ∞±ÊòØÂéüÊù•ÁöÑË∞ÉÁî®Êñπ</li>
<li>Ê∂àÊÅØBrokerÔºöÁÆ°ÁêÜ„ÄÅÊöÇÂ≠ò„ÄÅËΩ¨ÂèëÊ∂àÊÅØÔºå‰Ω†ÂèØ‰ª•ÊääÂÆÉÁêÜËß£ÊàêÂæÆ‰ø°ÊúçÂä°Âô®</li>
<li>Ê∂àÊÅØÊé•Êî∂ËÄÖÔºöÊé•Êî∂ÂíåÂ§ÑÁêÜÊ∂àÊÅØÁöÑ‰∫∫ÔºåÂ∞±ÊòØÂéüÊù•ÁöÑÊúçÂä°Êèê‰æõÊñπ</li>
</ul>
<p><img src="/img/blogs/java/springcloud/mq.2.png" srcset="/img/loading.gif" lazyload></p>
<p>Âú®ÂºÇÊ≠•Ë∞ÉÁî®‰∏≠ÔºåÂèëÈÄÅËÄÖ‰∏çÂÜçÁõ¥Êé•ÂêåÊ≠•Ë∞ÉÁî®Êé•Êî∂ËÄÖÁöÑ‰∏öÂä°Êé•Âè£ÔºåËÄåÊòØÂèëÈÄÅ‰∏ÄÊù°Ê∂àÊÅØÊäïÈÄíÁªôÊ∂àÊÅØBroker„ÄÇÁÑ∂ÂêéÊé•Êî∂ËÄÖÊ†πÊçÆËá™Â∑±ÁöÑÈúÄÊ±Ç‰ªéÊ∂àÊÅØBrokerÈÇ£ÈáåËÆ¢ÈòÖÊ∂àÊÅØ„ÄÇÊØèÂΩìÂèëÈÄÅÊñπÂèëÈÄÅÊ∂àÊÅØÂêéÔºåÊé•ÂèóËÄÖÈÉΩËÉΩËé∑ÂèñÊ∂àÊÅØÂπ∂Â§ÑÁêÜ„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/mq.3.png" srcset="/img/loading.gif" lazyload></p>
<p>ÂºÇÊ≠•Ë∞ÉÁî®ÁöÑ‰ºòÂäøÂåÖÊã¨Ôºö</p>
<ul>
<li>ËÄ¶ÂêàÂ∫¶Êõ¥‰Ωé</li>
<li>ÊÄßËÉΩÊõ¥Â•Ω</li>
<li>‰∏öÂä°ÊãìÂ±ïÊÄßÂº∫</li>
<li>ÊïÖÈöúÈöîÁ¶ªÔºåÈÅøÂÖçÁ∫ßËÅîÂ§±Ë¥•</li>
</ul>
<p>ÂºÇÊ≠•ÈÄö‰ø°Â≠òÂú®‰∏ãÂàóÁº∫ÁÇπÔºö</p>
<ul>
<li>ÂÆåÂÖ®‰æùËµñ‰∫éBrokerÁöÑÂèØÈù†ÊÄß„ÄÅÂÆâÂÖ®ÊÄßÂíåÊÄßËÉΩ</li>
<li>Êû∂ÊûÑÂ§çÊùÇÔºåÂêéÊúüÁª¥Êä§ÂíåË∞ÉËØïÈ∫ªÁÉ¶</li>
</ul>
<h3 id="1-3-Â∏∏ËßÅMQÊäÄÊúØÂØπÊØî"><a href="#1-3-Â∏∏ËßÅMQÊäÄÊúØÂØπÊØî" class="headerlink" title="1.3 Â∏∏ËßÅMQÊäÄÊúØÂØπÊØî"></a>1.3 Â∏∏ËßÅMQÊäÄÊúØÂØπÊØî</h3><table>
<thead>
<tr>
<th>Â∏∏ËßÅMQ</th>
<th>RabbitMQ</th>
<th>ActiveMQ</th>
<th>RocketMQ</th>
<th>Kafka</th>
</tr>
</thead>
<tbody><tr>
<td><strong>ÂÖ¨Âè∏&#x2F;Á§æÂå∫</strong></td>
<td>Rabbit</td>
<td>Apache</td>
<td>ÈòøÈáå</td>
<td>Apache</td>
</tr>
<tr>
<td><strong>ÂºÄÂèëËØ≠Ë®Ä</strong></td>
<td>Erlang</td>
<td>Java</td>
<td>Java</td>
<td>Scala&amp;Java</td>
</tr>
<tr>
<td><strong>ÂçèËÆÆÊîØÊåÅ</strong></td>
<td>AMQP, XMPP, SMTP, STOMP</td>
<td>OpenWire, STOMP, REST, XMPP, AMQP</td>
<td>Ëá™ÂÆö‰πâÂçèËÆÆ</td>
<td>Ëá™ÂÆö‰πâÂçèËÆÆ</td>
</tr>
<tr>
<td><strong>ÂèØÁî®ÊÄß</strong></td>
<td>È´ò</td>
<td>‰∏ÄËà¨</td>
<td>È´ò</td>
<td>È´ò</td>
</tr>
<tr>
<td><strong>ÂçïÊú∫ÂêûÂêêÈáè</strong></td>
<td>‰∏ÄËà¨</td>
<td>Â∑Æ</td>
<td>È´ò</td>
<td>ÈùûÂ∏∏È´ò</td>
</tr>
<tr>
<td><strong>Ê∂àÊÅØÂª∂Ëøü</strong></td>
<td>ÂæÆÁßíÁ∫ß</td>
<td>ÊØ´ÁßíÁ∫ß</td>
<td>ÊØ´ÁßíÁ∫ß</td>
<td>ÊØ´Áßí‰ª•ÂÜÖ</td>
</tr>
<tr>
<td><strong>Ê∂àÊÅØÂèØÈù†ÊÄß</strong></td>
<td>È´ò</td>
<td>‰∏ÄËà¨</td>
<td>È´ò</td>
<td>‰∏ÄËà¨</td>
</tr>
</tbody></table>
<h2 id="2-RabbitMQ"><a href="#2-RabbitMQ" class="headerlink" title="2. RabbitMQ"></a>2. RabbitMQ</h2><h3 id="2-1-RabbitMQÊû∂ÊûÑ"><a href="#2-1-RabbitMQÊû∂ÊûÑ" class="headerlink" title="2.1 RabbitMQÊû∂ÊûÑ"></a>2.1 RabbitMQÊû∂ÊûÑ</h3><ul>
<li>publisherÔºö<strong>Áîü‰∫ßËÄÖ</strong>Ôºå‰πüÂ∞±ÊòØÂèëÈÄÅÊ∂àÊÅØÁöÑ‰∏ÄÊñπ</li>
<li>consumerÔºö<strong>Ê∂àË¥πËÄÖ</strong>Ôºå‰πüÂ∞±ÊòØÊ∂àË¥πÊ∂àÊÅØÁöÑ‰∏ÄÊñπ</li>
<li>queueÔºö<strong>ÈòüÂàóÔºåÂ≠òÂÇ®Ê∂àÊÅØ</strong>„ÄÇÁîü‰∫ßËÄÖÊäïÈÄíÁöÑÊ∂àÊÅØ‰ºöÊöÇÂ≠òÂú®Ê∂àÊÅØÈòüÂàó‰∏≠ÔºåÁ≠âÂæÖÊ∂àË¥πËÄÖÂ§ÑÁêÜ</li>
<li>exchangeÔºö<strong>‰∫§Êç¢Êú∫ÔºåË¥üË¥£Ê∂àÊÅØË∑ØÁî±</strong>„ÄÇÁîü‰∫ßËÄÖÂèëÈÄÅÁöÑÊ∂àÊÅØÁî±‰∫§Êç¢Êú∫ÂÜ≥ÂÆöÊäïÈÄíÂà∞Âì™‰∏™ÈòüÂàó„ÄÇ</li>
<li>virtual hostÔºö<strong>ËôöÊãü‰∏ªÊú∫ÔºåËµ∑Âà∞Êï∞ÊçÆÈöîÁ¶ªÁöÑ‰ΩúÁî®</strong>„ÄÇÊØè‰∏™ËôöÊãü‰∏ªÊú∫Áõ∏‰∫íÁã¨Á´ãÔºåÊúâÂêÑËá™ÁöÑexchange„ÄÅqueue</li>
</ul>
<p><img src="/img/blogs/java/springcloud/mq.4.png" srcset="/img/loading.gif" lazyload></p>
<p>Áîü‰∫ßËÄÖÂèëÈÄÅÂà∞‰∫§Êç¢Êú∫ÁöÑÊ∂àÊÅØÔºåÂè™‰ºöË∑ØÁî±Âà∞‰∏éÂÖ∂ÁªëÂÆöÁöÑÈòüÂàóÔºåÂõ†Ê≠§‰ªÖ‰ªÖÂàõÂª∫ÈòüÂàóÊòØ‰∏çÂ§üÁöÑÔºåÊàë‰ª¨ËøòÈúÄË¶ÅÂ∞ÜÂÖ∂‰∏é‰∫§Êç¢Êú∫ÁªëÂÆö</p>
<h3 id="2-2-Êï∞ÊçÆÈöîÁ¶ª"><a href="#2-2-Êï∞ÊçÆÈöîÁ¶ª" class="headerlink" title="2.2 Êï∞ÊçÆÈöîÁ¶ª"></a>2.2 Êï∞ÊçÆÈöîÁ¶ª</h3><ul>
<li>ÁªôÊØè‰∏™È°πÁõÆÂàõÂª∫‰∏çÂêåÁöÑvirtual hostÔºåÂ∞ÜÊØè‰∏™È°πÁõÆÁöÑÊï∞ÊçÆÈöîÁ¶ª„ÄÇ</li>
<li>ÁªôÊØè‰∏™È°πÁõÆÂàõÂª∫Áã¨Á´ãÁöÑËøêÁª¥Ë¥¶Âè∑ÔºåÂ∞ÜÁÆ°ÁêÜÊùÉÈôêÂàÜÁ¶ª„ÄÇ</li>
</ul>
<h2 id="3-SpringAMQP"><a href="#3-SpringAMQP" class="headerlink" title="3. SpringAMQP"></a>3. SpringAMQP</h2><h3 id="3-1-ÂÖ•Èó®Ê°à‰æã"><a href="#3-1-ÂÖ•Èó®Ê°à‰æã" class="headerlink" title="3.1 ÂÖ•Èó®Ê°à‰æã"></a>3.1 ÂÖ•Èó®Ê°à‰æã</h3><h4 id="3-1-1-ÂºïÂÖ•‰æùËµñ"><a href="#3-1-1-ÂºïÂÖ•‰æùËµñ" class="headerlink" title="3.1.1 ÂºïÂÖ•‰æùËµñ"></a>3.1.1 ÂºïÂÖ•‰æùËµñ</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!--AMQP‰æùËµñÔºåÂåÖÂê´RabbitMQ--&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>     <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br> <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="3-1-2-Ê∑ªÂä†ÈÖçÁΩÆ"><a href="#3-1-2-Ê∑ªÂä†ÈÖçÁΩÆ" class="headerlink" title="3.1.2 Ê∑ªÂä†ÈÖçÁΩÆ"></a>3.1.2 Ê∑ªÂä†ÈÖçÁΩÆ</h4><p>Âú®publisherÊúçÂä°ÁöÑapplication.yml‰∏≠Ê∑ªÂä†ÈÖçÁΩÆÔºö</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">rabbitmq:</span><br>    <span class="hljs-attr">host:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.150</span><span class="hljs-number">.101</span> <span class="hljs-comment"># ‰Ω†ÁöÑËôöÊãüÊú∫IP</span><br>    <span class="hljs-attr">port:</span> <span class="hljs-number">5672</span> <span class="hljs-comment"># Á´ØÂè£</span><br>    <span class="hljs-attr">virtual-host:</span> <span class="hljs-string">/hmall</span> <span class="hljs-comment"># ËôöÊãü‰∏ªÊú∫</span><br>    <span class="hljs-attr">username:</span> <span class="hljs-string">hmall</span> <span class="hljs-comment"># Áî®Êà∑Âêç</span><br>    <span class="hljs-attr">password:</span> <span class="hljs-number">123</span> <span class="hljs-comment"># ÂØÜÁ†Å</span><br></code></pre></td></tr></table></figure>

<h4 id="3-1-3-ÂèëÈÄÅÊ∂àÊÅØ"><a href="#3-1-3-ÂèëÈÄÅÊ∂àÊÅØ" class="headerlink" title="3.1.3 ÂèëÈÄÅÊ∂àÊÅØ"></a>3.1.3 ÂèëÈÄÅÊ∂àÊÅØ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@SpringBootTest</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringAmqpTest</span> &#123;<br><br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> RabbitTemplate rabbitTemplate;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSimpleQueue</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-comment">// ÈòüÂàóÂêçÁß∞</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">queueName</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;simple.queue&quot;</span>;<br>        <span class="hljs-comment">// Ê∂àÊÅØ</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;hello, spring amqp!&quot;</span>;<br>        <span class="hljs-comment">// ÂèëÈÄÅÊ∂àÊÅØ</span><br>        rabbitTemplate.convertAndSend(queueName, message);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="3-1-4-Êé•Êî∂Ê∂àÊÅØ"><a href="#3-1-4-Êé•Êî∂Ê∂àÊÅØ" class="headerlink" title="3.1.4 Êé•Êî∂Ê∂àÊÅØ"></a>3.1.4 Êé•Êî∂Ê∂àÊÅØ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SpringRabbitListener</span> &#123;<br>    <span class="hljs-comment">// Âà©Áî®RabbitListenerÊù•Â£∞ÊòéË¶ÅÁõëÂê¨ÁöÑÈòüÂàó‰ø°ÊÅØ</span><br>    <span class="hljs-comment">// Â∞ÜÊù•‰∏ÄÊó¶ÁõëÂê¨ÁöÑÈòüÂàó‰∏≠Êúâ‰∫ÜÊ∂àÊÅØÔºåÂ∞±‰ºöÊé®ÈÄÅÁªôÂΩìÂâçÊúçÂä°ÔºåË∞ÉÁî®ÂΩìÂâçÊñπÊ≥ïÔºåÂ§ÑÁêÜÊ∂àÊÅØ„ÄÇ</span><br>    <span class="hljs-comment">// ÂèØ‰ª•ÁúãÂà∞ÊñπÊ≥ï‰Ωì‰∏≠Êé•Êî∂ÁöÑÂ∞±ÊòØÊ∂àÊÅØ‰ΩìÁöÑÂÜÖÂÆπ</span><br>    <span class="hljs-meta">@RabbitListener(queues = &quot;simple.queue&quot;)</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">listenSimpleQueueMessage</span><span class="hljs-params">(String msg)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>        System.out.println(<span class="hljs-string">&quot;spring Ê∂àË¥πËÄÖÊé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äê&quot;</span> + msg + <span class="hljs-string">&quot;„Äë&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="3-2-WorkQueuesÊ®°Âûã"><a href="#3-2-WorkQueuesÊ®°Âûã" class="headerlink" title="3.2 WorkQueuesÊ®°Âûã"></a>3.2 WorkQueuesÊ®°Âûã</h3><p>ËÆ©Â§ö‰∏™Ê∂àË¥πËÄÖÁªëÂÆöÂà∞‰∏Ä‰∏™ÈòüÂàóÔºåÂÖ±ÂêåÊ∂àË¥πÈòüÂàó‰∏≠ÁöÑÊ∂àÊÅØ„ÄÇÂèØ‰ª•‰ΩøÁî®WorkQueuesÊ®°ÂûãÔºåÂ§ö‰∏™Ê∂àË¥πËÄÖÂÖ±ÂêåÂ§ÑÁêÜÊ∂àÊÅØÂ§ÑÁêÜÔºåÊ∂àÊÅØÂ§ÑÁêÜÁöÑÈÄüÂ∫¶Â∞±ËÉΩÂ§ßÂ§ßÊèêÈ´ò‰∫Ü„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/mq.5.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="3-2-1-Ê∂àÊÅØÂèëÈÄÅ"><a href="#3-2-1-Ê∂àÊÅØÂèëÈÄÅ" class="headerlink" title="3.2.1 Ê∂àÊÅØÂèëÈÄÅ"></a>3.2.1 Ê∂àÊÅØÂèëÈÄÅ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">     * workQueue</span><br><span class="hljs-comment">     * ÂêëÈòüÂàó‰∏≠‰∏çÂÅúÂèëÈÄÅÊ∂àÊÅØÔºåÊ®°ÊãüÊ∂àÊÅØÂ†ÜÁßØ„ÄÇ</span><br><span class="hljs-comment">     */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testWorkQueue</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>    <span class="hljs-comment">// ÈòüÂàóÂêçÁß∞</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">queueName</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;simple.queue&quot;</span>;<br>    <span class="hljs-comment">// Ê∂àÊÅØ</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;hello, message_&quot;</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">50</span>; i++) &#123;<br>        <span class="hljs-comment">// ÂèëÈÄÅÊ∂àÊÅØÔºåÊØè20ÊØ´ÁßíÂèëÈÄÅ‰∏ÄÊ¨°ÔºåÁõ∏ÂΩì‰∫éÊØèÁßíÂèëÈÄÅ50Êù°Ê∂àÊÅØ</span><br>        rabbitTemplate.convertAndSend(queueName, message + i);<br>        Thread.sleep(<span class="hljs-number">20</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="3-2-2-Ê∂àÊÅØÊé•Êî∂"><a href="#3-2-2-Ê∂àÊÅØÊé•Êî∂" class="headerlink" title="3.2.2 Ê∂àÊÅØÊé•Êî∂"></a>3.2.2 Ê∂àÊÅØÊé•Êî∂</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RabbitListener(queues = &quot;work.queue&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">listenWorkQueue1</span><span class="hljs-params">(String msg)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>    System.out.println(<span class="hljs-string">&quot;Ê∂àË¥πËÄÖ1Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äê&quot;</span> + msg + <span class="hljs-string">&quot;„Äë&quot;</span> + LocalTime.now());<br>    Thread.sleep(<span class="hljs-number">20</span>);<br>&#125;<br><br><span class="hljs-meta">@RabbitListener(queues = &quot;work.queue&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">listenWorkQueue2</span><span class="hljs-params">(String msg)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>    System.err.println(<span class="hljs-string">&quot;Ê∂àË¥πËÄÖ2........Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äê&quot;</span> + msg + <span class="hljs-string">&quot;„Äë&quot;</span> + LocalTime.now());<br>    Thread.sleep(<span class="hljs-number">200</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>Ê∂àË¥πËÄÖ1 sleep‰∫Ü20ÊØ´ÁßíÔºåÁõ∏ÂΩì‰∫éÊØèÁßíÈíüÂ§ÑÁêÜ50‰∏™Ê∂àÊÅØ</li>
<li>Ê∂àË¥πËÄÖ2 sleep‰∫Ü200ÊØ´ÁßíÔºåÁõ∏ÂΩì‰∫éÊØèÁßíÂ§ÑÁêÜ5‰∏™Ê∂àÊÅØ</li>
</ul>
<h4 id="3-2-3-ÊµãËØïÁªìÊûú"><a href="#3-2-3-ÊµãËØïÁªìÊûú" class="headerlink" title="3.2.3 ÊµãËØïÁªìÊûú"></a>3.2.3 ÊµãËØïÁªìÊûú</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs java">Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_0„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">00.869555300</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_1„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">00.884518</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_2„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">00.907454400</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_4„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">00.953332100</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_6„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">00.997867300</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_8„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.042178700</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_3„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.086478800</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_10„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.087476600</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_12„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.132578300</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_14„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.175851200</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_16„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.218533400</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_18„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.261322900</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_5„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.287003700</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_20„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.304412400</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_22„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.349950100</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_24„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.394533900</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_26„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.439876500</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_28„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.482937800</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_7„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.488977100</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_30„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.526409300</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_32„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.572148</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_34„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.618264800</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_36„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.660780600</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_9„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.689189300</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_38„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.705261</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_40„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.746927300</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_42„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.789835</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_44„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.834393100</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_46„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.875312100</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_11„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.889969500</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">1</span>Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_48„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">01.920702500</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_13„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">02.090725900</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_15„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">02.293060600</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_17„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">02.493748</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_19„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">02.696635100</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_21„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">02.896809700</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_23„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">03.099533400</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_25„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">03.301446400</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_27„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">03.504999100</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_29„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">03.705702500</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_31„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">03.906601200</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_33„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">04.108118500</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_35„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">04.308945400</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_37„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">04.511547700</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_39„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">04.714038400</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_41„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">04.916192700</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_43„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">05.116286400</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_45„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">05.318055100</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_47„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">05.520656400</span><br>Ê∂àË¥πËÄÖ<span class="hljs-number">2.</span>.......Êé•Êî∂Âà∞Ê∂àÊÅØÔºö„Äêhello, message_49„Äë<span class="hljs-number">21</span>:<span class="hljs-number">06</span>:<span class="hljs-number">05.723106700</span><br></code></pre></td></tr></table></figure>

<p>ÂèØ‰ª•ÁúãÂà∞Ê∂àË¥πËÄÖ1ÂíåÊ∂àË¥πËÄÖ2Á´üÁÑ∂ÊØè‰∫∫Ê∂àË¥π‰∫Ü25Êù°Ê∂àÊÅØÔºö</p>
<ul>
<li>Ê∂àË¥πËÄÖ1ÂæàÂø´ÂÆåÊàê‰∫ÜËá™Â∑±ÁöÑ25Êù°Ê∂àÊÅØ</li>
<li>Ê∂àË¥πËÄÖ2Âç¥Âú®ÁºìÊÖ¢ÁöÑÂ§ÑÁêÜËá™Â∑±ÁöÑ25Êù°Ê∂àÊÅØ„ÄÇ<br>‰πüÂ∞±ÊòØËØ¥<strong>Ê∂àÊÅØÊòØÂπ≥ÂùáÂàÜÈÖçÁªôÊØè‰∏™Ê∂àË¥πËÄÖ</strong>ÔºåÂπ∂Ê≤°ÊúâËÄÉËôëÂà∞Ê∂àË¥πËÄÖÁöÑÂ§ÑÁêÜËÉΩÂäõ„ÄÇÂØºËá¥1‰∏™Ê∂àË¥πËÄÖÁ©∫Èó≤ÔºåÂè¶‰∏Ä‰∏™Ê∂àË¥πËÄÖÂøôÁöÑ‰∏çÂèØÂºÄ‰∫§„ÄÇ</li>
</ul>
<h4 id="3-2-4-ËÉΩËÄÖÂ§öÂä≥ÈÖçÁΩÆ"><a href="#3-2-4-ËÉΩËÄÖÂ§öÂä≥ÈÖçÁΩÆ" class="headerlink" title="3.2.4 ËÉΩËÄÖÂ§öÂä≥ÈÖçÁΩÆ"></a>3.2.4 ËÉΩËÄÖÂ§öÂä≥ÈÖçÁΩÆ</h4><p>‰øÆÊîπconsumerÊúçÂä°ÁöÑapplication.ymlÊñá‰ª∂ÔºåÊ∑ªÂä†ÈÖçÁΩÆÔºö</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">rabbitmq:</span><br>    <span class="hljs-attr">listener:</span><br>      <span class="hljs-attr">simple:</span><br>        <span class="hljs-attr">prefetch:</span> <span class="hljs-number">1</span> <span class="hljs-comment"># ÊØèÊ¨°Âè™ËÉΩËé∑Âèñ‰∏ÄÊù°Ê∂àÊÅØÔºåÂ§ÑÁêÜÂÆåÊàêÊâçËÉΩËé∑Âèñ‰∏ã‰∏Ä‰∏™Ê∂àÊÅØ</span><br></code></pre></td></tr></table></figure>

<p>ÂÜçÊ¨°ÊµãËØïÂèëÁé∞ÔºåÁî±‰∫éÊ∂àË¥πËÄÖ1Â§ÑÁêÜÈÄüÂ∫¶ËæÉÂø´ÔºåÊâÄ‰ª•Â§ÑÁêÜ‰∫ÜÊõ¥Â§öÁöÑÊ∂àÊÅØÔºõÊ∂àË¥πËÄÖ2Â§ÑÁêÜÈÄüÂ∫¶ËæÉÊÖ¢ÔºåÂè™Â§ÑÁêÜ‰∫Ü6Êù°Ê∂àÊÅØ„ÄÇËÄåÊúÄÁªàÊÄªÁöÑÊâßË°åËÄóÊó∂‰πüÂú®1ÁßíÂ∑¶Âè≥ÔºåÂ§ßÂ§ßÊèêÂçá„ÄÇ<br>Ê≠£ÊâÄË∞ìËÉΩËÄÖÂ§öÂä≥ÔºåËøôÊ†∑ÂÖÖÂàÜÂà©Áî®‰∫ÜÊØè‰∏Ä‰∏™Ê∂àË¥πËÄÖÁöÑÂ§ÑÁêÜËÉΩÂäõÔºåÂèØ‰ª•ÊúâÊïàÈÅøÂÖçÊ∂àÊÅØÁßØÂéãÈóÆÈ¢ò„ÄÇ</p>
<h4 id="3-2-5-WorkÊ®°ÂûãÊÄªÁªì"><a href="#3-2-5-WorkÊ®°ÂûãÊÄªÁªì" class="headerlink" title="3.2.5 WorkÊ®°ÂûãÊÄªÁªì"></a>3.2.5 WorkÊ®°ÂûãÊÄªÁªì</h4><ul>
<li><strong>Â§ö‰∏™Ê∂àË¥πËÄÖÁªëÂÆöÂà∞‰∏Ä‰∏™ÈòüÂàóÔºåÂêå‰∏ÄÊù°Ê∂àÊÅØÂè™‰ºöË¢´‰∏Ä‰∏™Ê∂àË¥πËÄÖÂ§ÑÁêÜ</strong></li>
<li>ÈÄöËøáËÆæÁΩÆprefetchÊù•ÊéßÂà∂Ê∂àË¥πËÄÖÈ¢ÑÂèñÁöÑÊ∂àÊÅØÊï∞Èáè</li>
</ul>
<h3 id="3-3-‰∫§Êç¢Êú∫"><a href="#3-3-‰∫§Êç¢Êú∫" class="headerlink" title="3.3 ‰∫§Êç¢Êú∫"></a>3.3 ‰∫§Êç¢Êú∫</h3><p>‰∫§Êç¢Êú∫ÁöÑÁ±ªÂûãÔºö</p>
<ul>
<li>FanoutÔºöÂπøÊí≠ÔºåÂ∞ÜÊ∂àÊÅØ‰∫§ÁªôÊâÄÊúâÁªëÂÆöÂà∞‰∫§Êç¢Êú∫ÁöÑÈòüÂàó„ÄÇÊàë‰ª¨ÊúÄÊó©Âú®ÊéßÂà∂Âè∞‰ΩøÁî®ÁöÑÊ≠£ÊòØFanout‰∫§Êç¢Êú∫</li>
<li>DirectÔºöËÆ¢ÈòÖÔºåÂü∫‰∫éRoutingKeyÔºàË∑ØÁî±keyÔºâÂèëÈÄÅÁªôËÆ¢ÈòÖ‰∫ÜÊ∂àÊÅØÁöÑÈòüÂàó</li>
<li>TopicÔºöÈÄöÈÖçÁ¨¶ËÆ¢ÈòÖÔºå‰∏éDirectÁ±ª‰ººÔºåÂè™‰∏çËøáRoutingKeyÂèØ‰ª•‰ΩøÁî®ÈÄöÈÖçÁ¨¶</li>
</ul>
<h4 id="3-3-1-Fanout‰∫§Êç¢Êú∫"><a href="#3-3-1-Fanout‰∫§Êç¢Êú∫" class="headerlink" title="3.3.1 Fanout‰∫§Êç¢Êú∫"></a>3.3.1 Fanout‰∫§Êç¢Êú∫</h4><p><strong>ÂπøÊí≠</strong>‰∫§Êç¢Êú∫Ôºå‰∫§Êç¢Êú∫ÊääÊ∂àÊÅØÂèëÈÄÅÁªôÁªëÂÆöËøáÁöÑÊâÄÊúâÈòüÂàóÔºåÊØè‰∏™ÈòüÂàóÁöÑÊ∂àË¥πËÄÖÈÉΩËÉΩÊî∂Âà∞Ê∂àÊÅØ</p>
<p><img src="/img/blogs/java/springcloud/mq.6.png" srcset="/img/loading.gif" lazyload></p>
<ol>
<li>Ê∂àÊÅØÂèëÈÄÅ</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testFanoutExchange</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// ‰∫§Êç¢Êú∫ÂêçÁß∞</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">exchangeName</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;hmall.fanout&quot;</span>;<br>    <span class="hljs-comment">// Ê∂àÊÅØ</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;hello, everyone!&quot;</span>;<br>    rabbitTemplate.convertAndSend(exchangeName, <span class="hljs-string">&quot;&quot;</span>, message);<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>Ê∂àÊÅØÊé•Êî∂</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testFanoutExchange</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// ‰∫§Êç¢Êú∫ÂêçÁß∞</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">exchangeName</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;hmall.fanout&quot;</span>;<br>    <span class="hljs-comment">// Ê∂àÊÅØ</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;hello, everyone!&quot;</span>;<br>    rabbitTemplate.convertAndSend(exchangeName, <span class="hljs-string">&quot;&quot;</span>, message);<br>&#125;<br></code></pre></td></tr></table></figure>

<ul>
<li>FanoutExchangeÁöÑ‰ºöÂ∞ÜÊ∂àÊÅØË∑ØÁî±Âà∞ÊØè‰∏™ÁªëÂÆöÁöÑÈòüÂàó</li>
</ul>
<h4 id="3-3-2-Direct‰∫§Êç¢Êú∫"><a href="#3-3-2-Direct‰∫§Êç¢Êú∫" class="headerlink" title="3.3.2 Direct‰∫§Êç¢Êú∫"></a>3.3.2 Direct‰∫§Êç¢Êú∫</h4><p>DirectÊ®°Âûã‰∏ãÔºö</p>
<ul>
<li>ÈòüÂàó‰∏é‰∫§Êç¢Êú∫ÁöÑÁªëÂÆöÔºå‰∏çËÉΩÊòØ‰ªªÊÑèÁªëÂÆö‰∫ÜÔºåËÄåÊòØË¶Å<strong>ÊåáÂÆö‰∏Ä‰∏™RoutingKeyÔºàË∑ØÁî±keyÔºâ</strong></li>
<li>Ê∂àÊÅØÁöÑÂèëÈÄÅÊñπÂú® Âêë ExchangeÂèëÈÄÅÊ∂àÊÅØÊó∂Ôºå‰πüÂøÖÈ°ªÊåáÂÆöÊ∂àÊÅØÁöÑ RoutingKey„ÄÇ</li>
<li>Exchange‰∏çÂÜçÊääÊ∂àÊÅØ‰∫§ÁªôÊØè‰∏Ä‰∏™ÁªëÂÆöÁöÑÈòüÂàóÔºåËÄåÊòØÊ†πÊçÆÊ∂àÊÅØÁöÑRouting KeyËøõË°åÂà§Êñ≠Ôºå<strong>Âè™ÊúâÈòüÂàóÁöÑRoutingkey‰∏éÊ∂àÊÅØÁöÑ Routing keyÂÆåÂÖ®‰∏ÄËá¥</strong>ÔºåÊâç‰ºöÊé•Êî∂Âà∞Ê∂àÊÅØ</li>
</ul>
<p><img src="/img/blogs/java/springcloud/mq.7.png" srcset="/img/loading.gif" lazyload></p>
<h5 id="3-3-2-1-Ê∂àÊÅØÊé•Êî∂"><a href="#3-3-2-1-Ê∂àÊÅØÊé•Êî∂" class="headerlink" title="3.3.2.1 Ê∂àÊÅØÊé•Êî∂"></a>3.3.2.1 Ê∂àÊÅØÊé•Êî∂</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RabbitListener(queues = &quot;direct.queue1&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">listenDirectQueue1</span><span class="hljs-params">(String msg)</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot;Ê∂àË¥πËÄÖ1Êé•Êî∂Âà∞direct.queue1ÁöÑÊ∂àÊÅØÔºö„Äê&quot;</span> + msg + <span class="hljs-string">&quot;„Äë&quot;</span>);<br>&#125;<br><br><span class="hljs-meta">@RabbitListener(queues = &quot;direct.queue2&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">listenDirectQueue2</span><span class="hljs-params">(String msg)</span> &#123;<br>    System.out.println(<span class="hljs-string">&quot;Ê∂àË¥πËÄÖ2Êé•Êî∂Âà∞direct.queue2ÁöÑÊ∂àÊÅØÔºö„Äê&quot;</span> + msg + <span class="hljs-string">&quot;„Äë&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="3-3-2-2-Ê∂àÊÅØÂèëÈÄÅ"><a href="#3-3-2-2-Ê∂àÊÅØÂèëÈÄÅ" class="headerlink" title="3.3.2.2 Ê∂àÊÅØÂèëÈÄÅ"></a>3.3.2.2 Ê∂àÊÅØÂèëÈÄÅ</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSendDirectExchange</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// ‰∫§Êç¢Êú∫ÂêçÁß∞</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">exchangeName</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;hmall.direct&quot;</span>;<br>    <span class="hljs-comment">// Ê∂àÊÅØ</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;ÊúÄÊñ∞Êä•ÈÅìÔºåÂì•ÊñØÊãâÊòØÂ±ÖÊ∞ëËá™Ê≤ªÂ∑®ÂûãÊ∞îÁêÉÔºåËôöÊÉä‰∏ÄÂú∫ÔºÅ&quot;</span>;<br>    <span class="hljs-comment">// ÂèëÈÄÅÊ∂àÊÅØ</span><br>    rabbitTemplate.convertAndSend(exchangeName, <span class="hljs-string">&quot;blue&quot;</span>, message);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>Ê≠§Êó∂Âè™Êúâ<code>blue</code>ÁöÑÊ∂àË¥πËÄÖÊâç‰ºöÊî∂Âà∞Ê∂àÊÅØÔºå‰πüÂ∞±ÊòØÊ∂àË¥πËÄÖ1</p>
<h5 id="3-3-2-3-ÊÄªÁªì"><a href="#3-3-2-3-ÊÄªÁªì" class="headerlink" title="3.3.2.3 ÊÄªÁªì"></a>3.3.2.3 ÊÄªÁªì</h5><p>Direct‰∫§Êç¢Êú∫‰∏éFanout‰∫§Êç¢Êú∫ÁöÑÂ∑ÆÂºÇÔºü</p>
<ul>
<li>Fanout‰∫§Êç¢Êú∫Â∞ÜÊ∂àÊÅØË∑ØÁî±ÁªôÊØè‰∏Ä‰∏™‰∏é‰πãÁªëÂÆöÁöÑÈòüÂàó</li>
<li>Direct‰∫§Êç¢Êú∫Ê†πÊçÆRoutingKeyÂà§Êñ≠Ë∑ØÁî±ÁªôÂì™‰∏™ÈòüÂàó</li>
<li>Â¶ÇÊûúÂ§ö‰∏™ÈòüÂàóÂÖ∑ÊúâÁõ∏ÂêåÁöÑRoutingKeyÔºåÂàô‰∏éFanoutÂäüËÉΩÁ±ª‰ºº</li>
</ul>
<h4 id="3-3-3-Topic‰∫§Êç¢Êú∫"><a href="#3-3-3-Topic‰∫§Êç¢Êú∫" class="headerlink" title="3.3.3 Topic‰∫§Êç¢Êú∫"></a>3.3.3 Topic‰∫§Êç¢Êú∫</h4><p>TopicÁ±ªÂûãÁöÑExchange‰∏éDirectÁõ∏ÊØîÔºåÈÉΩÊòØÂèØ‰ª•<strong>Ê†πÊçÆRoutingKeyÊääÊ∂àÊÅØË∑ØÁî±Âà∞‰∏çÂêåÁöÑÈòüÂàó</strong>„ÄÇ<br>Âè™‰∏çËøáTopicÁ±ªÂûãExchange<strong>ÂèØ‰ª•</strong>ËÆ©ÈòüÂàóÂú®ÁªëÂÆöBindingKey ÁöÑÊó∂ÂÄô<strong>‰ΩøÁî®ÈÄöÈÖçÁ¨¶</strong>ÔºÅ</p>
<p>ÈÄöÈÖçÁ¨¶ËßÑÂàôÔºö</p>
<ul>
<li>#ÔºöÂåπÈÖç‰∏Ä‰∏™ÊàñÂ§ö‰∏™ËØç</li>
<li>*ÔºöÂåπÈÖç‰∏çÂ§ö‰∏çÂ∞ëÊÅ∞Â•Ω1‰∏™ËØç</li>
</ul>
<p>‰∏æ‰æãÔºö</p>
<ul>
<li>item.#ÔºöËÉΩÂ§üÂåπÈÖçitem.spu.insert ÊàñËÄÖ item.spu</li>
<li>item.*ÔºöÂè™ËÉΩÂåπÈÖçitem.spu</li>
</ul>
<p><img src="/img/blogs/java/springcloud/mq.8.png" srcset="/img/loading.gif" lazyload></p>
<ol>
<li>Ê∂àÊÅØÂèëÈÄÅ</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * topicExchange</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testSendTopicExchange</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// ‰∫§Êç¢Êú∫ÂêçÁß∞</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">exchangeName</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;hmall.topic&quot;</span>;<br>    <span class="hljs-comment">// Ê∂àÊÅØ</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;ÂñúÊä•ÔºÅÂ≠ôÊÇüÁ©∫Â§ßÊàòÂì•ÊñØÊãâÔºåËÉú!&quot;</span>;<br>    <span class="hljs-comment">// ÂèëÈÄÅÊ∂àÊÅØ</span><br>    rabbitTemplate.convertAndSend(exchangeName, <span class="hljs-string">&quot;china.news&quot;</span>, message);<br>&#125;<br></code></pre></td></tr></table></figure>

<ol>
<li>Ê∂àÊÅØÊé•Êî∂</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RabbitListener(queues = &quot;topic.queue1&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">listenTopicQueue1</span><span class="hljs-params">(String msg)</span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;Ê∂àË¥πËÄÖ1Êé•Êî∂Âà∞topic.queue1ÁöÑÊ∂àÊÅØÔºö„Äê&quot;</span> + msg + <span class="hljs-string">&quot;„Äë&quot;</span>);<br>&#125;<br><br><span class="hljs-meta">@RabbitListener(queues = &quot;topic.queue2&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">listenTopicQueue2</span><span class="hljs-params">(String msg)</span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;Ê∂àË¥πËÄÖ2Êé•Êî∂Âà∞topic.queue2ÁöÑÊ∂àÊÅØÔºö„Äê&quot;</span> + msg + <span class="hljs-string">&quot;„Äë&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<ol start="3">
<li>Direct‰∫§Êç¢Êú∫‰∏éTopic‰∫§Êç¢Êú∫ÁöÑÂ∑ÆÂºÇ</li>
</ol>
<ul>
<li>Topic‰∫§Êç¢Êú∫Êé•Êî∂ÁöÑÊ∂àÊÅØRoutingKeyÂøÖÈ°ªÊòØÂ§ö‰∏™ÂçïËØçÔºå‰ª• . ÂàÜÂâ≤</li>
<li>Topic‰∫§Êç¢Êú∫‰∏éÈòüÂàóÁªëÂÆöÊó∂ÁöÑbindingKeyÂèØ‰ª•ÊåáÂÆöÈÄöÈÖçÁ¨¶</li>
<li>#Ôºö‰ª£Ë°®0‰∏™ÊàñÂ§ö‰∏™ËØç</li>
<li>*Ôºö‰ª£Ë°®1‰∏™ËØç</li>
</ul>
<h3 id="3-4-Â£∞ÊòéÈòüÂàóÂíå‰∫§Êç¢Êú∫"><a href="#3-4-Â£∞ÊòéÈòüÂàóÂíå‰∫§Êç¢Êú∫" class="headerlink" title="3.4 Â£∞ÊòéÈòüÂàóÂíå‰∫§Êç¢Êú∫"></a>3.4 Â£∞ÊòéÈòüÂàóÂíå‰∫§Êç¢Êú∫</h3><p>SpringÊèê‰æõ‰∫ÜÂü∫‰∫éÊ≥®Ëß£ÊñπÂºèÊù•Â£∞Êòé</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RabbitListener(bindings = @QueueBinding(</span><br><span class="hljs-meta">    value = @Queue(name = &quot;direct.queue1&quot;),</span><br><span class="hljs-meta">    exchange = @Exchange(name = &quot;hmall.direct&quot;, type = ExchangeTypes.DIRECT),</span><br><span class="hljs-meta">    key = &#123;&quot;red&quot;, &quot;blue&quot;&#125;</span><br><span class="hljs-meta">))</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">listenDirectQueue1</span><span class="hljs-params">(String msg)</span>&#123;<br>    System.out.println(<span class="hljs-string">&quot;Ê∂àË¥πËÄÖ1Êé•Êî∂Âà∞direct.queue1ÁöÑÊ∂àÊÅØÔºö„Äê&quot;</span> + msg + <span class="hljs-string">&quot;„Äë&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="3-5-Ê∂àÊÅØËΩ¨Êç¢Âô®-JSONËΩ¨Êç¢Âô®"><a href="#3-5-Ê∂àÊÅØËΩ¨Êç¢Âô®-JSONËΩ¨Êç¢Âô®" class="headerlink" title="3.5 Ê∂àÊÅØËΩ¨Êç¢Âô®(JSONËΩ¨Êç¢Âô®)"></a>3.5 Ê∂àÊÅØËΩ¨Êç¢Âô®(JSONËΩ¨Êç¢Âô®)</h3><p>ÈªòËÆ§ÊÉÖÂÜµ‰∏ãSpringÈááÁî®ÁöÑÂ∫èÂàóÂåñÊñπÂºèÊòØJDKÂ∫èÂàóÂåñ„ÄÇ‰ºóÊâÄÂë®Áü•ÔºåJDKÂ∫èÂàóÂåñÂ≠òÂú®‰∏ãÂàóÈóÆÈ¢òÔºö</p>
<ul>
<li>Êï∞ÊçÆ‰ΩìÁßØËøáÂ§ß</li>
<li>ÊúâÂÆâÂÖ®ÊºèÊ¥û</li>
<li>ÂèØËØªÊÄßÂ∑Æ</li>
</ul>
<p>Âõ†Ê≠§ÂèØ‰ª•‰ΩøÁî®JSONÊñπÂºèÊù•ÂÅöÂ∫èÂàóÂåñÂíåÂèçÂ∫èÂàóÂåñ„ÄÇ</p>
<h4 id="3-5-1-ÂºïÂÖ•‰æùËµñ"><a href="#3-5-1-ÂºïÂÖ•‰æùËµñ" class="headerlink" title="3.5.1 ÂºïÂÖ•‰æùËµñ"></a>3.5.1 ÂºïÂÖ•‰æùËµñ</h4><p>Âú®publisherÂíåconsumer‰∏§‰∏™ÊúçÂä°‰∏≠ÈÉΩÂºïÂÖ•‰æùËµñÔºö</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.fasterxml.jackson.dataformat<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jackson-dataformat-xml<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.9.10<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h4 id="3-5-2-ÈÖçÁΩÆÊ∂àÊÅØËΩ¨Êç¢Âô®"><a href="#3-5-2-ÈÖçÁΩÆÊ∂àÊÅØËΩ¨Êç¢Âô®" class="headerlink" title="3.5.2 ÈÖçÁΩÆÊ∂àÊÅØËΩ¨Êç¢Âô®"></a>3.5.2 ÈÖçÁΩÆÊ∂àÊÅØËΩ¨Êç¢Âô®</h4><p>Âú®publisherÂíåconsumer‰∏§‰∏™ÊúçÂä°ÁöÑÂêØÂä®Á±ª‰∏≠Ê∑ªÂä†‰∏Ä‰∏™BeanÂç≥ÂèØÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-keyword">public</span> MessageConverter <span class="hljs-title function_">messageConverter</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-comment">// 1.ÂÆö‰πâÊ∂àÊÅØËΩ¨Êç¢Âô®</span><br>    <span class="hljs-type">Jackson2JsonMessageConverter</span> <span class="hljs-variable">jackson2JsonMessageConverter</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jackson2JsonMessageConverter</span>();<br>    <span class="hljs-comment">// 2.ÈÖçÁΩÆËá™Âä®ÂàõÂª∫Ê∂àÊÅØidÔºåÁî®‰∫éËØÜÂà´‰∏çÂêåÊ∂àÊÅØÔºå‰πüÂèØ‰ª•Âú®‰∏öÂä°‰∏≠Âü∫‰∫éIDÂà§Êñ≠ÊòØÂê¶ÊòØÈáçÂ§çÊ∂àÊÅØ</span><br>    jackson2JsonMessageConverter.setCreateMessageIds(<span class="hljs-literal">true</span>);<br>    <span class="hljs-keyword">return</span> jackson2JsonMessageConverter;<br>&#125;<br></code></pre></td></tr></table></figure>


<h4 id="3-5-3-Êé•Êî∂Ê∂àÊÅØ"><a href="#3-5-3-Êé•Êî∂Ê∂àÊÅØ" class="headerlink" title="3.5.3 Êé•Êî∂Ê∂àÊÅØ"></a>3.5.3 Êé•Êî∂Ê∂àÊÅØ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RabbitListener(queues = &quot;object.queue&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">listenSimpleQueueMessage</span><span class="hljs-params">(Map&lt;String, Object&gt; msg)</span> <span class="hljs-keyword">throws</span> InterruptedException &#123;<br>    System.out.println(<span class="hljs-string">&quot;Ê∂àË¥πËÄÖÊé•Êî∂Âà∞object.queueÊ∂àÊÅØÔºö„Äê&quot;</span> + msg + <span class="hljs-string">&quot;„Äë&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="4-MQÊ∂àÊÅØÁöÑÂèØÈù†ÊÄß"><a href="#4-MQÊ∂àÊÅØÁöÑÂèØÈù†ÊÄß" class="headerlink" title="4. MQÊ∂àÊÅØÁöÑÂèØÈù†ÊÄß"></a>4. MQÊ∂àÊÅØÁöÑÂèØÈù†ÊÄß</h2><p>Âú®ÂæÆÊúçÂä°Êû∂ÊûÑ‰∏≠ÔºåÊ∂àÊÅØÈòüÂàóÔºàMQÔºâÁöÑÂèØÈù†ÊÄßÊåáÁöÑÊòØ<strong>Ê∂àÊÅØÂú®Áîü‰∫ß„ÄÅ‰º†ËæìÂíåÊ∂àË¥πÁöÑËøáÁ®ã‰∏≠‰∏ç‰ºö‰∏¢Â§±„ÄÅ‰∏ç‰ºöÈáçÂ§ç„ÄÅ‰∏çË¢´ÁØ°ÊîπÔºåÂπ∂‰∏îËÉΩÂ§üÊåâÈ¢ÑÊúüË¢´Ê≠£Á°ÆÊ∂àË¥π</strong>„ÄÇÁ°Æ‰øù MQ ÂèØÈù†ÊÄßÂØπ‰∫é‰øùËØÅ‰∏öÂä°Êï∞ÊçÆ‰∏ÄËá¥ÊÄß„ÄÅÊèêÈ´òÁ≥ªÁªüÁ®≥ÂÆöÊÄßËá≥ÂÖ≥ÈáçË¶Å„ÄÇ</p>
<p>Ê∂àÊÅØ‰ªéÁîü‰∫ßËÄÖÂà∞Ê∂àË¥πËÄÖÁöÑÊØè‰∏ÄÊ≠•ÈÉΩÂèØËÉΩÂØºËá¥Ê∂àÊÅØ‰∏¢Â§±Ôºö</p>
<ul>
<li><strong>ÂèëÈÄÅÊ∂àÊÅØÊó∂‰∏¢Â§±</strong>Ôºö<ul>
<li>Áîü‰∫ßËÄÖÂèëÈÄÅÊ∂àÊÅØÊó∂ËøûÊé•MQÂ§±Ë¥•</li>
<li>Áîü‰∫ßËÄÖÂèëÈÄÅÊ∂àÊÅØÂà∞ËææMQÂêéÊú™ÊâæÂà∞Exchange</li>
<li>Áîü‰∫ßËÄÖÂèëÈÄÅÊ∂àÊÅØÂà∞ËææMQÁöÑExchangeÂêéÔºåÊú™ÊâæÂà∞ÂêàÈÄÇÁöÑQueue</li>
<li>Ê∂àÊÅØÂà∞ËææMQÂêéÔºåÂ§ÑÁêÜÊ∂àÊÅØÁöÑËøõÁ®ãÂèëÁîüÂºÇÂ∏∏</li>
</ul>
</li>
<li><strong>MQÂØºËá¥Ê∂àÊÅØ‰∏¢Â§±</strong>Ôºö<ul>
<li>Ê∂àÊÅØÂà∞ËææMQÔºå‰øùÂ≠òÂà∞ÈòüÂàóÂêéÔºåÂ∞öÊú™Ê∂àË¥πÂ∞±Á™ÅÁÑ∂ÂÆïÊú∫</li>
</ul>
</li>
<li><strong>Ê∂àË¥πËÄÖÂ§ÑÁêÜÊ∂àÊÅØÊó∂</strong>Ôºö<ul>
<li>Ê∂àÊÅØÊé•Êî∂ÂêéÂ∞öÊú™Â§ÑÁêÜÁ™ÅÁÑ∂ÂÆïÊú∫</li>
<li>Ê∂àÊÅØÊé•Êî∂ÂêéÂ§ÑÁêÜËøáÁ®ã‰∏≠ÊäõÂá∫ÂºÇÂ∏∏</li>
</ul>
</li>
</ul>
<h3 id="4-1-ÂèëÈÄÅËÄÖÁöÑÂèØÈù†ÊÄß"><a href="#4-1-ÂèëÈÄÅËÄÖÁöÑÂèØÈù†ÊÄß" class="headerlink" title="4.1 ÂèëÈÄÅËÄÖÁöÑÂèØÈù†ÊÄß"></a>4.1 ÂèëÈÄÅËÄÖÁöÑÂèØÈù†ÊÄß</h3><h4 id="4-1-1-Áîü‰∫ßËÄÖÈáçËØïÊú∫Âà∂"><a href="#4-1-1-Áîü‰∫ßËÄÖÈáçËØïÊú∫Âà∂" class="headerlink" title="4.1.1 Áîü‰∫ßËÄÖÈáçËØïÊú∫Âà∂"></a>4.1.1 Áîü‰∫ßËÄÖÈáçËØïÊú∫Âà∂</h4><p>Áîü‰∫ßËÄÖÂèëÈÄÅÊ∂àÊÅØÊó∂ÔºåÂá∫Áé∞‰∫ÜÁΩëÁªúÊïÖÈöúÔºåÂØºËá¥‰∏éMQÁöÑËøûÊé•‰∏≠Êñ≠„ÄÇ<br>‰∏∫‰∫ÜËß£ÂÜ≥Ëøô‰∏™ÈóÆÈ¢òÔºåSpringAMQPÊèê‰æõÁöÑÊ∂àÊÅØÂèëÈÄÅÊó∂ÁöÑ<strong>ÈáçËØïÊú∫Âà∂„ÄÇÂç≥ÔºöÂΩìRabbitTemplate‰∏éMQËøûÊé•Ë∂ÖÊó∂ÂêéÔºåÂ§öÊ¨°ÈáçËØï</strong>„ÄÇ</p>
<p>‰øÆÊîπpublisherÊ®°ÂùóÁöÑapplication.yamlÊñá‰ª∂ÔºåÊ∑ªÂä†‰∏ãÈù¢ÁöÑÂÜÖÂÆπÔºö</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">rabbitmq:</span><br>    <span class="hljs-attr">connection-timeout:</span> <span class="hljs-string">1s</span> <span class="hljs-comment"># ËÆæÁΩÆMQÁöÑËøûÊé•Ë∂ÖÊó∂Êó∂Èó¥</span><br>    <span class="hljs-attr">template:</span><br>      <span class="hljs-attr">retry:</span><br>        <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># ÂºÄÂêØË∂ÖÊó∂ÈáçËØïÊú∫Âà∂</span><br>        <span class="hljs-attr">initial-interval:</span> <span class="hljs-string">1000ms</span> <span class="hljs-comment"># Â§±Ë¥•ÂêéÁöÑÂàùÂßãÁ≠âÂæÖÊó∂Èó¥</span><br>        <span class="hljs-attr">multiplier:</span> <span class="hljs-number">1</span> <span class="hljs-comment"># Â§±Ë¥•Âêé‰∏ãÊ¨°ÁöÑÁ≠âÂæÖÊó∂ÈïøÂÄçÊï∞Ôºå‰∏ãÊ¨°Á≠âÂæÖÊó∂Èïø = initial-interval * multiplier</span><br>        <span class="hljs-attr">max-attempts:</span> <span class="hljs-number">3</span> <span class="hljs-comment"># ÊúÄÂ§ßÈáçËØïÊ¨°Êï∞</span><br></code></pre></td></tr></table></figure>

<p>Ê≥®ÊÑèÔºöÂΩìÁΩëÁªú‰∏çÁ®≥ÂÆöÁöÑÊó∂ÂÄôÔºåÂà©Áî®ÈáçËØïÊú∫Âà∂ÂèØ‰ª•ÊúâÊïàÊèêÈ´òÊ∂àÊÅØÂèëÈÄÅÁöÑÊàêÂäüÁéá„ÄÇ‰∏çËøáSpringAMQPÊèê‰æõÁöÑ<strong>ÈáçËØïÊú∫Âà∂ÊòØÈòªÂ°ûÂºèÁöÑÈáçËØï</strong>Ôºå‰πüÂ∞±ÊòØËØ¥Â§öÊ¨°ÈáçËØïÁ≠âÂæÖÁöÑËøáÁ®ã‰∏≠ÔºåÂΩìÂâçÁ∫øÁ®ãÊòØË¢´ÈòªÂ°ûÁöÑ„ÄÇ<br>Â¶ÇÊûúÂØπ‰∫é‰∏öÂä°ÊÄßËÉΩÊúâË¶ÅÊ±ÇÔºåÂª∫ËÆÆÁ¶ÅÁî®ÈáçËØïÊú∫Âà∂„ÄÇÂ¶ÇÊûú‰∏ÄÂÆöË¶Å‰ΩøÁî®ÔºåËØ∑ÂêàÁêÜÈÖçÁΩÆÁ≠âÂæÖÊó∂ÈïøÂíåÈáçËØïÊ¨°Êï∞ÔºåÂΩìÁÑ∂‰πüÂèØ‰ª•ËÄÉËôë‰ΩøÁî®ÂºÇÊ≠•Á∫øÁ®ãÊù•ÊâßË°åÂèëÈÄÅÊ∂àÊÅØÁöÑ‰ª£Á†Å„ÄÇ</p>
<h4 id="4-1-2-Áîü‰∫ßËÄÖÁ°ÆËÆ§Êú∫Âà∂-‰∏ÄËà¨ÊÉÖÂÜµ‰∏ã‰∏çÂª∫ËÆÆÂºÄÂêØ"><a href="#4-1-2-Áîü‰∫ßËÄÖÁ°ÆËÆ§Êú∫Âà∂-‰∏ÄËà¨ÊÉÖÂÜµ‰∏ã‰∏çÂª∫ËÆÆÂºÄÂêØ" class="headerlink" title="4.1.2 Áîü‰∫ßËÄÖÁ°ÆËÆ§Êú∫Âà∂(‰∏ÄËà¨ÊÉÖÂÜµ‰∏ã‰∏çÂª∫ËÆÆÂºÄÂêØ)"></a>4.1.2 Áîü‰∫ßËÄÖÁ°ÆËÆ§Êú∫Âà∂(‰∏ÄËà¨ÊÉÖÂÜµ‰∏ã‰∏çÂª∫ËÆÆÂºÄÂêØ)</h4><p>RabbitMQÊèê‰æõ‰∫ÜÁîü‰∫ßËÄÖÊ∂àÊÅØÁ°ÆËÆ§Êú∫Âà∂ÔºåÂåÖÊã¨Publisher ConfirmÂíåPublisher Return‰∏§Áßç„ÄÇÂú®ÂºÄÂêØÁ°ÆËÆ§Êú∫Âà∂ÁöÑÊÉÖÂÜµ‰∏ãÔºåÂΩìÁîü‰∫ßËÄÖÂèëÈÄÅÊ∂àÊÅØÁªôMQÂêéÔºåMQ‰ºöÊ†πÊçÆÊ∂àÊÅØÂ§ÑÁêÜÁöÑÊÉÖÂÜµËøîÂõû‰∏çÂêåÁöÑÂõûÊâß„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/mq.9.png" srcset="/img/loading.gif" lazyload></p>
<p>ÊÄªÁªìÔºö</p>
<ul>
<li>ÂΩìÊ∂àÊÅØÊäïÈÄíÂà∞MQÔºå‰ΩÜÊòØË∑ØÁî±Â§±Ë¥•Êó∂ÔºåÈÄöËøáPublisher ReturnËøîÂõûÂºÇÂ∏∏‰ø°ÊÅØÔºåÂêåÊó∂ËøîÂõûackÁöÑÁ°ÆËÆ§‰ø°ÊÅØÔºå‰ª£Ë°®ÊäïÈÄíÊàêÂäü</li>
<li>‰∏¥Êó∂Ê∂àÊÅØÊäïÈÄíÂà∞‰∫ÜMQÔºåÂπ∂‰∏îÂÖ•ÈòüÊàêÂäüÔºåËøîÂõûACKÔºåÂëäÁü•ÊäïÈÄíÊàêÂäü</li>
<li>ÊåÅ‰πÖÊ∂àÊÅØÊäïÈÄíÂà∞‰∫ÜMQÔºåÂπ∂‰∏îÂÖ•ÈòüÂÆåÊàêÊåÅ‰πÖÂåñÔºåËøîÂõûACK ÔºåÂëäÁü•ÊäïÈÄíÊàêÂäü</li>
<li>ÂÖ∂ÂÆÉÊÉÖÂÜµÈÉΩ‰ºöËøîÂõûNACKÔºåÂëäÁü•ÊäïÈÄíÂ§±Ë¥•</li>
</ul>
<h5 id="4-1-2-1-ÂºÄÂêØÁîü‰∫ßËÄÖÁ°ÆËÆ§"><a href="#4-1-2-1-ÂºÄÂêØÁîü‰∫ßËÄÖÁ°ÆËÆ§" class="headerlink" title="4.1.2.1 ÂºÄÂêØÁîü‰∫ßËÄÖÁ°ÆËÆ§"></a>4.1.2.1 ÂºÄÂêØÁîü‰∫ßËÄÖÁ°ÆËÆ§</h5><p>Âú®publisherÊ®°ÂùóÁöÑapplication.yaml‰∏≠Ê∑ªÂä†ÈÖçÁΩÆÔºö</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">rabbitmq:</span><br>    <span class="hljs-attr">publisher-confirm-type:</span> <span class="hljs-string">correlated</span> <span class="hljs-comment"># ÂºÄÂêØpublisher confirmÊú∫Âà∂ÔºåÂπ∂ËÆæÁΩÆconfirmÁ±ªÂûã</span><br>    <span class="hljs-attr">publisher-returns:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># ÂºÄÂêØpublisher returnÊú∫Âà∂</span><br></code></pre></td></tr></table></figure>

<p>ËøôÈáåpublisher-confirm-typeÊúâ‰∏âÁßçÊ®°ÂºèÂèØÈÄâÔºö</p>
<ul>
<li>noneÔºöÂÖ≥Èó≠confirmÊú∫Âà∂</li>
<li>simpleÔºöÂêåÊ≠•ÈòªÂ°ûÁ≠âÂæÖMQÁöÑÂõûÊâß</li>
<li>correlatedÔºöMQÂºÇÊ≠•ÂõûË∞ÉËøîÂõûÂõûÊâß(Êé®Ëçê)</li>
</ul>
<h5 id="4-1-2-2-ÂÆö‰πâReturnCallback"><a href="#4-1-2-2-ÂÆö‰πâReturnCallback" class="headerlink" title="4.1.2.2 ÂÆö‰πâReturnCallback"></a>4.1.2.2 ÂÆö‰πâReturnCallback</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Slf4j</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MqConfig</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> RabbitTemplate rabbitTemplate;<br><br>    <span class="hljs-meta">@PostConstruct</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">init</span><span class="hljs-params">()</span>&#123;<br>        rabbitTemplate.setReturnsCallback(<span class="hljs-keyword">new</span> <span class="hljs-title class_">RabbitTemplate</span>.ReturnsCallback() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">returnedMessage</span><span class="hljs-params">(ReturnedMessage returned)</span> &#123;<br>                log.error(<span class="hljs-string">&quot;Ëß¶Âèëreturn callback,&quot;</span>);<br>                log.debug(<span class="hljs-string">&quot;exchange: &#123;&#125;&quot;</span>, returned.getExchange());<br>                log.debug(<span class="hljs-string">&quot;routingKey: &#123;&#125;&quot;</span>, returned.getRoutingKey());<br>                log.debug(<span class="hljs-string">&quot;message: &#123;&#125;&quot;</span>, returned.getMessage());<br>                log.debug(<span class="hljs-string">&quot;replyCode: &#123;&#125;&quot;</span>, returned.getReplyCode());<br>                log.debug(<span class="hljs-string">&quot;replyText: &#123;&#125;&quot;</span>, returned.getReplyText());<br>            &#125;<br>        &#125;);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h5 id="4-1-2-3-ÂÆö‰πâConfirmCallback"><a href="#4-1-2-3-ÂÆö‰πâConfirmCallback" class="headerlink" title="4.1.2.3 ÂÆö‰πâConfirmCallback"></a>4.1.2.3 ÂÆö‰πâConfirmCallback</h5><p>CorrelationData‰∏≠ÂåÖÂê´‰∏§‰∏™Ê†∏ÂøÉÁöÑ‰∏úË•øÔºö</p>
<ul>
<li>idÔºöÊ∂àÊÅØÁöÑÂîØ‰∏ÄÊ†áÁ§∫ÔºåMQÂØπ‰∏çÂêåÁöÑÊ∂àÊÅØÁöÑÂõûÊâß‰ª•Ê≠§ÂÅöÂà§Êñ≠ÔºåÈÅøÂÖçÊ∑∑Ê∑Ü</li>
<li>SettableListenableFutureÔºöÂõûÊâßÁªìÊûúÁöÑFutureÂØπË±°</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testPublisherConfirm</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// 1.ÂàõÂª∫CorrelationData</span><br>    <span class="hljs-type">CorrelationData</span> <span class="hljs-variable">cd</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CorrelationData</span>();<br>    <span class="hljs-comment">// 2.ÁªôFutureÊ∑ªÂä†ConfirmCallback</span><br>    cd.getFuture().addCallback(<span class="hljs-keyword">new</span> <span class="hljs-title class_">ListenableFutureCallback</span>&lt;CorrelationData.Confirm&gt;() &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onFailure</span><span class="hljs-params">(Throwable ex)</span> &#123;<br>            <span class="hljs-comment">// 2.1.FutureÂèëÁîüÂºÇÂ∏∏Êó∂ÁöÑÂ§ÑÁêÜÈÄªËæëÔºåÂü∫Êú¨‰∏ç‰ºöËß¶Âèë</span><br>            log.error(<span class="hljs-string">&quot;send message fail&quot;</span>, ex);<br>        &#125;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onSuccess</span><span class="hljs-params">(CorrelationData.Confirm result)</span> &#123;<br>            <span class="hljs-comment">// 2.2.FutureÊé•Êî∂Âà∞ÂõûÊâßÁöÑÂ§ÑÁêÜÈÄªËæëÔºåÂèÇÊï∞‰∏≠ÁöÑresultÂ∞±ÊòØÂõûÊâßÂÜÖÂÆπ</span><br>            <span class="hljs-keyword">if</span>(result.isAck())&#123; <span class="hljs-comment">// result.isAck()ÔºåbooleanÁ±ªÂûãÔºåtrue‰ª£Ë°®ackÂõûÊâßÔºåfalse ‰ª£Ë°® nackÂõûÊâß</span><br>                log.debug(<span class="hljs-string">&quot;ÂèëÈÄÅÊ∂àÊÅØÊàêÂäüÔºåÊî∂Âà∞ ack!&quot;</span>);<br>            &#125;<span class="hljs-keyword">else</span>&#123; <span class="hljs-comment">// result.getReason()ÔºåStringÁ±ªÂûãÔºåËøîÂõûnackÊó∂ÁöÑÂºÇÂ∏∏ÊèèËø∞</span><br>                log.error(<span class="hljs-string">&quot;ÂèëÈÄÅÊ∂àÊÅØÂ§±Ë¥•ÔºåÊî∂Âà∞ nack, reason : &#123;&#125;&quot;</span>, result.getReason());<br>            &#125;<br>        &#125;<br>    &#125;);<br>    <span class="hljs-comment">// 3.ÂèëÈÄÅÊ∂àÊÅØ</span><br>    rabbitTemplate.convertAndSend(<span class="hljs-string">&quot;hmall.direct&quot;</span>, <span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;hello&quot;</span>, cd);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="4-2-MQÁöÑÂèØÈù†ÊÄß"><a href="#4-2-MQÁöÑÂèØÈù†ÊÄß" class="headerlink" title="4.2 MQÁöÑÂèØÈù†ÊÄß"></a>4.2 MQÁöÑÂèØÈù†ÊÄß</h3><p>Ê∂àÊÅØÂà∞ËææMQ‰ª•ÂêéÔºåÂõ†‰∏∫<strong>MQÊòØÂü∫‰∫éÂÜÖÂ≠òÂ≠òÂÇ®ÁöÑÔºåÂ¶ÇÊûúÂÜÖÂ≠òÁ©∫Èó¥Ë¢´Ê∂àÊÅØÂç†Êª°ÔºåÂ¶ÇÊûúMQ‰∏çËÉΩÂèäÊó∂‰øùÂ≠òÔºå‰πü‰ºöÂØºËá¥Ê∂àÊÅØ‰∏¢Â§±</strong><br>Êúâ‰∏§ÁßçËß£ÂÜ≥ÊñπÊ≥ïÔºö</p>
<ul>
<li>Êï∞ÊçÆÊåÅ‰πÖÂåñ</li>
<li>LazyQueue(Êé®Ëçê)</li>
</ul>
<h4 id="4-2-1-Êï∞ÊçÆÊåÅ‰πÖÂåñ"><a href="#4-2-1-Êï∞ÊçÆÊåÅ‰πÖÂåñ" class="headerlink" title="4.2.1 Êï∞ÊçÆÊåÅ‰πÖÂåñ"></a>4.2.1 Êï∞ÊçÆÊåÅ‰πÖÂåñ</h4><p>‰∏∫‰∫ÜÊèêÂçáÊÄßËÉΩÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ãMQÁöÑÊï∞ÊçÆÈÉΩÊòØÂú®ÂÜÖÂ≠òÂ≠òÂÇ®ÁöÑ‰∏¥Êó∂Êï∞ÊçÆÔºåÈáçÂêØÂêéÂ∞±‰ºöÊ∂àÂ§±„ÄÇ‰∏∫‰∫Ü‰øùËØÅÊï∞ÊçÆÁöÑÂèØÈù†ÊÄßÔºåÂøÖÈ°ªÈÖçÁΩÆÊï∞ÊçÆÊåÅ‰πÖÂåñÔºåÂåÖÊã¨Ôºö</p>
<ul>
<li><strong>‰∫§Êç¢Êú∫ÊåÅ‰πÖÂåñ</strong></li>
<li><strong>ÈòüÂàóÊåÅ‰πÖÂåñ</strong></li>
<li><strong>Ê∂àÊÅØÊåÅ‰πÖÂåñ</strong></li>
</ul>
<p>Âú®ÊéßÂà∂Âè∞ÈÖçÁΩÆÁõ∏ÂÖ≥ÁöÑÊåÅ‰πÖÂåñÊ®°ÂºèÔºåÂç≥ÂèØÂºÄÂêØÊï∞ÊçÆÊåÅ‰πÖÂåñ</p>
<h4 id="4-2-2-LazyQueueÊÉ∞ÊÄßÈòüÂàó"><a href="#4-2-2-LazyQueueÊÉ∞ÊÄßÈòüÂàó" class="headerlink" title="4.2.2 LazyQueueÊÉ∞ÊÄßÈòüÂàó"></a>4.2.2 LazyQueueÊÉ∞ÊÄßÈòüÂàó</h4><p>‰ªéRabbitMQÁöÑ3.6.0ÁâàÊú¨ÂºÄÂßãÔºåÂ∞±Â¢ûÂä†‰∫ÜLazy QueuesÁöÑÊ®°ÂºèÔºå‰πüÂ∞±ÊòØÊÉ∞ÊÄßÈòüÂàó„ÄÇÊÉ∞ÊÄßÈòüÂàóÁöÑÁâπÂæÅÂ¶Ç‰∏ãÔºö</p>
<ul>
<li><strong>Êé•Êî∂Âà∞Ê∂àÊÅØÂêéÁõ¥Êé•Â≠òÂÖ•Á£ÅÁõòËÄåÈùûÂÜÖÂ≠ò</strong></li>
<li>Ê∂àË¥πËÄÖË¶Å<strong>Ê∂àË¥πÊ∂àÊÅØÊó∂Êâç‰ºö‰ªéÁ£ÅÁõò‰∏≠ËØªÂèñÂπ∂Âä†ËΩΩÂà∞ÂÜÖÂ≠ò</strong>Ôºà‰πüÂ∞±ÊòØÊáíÂä†ËΩΩÔºâ</li>
<li>ÊîØÊåÅÊï∞Áôæ‰∏áÊù°ÁöÑÊ∂àÊÅØÂ≠òÂÇ®</li>
</ul>
<p>ËÄåÂú®3.12ÁâàÊú¨‰πãÂêéÔºåLazyQueueÂ∑≤ÁªèÊàê‰∏∫ÊâÄÊúâÈòüÂàóÁöÑÈªòËÆ§Ê†ºÂºè„ÄÇÂõ†Ê≠§ÂÆòÊñπÊé®ËçêÂçáÁ∫ßMQ‰∏∫3.12ÁâàÊú¨ÊàñËÄÖÊâÄÊúâÈòüÂàóÈÉΩËÆæÁΩÆ‰∏∫LazyQueueÊ®°Âºè„ÄÇ</p>
<h3 id="4-3-Ê∂àË¥πËÄÖÁöÑÂèØÈù†ÊÄß"><a href="#4-3-Ê∂àË¥πËÄÖÁöÑÂèØÈù†ÊÄß" class="headerlink" title="4.3 Ê∂àË¥πËÄÖÁöÑÂèØÈù†ÊÄß"></a>4.3 Ê∂àË¥πËÄÖÁöÑÂèØÈù†ÊÄß</h3><p>Ê∂àÊÅØÊäïÈÄíÁªôÊ∂àË¥πËÄÖÂπ∂‰∏ç‰ª£Ë°®Â∞±‰∏ÄÂÆöË¢´Ê≠£Á°ÆÊ∂àË¥π‰∫ÜÔºåÂèØËÉΩÂá∫Áé∞ÁöÑÊïÖÈöúÊúâÂæàÂ§öÔºåÊØîÂ¶ÇÔºö</p>
<ul>
<li>Ê∂àÊÅØÊäïÈÄíÁöÑËøáÁ®ã‰∏≠Âá∫Áé∞‰∫Ü<strong>ÁΩëÁªúÊïÖÈöú</strong></li>
<li><strong>Ê∂àË¥πËÄÖ</strong>Êé•Êî∂Âà∞Ê∂àÊÅØÂêéÁ™ÅÁÑ∂<strong>ÂÆïÊú∫</strong></li>
<li>Ê∂àË¥πËÄÖÊé•Êî∂Âà∞Ê∂àÊÅØÂêéÔºå<strong>Âõ†Â§ÑÁêÜ‰∏çÂΩìÂØºËá¥ÂºÇÂ∏∏</strong></li>
</ul>
<h4 id="4-3-1-Ê∂àË¥πËÄÖÁ°ÆËÆ§Êú∫Âà∂"><a href="#4-3-1-Ê∂àË¥πËÄÖÁ°ÆËÆ§Êú∫Âà∂" class="headerlink" title="4.3.1 Ê∂àË¥πËÄÖÁ°ÆËÆ§Êú∫Âà∂"></a>4.3.1 Ê∂àË¥πËÄÖÁ°ÆËÆ§Êú∫Âà∂</h4><p>Ê∂àË¥πËÄÖÂ§ÑÁêÜÊ∂àÊÅØÁªìÊùüÂêéÔºåÂ∫îËØ•ÂêëRabbitMQÂèëÈÄÅ‰∏Ä‰∏™ÂõûÊâßÔºåÂëäÁü•RabbitMQËá™Â∑±Ê∂àÊÅØÂ§ÑÁêÜÁä∂ÊÄÅ„ÄÇÂõûÊâßÊúâ‰∏âÁßçÂèØÈÄâÂÄºÔºö</p>
<ul>
<li>ackÔºö<strong>ÊàêÂäüÂ§ÑÁêÜÊ∂àÊÅØ</strong>ÔºåRabbitMQ<strong>‰ªéÈòüÂàó‰∏≠Âà†Èô§ËØ•Ê∂àÊÅØ</strong></li>
<li>nackÔºö<strong>Ê∂àÊÅØÂ§ÑÁêÜÂ§±Ë¥•</strong>ÔºåRabbitMQÈúÄË¶Å<strong>ÂÜçÊ¨°ÊäïÈÄíÊ∂àÊÅØ</strong></li>
<li>rejectÔºöÊ∂àÊÅØÂ§ÑÁêÜÂ§±Ë¥•Âπ∂ÊãíÁªùËØ•Ê∂àÊÅØÔºåRabbitMQ‰ªéÈòüÂàó‰∏≠Âà†Èô§ËØ•Ê∂àÊÅØ</li>
</ul>
<p><img src="/img/blogs/java/springcloud/mq.10.png" srcset="/img/loading.gif" lazyload></p>
<p>SpringAMQPÂ∏ÆÊàë‰ª¨ÂÆûÁé∞‰∫ÜÊ∂àÊÅØÁ°ÆËÆ§„ÄÇÂπ∂ÂÖÅËÆ∏Êàë‰ª¨ÈÄöËøáÈÖçÁΩÆÊñá‰ª∂ËÆæÁΩÆACKÂ§ÑÁêÜÊñπÂºèÔºåÊúâ‰∏âÁßçÊ®°ÂºèÔºö</p>
<ul>
<li>noneÔºö‰∏çÂ§ÑÁêÜ„ÄÇÂç≥Ê∂àÊÅØÊäïÈÄíÁªôÊ∂àË¥πËÄÖÂêéÁ´ãÂàªackÔºåÊ∂àÊÅØ‰ºöÁ´ãÂàª‰ªéMQÂà†Èô§„ÄÇÈùûÂ∏∏‰∏çÂÆâÂÖ®Ôºå‰∏çÂª∫ËÆÆ‰ΩøÁî®</li>
<li>manualÔºöÊâãÂä®Ê®°Âºè„ÄÇÈúÄË¶ÅËá™Â∑±Âú®‰∏öÂä°‰ª£Á†Å‰∏≠Ë∞ÉÁî®apiÔºåÂèëÈÄÅackÊàñrejectÔºåÂ≠òÂú®‰∏öÂä°ÂÖ•‰æµÔºå‰ΩÜÊõ¥ÁÅµÊ¥ª</li>
<li>autoÔºöËá™Âä®Ê®°Âºè„ÄÇSpringAMQPÂà©Áî®AOPÂØπÊàë‰ª¨ÁöÑÊ∂àÊÅØÂ§ÑÁêÜÈÄªËæëÂÅö‰∫ÜÁéØÁªïÂ¢ûÂº∫ÔºåÂΩì‰∏öÂä°Ê≠£Â∏∏ÊâßË°åÊó∂ÂàôËá™Âä®ËøîÂõûack.  ÂΩì‰∏öÂä°Âá∫Áé∞ÂºÇÂ∏∏Êó∂ÔºåÊ†πÊçÆÂºÇÂ∏∏Âà§Êñ≠ËøîÂõû‰∏çÂêåÁªìÊûúÔºö<ul>
<li>Â¶ÇÊûúÊòØ‰∏öÂä°ÂºÇÂ∏∏Ôºå‰ºöËá™Âä®ËøîÂõûnackÔºõ</li>
<li>Â¶ÇÊûúÊòØÊ∂àÊÅØÂ§ÑÁêÜÊàñÊ†°È™åÂºÇÂ∏∏ÔºåËá™Âä®ËøîÂõûreject;</li>
</ul>
</li>
</ul>
<p>‰øÆÊîπSpringAMQPÁöÑACKÂ§ÑÁêÜÊñπÂºè:</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">rabbitmq:</span><br>    <span class="hljs-attr">listener:</span><br>      <span class="hljs-attr">simple:</span><br>        <span class="hljs-attr">acknowledge-mode:</span> <span class="hljs-string">none</span> <span class="hljs-comment"># ‰∏çÂÅöÂ§ÑÁêÜ</span><br></code></pre></td></tr></table></figure>

<h4 id="4-3-2-Â§±Ë¥•ÈáçËØïÊú∫Âà∂"><a href="#4-3-2-Â§±Ë¥•ÈáçËØïÊú∫Âà∂" class="headerlink" title="4.3.2 Â§±Ë¥•ÈáçËØïÊú∫Âà∂"></a>4.3.2 Â§±Ë¥•ÈáçËØïÊú∫Âà∂</h4><p>ÂΩìÊ∂àË¥πËÄÖÂá∫Áé∞ÂºÇÂ∏∏ÂêéÔºåÊ∂àÊÅØ‰ºö‰∏çÊñ≠requeueÔºàÈáçÂÖ•ÈòüÔºâÂà∞ÈòüÂàóÔºåÂÜçÈáçÊñ∞ÂèëÈÄÅÁªôÊ∂àË¥πËÄÖ„ÄÇÂ¶ÇÊûúÊ∂àË¥πËÄÖÂÜçÊ¨°ÊâßË°å‰æùÁÑ∂Âá∫ÈîôÔºåÊ∂àÊÅØ‰ºöÂÜçÊ¨°requeueÂà∞ÈòüÂàóÔºåÂÜçÊ¨°ÊäïÈÄíÔºåÁõ¥Âà∞Ê∂àÊÅØÂ§ÑÁêÜÊàêÂäü‰∏∫Ê≠¢„ÄÇ<br>ÊûÅÁ´ØÊÉÖÂÜµÂ∞±ÊòØÊ∂àË¥πËÄÖ‰∏ÄÁõ¥Êó†Ê≥ïÊâßË°åÊàêÂäüÔºåÈÇ£‰πà<strong>Ê∂àÊÅØrequeueÂ∞±‰ºöÊó†ÈôêÂæ™ÁéØ</strong>ÔºåÂØºËá¥mqÁöÑÊ∂àÊÅØÂ§ÑÁêÜÈ£ôÂçáÔºåÂ∏¶Êù•‰∏çÂøÖË¶ÅÁöÑÂéãÂäõ„ÄÇ</p>
<p>‰øÆÊîπconsumerÊúçÂä°ÁöÑapplication.ymlÊñá‰ª∂Ôºö</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">rabbitmq:</span><br>    <span class="hljs-attr">listener:</span><br>      <span class="hljs-attr">simple:</span><br>        <span class="hljs-attr">retry:</span><br>          <span class="hljs-attr">enabled:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># ÂºÄÂêØÊ∂àË¥πËÄÖÂ§±Ë¥•ÈáçËØï</span><br>          <span class="hljs-attr">initial-interval:</span> <span class="hljs-string">1000ms</span> <span class="hljs-comment"># ÂàùËØÜÁöÑÂ§±Ë¥•Á≠âÂæÖÊó∂Èïø‰∏∫1Áßí</span><br>          <span class="hljs-attr">multiplier:</span> <span class="hljs-number">1</span> <span class="hljs-comment"># Â§±Ë¥•ÁöÑÁ≠âÂæÖÊó∂ÈïøÂÄçÊï∞Ôºå‰∏ãÊ¨°Á≠âÂæÖÊó∂Èïø = multiplier * last-interval</span><br>          <span class="hljs-attr">max-attempts:</span> <span class="hljs-number">3</span> <span class="hljs-comment"># ÊúÄÂ§ßÈáçËØïÊ¨°Êï∞</span><br>          <span class="hljs-attr">stateless:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># trueÊó†Áä∂ÊÄÅÔºõfalseÊúâÁä∂ÊÄÅ„ÄÇÂ¶ÇÊûú‰∏öÂä°‰∏≠ÂåÖÂê´‰∫ãÂä°ÔºåËøôÈáåÊîπ‰∏∫false</span><br></code></pre></td></tr></table></figure>

<ul>
<li><strong>ÈáçËØïËææÂà∞ÊúÄÂ§ßÊ¨°Êï∞ÂêéÔºåSpring‰ºöËøîÂõûrejectÔºåÊ∂àÊÅØ‰ºöË¢´‰∏¢ÂºÉ</strong></li>
</ul>
<h4 id="4-3-3-Â§±Ë¥•Â§ÑÁêÜÁ≠ñÁï•"><a href="#4-3-3-Â§±Ë¥•Â§ÑÁêÜÁ≠ñÁï•" class="headerlink" title="4.3.3 Â§±Ë¥•Â§ÑÁêÜÁ≠ñÁï•"></a>4.3.3 Â§±Ë¥•Â§ÑÁêÜÁ≠ñÁï•</h4><p>SpringÂÖÅËÆ∏Êàë‰ª¨Ëá™ÂÆö‰πâÈáçËØïÊ¨°Êï∞ËÄóÂ∞ΩÂêéÁöÑÊ∂àÊÅØÂ§ÑÁêÜÁ≠ñÁï•ÔºåËøô‰∏™Á≠ñÁï•ÊòØÁî±MessageRecoveryÊé•Âè£Êù•ÂÆö‰πâÁöÑÔºåÂÆÉÊúâ3‰∏™‰∏çÂêåÂÆûÁé∞Ôºö</p>
<ul>
<li>RejectAndDontRequeueRecovererÔºö<strong>ÈáçËØïËÄóÂ∞ΩÂêéÔºåÁõ¥Êé•rejectÔºå‰∏¢ÂºÉÊ∂àÊÅØ</strong>„ÄÇÈªòËÆ§Â∞±ÊòØËøôÁßçÊñπÂºè </li>
<li>ImmediateRequeueMessageRecovererÔºöÈáçËØïËÄóÂ∞ΩÂêéÔºåËøîÂõûnackÔºåÊ∂àÊÅØÈáçÊñ∞ÂÖ•Èòü </li>
<li>RepublishMessageRecovererÔºö<strong>ÈáçËØïËÄóÂ∞ΩÂêéÔºåÂ∞ÜÂ§±Ë¥•Ê∂àÊÅØÊäïÈÄíÂà∞ÊåáÂÆöÁöÑ‰∫§Êç¢Êú∫</strong> (Êé®Ëçê)</li>
</ul>
<ul>
<li>RepublishMessageRecoverer: Â§±Ë¥•ÂêéÂ∞ÜÊ∂àÊÅØÊäïÈÄíÂà∞‰∏Ä‰∏™ÊåáÂÆöÁöÑÔºå‰∏ìÈó®Â≠òÊîæÂºÇÂ∏∏Ê∂àÊÅØÁöÑÈòüÂàóÔºåÂêéÁª≠Áî±‰∫∫Â∑•ÈõÜ‰∏≠Â§ÑÁêÜ„ÄÇ</li>
</ul>
<p>Âú®consumerÊúçÂä°‰∏≠ÂÆö‰πâÂ§ÑÁêÜÂ§±Ë¥•Ê∂àÊÅØÁöÑ‰∫§Êç¢Êú∫ÂíåÈòüÂàó,ÂÆö‰πâ‰∏Ä‰∏™RepublishMessageRecovererÔºåÂÖ≥ËÅîÈòüÂàóÂíå‰∫§Êç¢Êú∫</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-meta">@ConditionalOnProperty(name = &quot;spring.rabbitmq.listener.simple.retry.enabled&quot;, havingValue = &quot;true&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ErrorMessageConfig</span> &#123;<br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> DirectExchange <span class="hljs-title function_">errorMessageExchange</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DirectExchange</span>(<span class="hljs-string">&quot;error.direct&quot;</span>);<br>    &#125;<br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> Queue <span class="hljs-title function_">errorQueue</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Queue</span>(<span class="hljs-string">&quot;error.queue&quot;</span>, <span class="hljs-literal">true</span>);<br>    &#125;<br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> Binding <span class="hljs-title function_">errorBinding</span><span class="hljs-params">(Queue errorQueue, DirectExchange errorMessageExchange)</span>&#123;<br>        <span class="hljs-keyword">return</span> BindingBuilder.bind(errorQueue).to(errorMessageExchange).with(<span class="hljs-string">&quot;error&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> MessageRecoverer <span class="hljs-title function_">republishMessageRecoverer</span><span class="hljs-params">(RabbitTemplate rabbitTemplate)</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RepublishMessageRecoverer</span>(rabbitTemplate, <span class="hljs-string">&quot;error.direct&quot;</span>, <span class="hljs-string">&quot;error&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="4-4-‰∏öÂä°ÂπÇÁ≠âÊÄß"><a href="#4-4-‰∏öÂä°ÂπÇÁ≠âÊÄß" class="headerlink" title="4.4 ‰∏öÂä°ÂπÇÁ≠âÊÄß"></a>4.4 ‰∏öÂä°ÂπÇÁ≠âÊÄß</h3><p>Âú®Á®ãÂ∫èÂºÄÂèë‰∏≠ÔºåÂàôÊòØÊåá<strong>Âêå‰∏Ä‰∏™‰∏öÂä°ÔºåÊâßË°å‰∏ÄÊ¨°ÊàñÂ§öÊ¨°ÂØπ‰∏öÂä°Áä∂ÊÄÅÁöÑÂΩ±ÂìçÊòØ‰∏ÄËá¥ÁöÑ</strong>„ÄÇ‰æãÂ¶ÇÔºö</p>
<ul>
<li>Ê†πÊçÆidÂà†Èô§Êï∞ÊçÆ</li>
<li>Êü•ËØ¢Êï∞ÊçÆ</li>
<li>Êñ∞Â¢ûÊï∞ÊçÆ</li>
</ul>
<p>Êï∞ÊçÆÁöÑÊõ¥Êñ∞ÂæÄÂæÄ‰∏çÊòØÂπÇÁ≠âÁöÑÔºåÂ¶ÇÊûú<strong>ÈáçÂ§çÊâßË°åÂèØËÉΩÈÄ†Êàê‰∏ç‰∏ÄÊ†∑ÁöÑÂêéÊûú</strong>„ÄÇÊØîÂ¶ÇÔºö</p>
<ul>
<li>ÂèñÊ∂àËÆ¢ÂçïÔºåÊÅ¢Â§çÂ∫ìÂ≠òÁöÑ‰∏öÂä°„ÄÇÂ¶ÇÊûúÂ§öÊ¨°ÊÅ¢Â§çÂ∞±‰ºöÂá∫Áé∞Â∫ìÂ≠òÈáçÂ§çÂ¢ûÂä†ÁöÑÊÉÖÂÜµ</li>
<li>ÈÄÄÊ¨æ‰∏öÂä°„ÄÇÈáçÂ§çÈÄÄÊ¨æÂØπÂïÜÂÆ∂ËÄåË®Ä‰ºöÊúâÁªèÊµéÊçüÂ§±„ÄÇ</li>
</ul>
<p>ÊâÄ‰ª•Ôºå<strong>Êàë‰ª¨Ë¶ÅÂ∞ΩÂèØËÉΩÈÅøÂÖç‰∏öÂä°Ë¢´ÈáçÂ§çÊâßË°å</strong>„ÄÇ</p>
<h4 id="4-4-1-ÂîØ‰∏ÄÊ∂àÊÅØID"><a href="#4-4-1-ÂîØ‰∏ÄÊ∂àÊÅØID" class="headerlink" title="4.4.1 ÂîØ‰∏ÄÊ∂àÊÅØID"></a>4.4.1 ÂîØ‰∏ÄÊ∂àÊÅØID</h4><ol>
<li>ÊØè‰∏ÄÊù°Ê∂àÊÅØÈÉΩÁîüÊàê‰∏Ä‰∏™ÂîØ‰∏ÄÁöÑidÔºå‰∏éÊ∂àÊÅØ‰∏ÄËµ∑ÊäïÈÄíÁªôÊ∂àË¥πËÄÖ„ÄÇ</li>
<li>Ê∂àË¥πËÄÖÊé•Êî∂Âà∞Ê∂àÊÅØÂêéÂ§ÑÁêÜËá™Â∑±ÁöÑ‰∏öÂä°Ôºå‰∏öÂä°Â§ÑÁêÜÊàêÂäüÂêéÂ∞ÜÊ∂àÊÅØID‰øùÂ≠òÂà∞Êï∞ÊçÆÂ∫ì</li>
<li><strong>Â¶ÇÊûú‰∏ãÊ¨°ÂèàÊî∂Âà∞Áõ∏ÂêåÊ∂àÊÅØÔºåÂéªÊï∞ÊçÆÂ∫ìÊü•ËØ¢Âà§Êñ≠ÊòØÂê¶Â≠òÂú®ÔºåÂ≠òÂú®Âàô‰∏∫ÈáçÂ§çÊ∂àÊÅØÊîæÂºÉÂ§ÑÁêÜ</strong>„ÄÇ</li>
</ol>
<p>SpringAMQPÁöÑMessageConverterËá™Â∏¶‰∫ÜMessageIDÁöÑÂäüËÉΩÔºåÊàë‰ª¨Âè™Ë¶ÅÂºÄÂêØËøô‰∏™ÂäüËÉΩÂç≥ÂèØ:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-keyword">public</span> MessageConverter <span class="hljs-title function_">messageConverter</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-comment">// 1.ÂÆö‰πâÊ∂àÊÅØËΩ¨Êç¢Âô®</span><br>    <span class="hljs-type">Jackson2JsonMessageConverter</span> <span class="hljs-variable">jjmc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Jackson2JsonMessageConverter</span>();<br>    <span class="hljs-comment">// 2.ÈÖçÁΩÆËá™Âä®ÂàõÂª∫Ê∂àÊÅØidÔºåÁî®‰∫éËØÜÂà´‰∏çÂêåÊ∂àÊÅØÔºå‰πüÂèØ‰ª•Âú®‰∏öÂä°‰∏≠Âü∫‰∫éIDÂà§Êñ≠ÊòØÂê¶ÊòØÈáçÂ§çÊ∂àÊÅØ</span><br>    jjmc.setCreateMessageIds(<span class="hljs-literal">true</span>);<br>    <span class="hljs-keyword">return</span> jjmc;<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="4-4-2-‰∏öÂä°Âà§Êñ≠"><a href="#4-4-2-‰∏öÂä°Âà§Êñ≠" class="headerlink" title="4.4.2 ‰∏öÂä°Âà§Êñ≠"></a>4.4.2 ‰∏öÂä°Âà§Êñ≠</h4><p>‰∏öÂä°Âà§Êñ≠Â∞±ÊòØÂü∫‰∫é‰∏öÂä°Êú¨Ë∫´ÁöÑÈÄªËæëÊàñÁä∂ÊÄÅÊù•Âà§Êñ≠ÊòØÂê¶ÊòØÈáçÂ§çÁöÑËØ∑Ê±ÇÊàñÊ∂àÊÅØ„ÄÇ<br>ÂΩìÂâçÊ°à‰æã‰∏≠ÔºåÂ§ÑÁêÜÊ∂àÊÅØÁöÑ‰∏öÂä°ÈÄªËæëÊòØÊääËÆ¢ÂçïÁä∂ÊÄÅ‰ªéÊú™ÊîØ‰ªò‰øÆÊîπ‰∏∫Â∑≤ÊîØ‰ªò„ÄÇÂõ†Ê≠§Êàë‰ª¨Â∞±ÂèØ‰ª•<strong>Âú®ÊâßË°å‰∏öÂä°Êó∂Âà§Êñ≠ËÆ¢ÂçïÁä∂ÊÄÅÊòØÂê¶ÊòØÊú™ÊîØ‰ªò</strong>ÔºåÂ¶ÇÊûú‰∏çÊòØÂàôËØÅÊòéËÆ¢ÂçïÂ∑≤ÁªèË¢´Â§ÑÁêÜËøáÔºåÊó†ÈúÄÈáçÂ§çÂ§ÑÁêÜ„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/mq.11.png" srcset="/img/loading.gif" lazyload></p>
<p>‰ª•ÊîØ‰ªò‰øÆÊîπËÆ¢ÂçïÁöÑ‰∏öÂä°‰∏∫‰æã:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">markOrderPaySuccess</span><span class="hljs-params">(Long orderId)</span> &#123;<br>    <span class="hljs-comment">// 1.Êü•ËØ¢ËÆ¢Âçï</span><br>    <span class="hljs-type">Order</span> <span class="hljs-variable">old</span> <span class="hljs-operator">=</span> getById(orderId);<br>    <span class="hljs-comment">// 2.Âà§Êñ≠ËÆ¢ÂçïÁä∂ÊÄÅ</span><br>    <span class="hljs-keyword">if</span> (old == <span class="hljs-literal">null</span> || old.getStatus() != <span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-comment">// ËÆ¢Âçï‰∏çÂ≠òÂú®ÊàñËÄÖËÆ¢ÂçïÁä∂ÊÄÅ‰∏çÊòØ1ÔºåÊîæÂºÉÂ§ÑÁêÜ</span><br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <span class="hljs-comment">// 3.Â∞ùËØïÊõ¥Êñ∞ËÆ¢Âçï</span><br>    <span class="hljs-type">Order</span> <span class="hljs-variable">order</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Order</span>();<br>    order.setId(orderId);<br>    order.setStatus(<span class="hljs-number">2</span>);<br>    order.setPayTime(LocalDateTime.now());<br>    updateById(order);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="4-5-ÂÖúÂ∫ïÊñπÊ°à"><a href="#4-5-ÂÖúÂ∫ïÊñπÊ°à" class="headerlink" title="4.5 ÂÖúÂ∫ïÊñπÊ°à"></a>4.5 ÂÖúÂ∫ïÊñπÊ°à</h3><p>ËôΩÁÑ∂Êàë‰ª¨Âà©Áî®ÂêÑÁßçÊú∫Âà∂Â∞ΩÂèØËÉΩÂ¢ûÂä†‰∫ÜÊ∂àÊÅØÁöÑÂèØÈù†ÊÄßÔºå‰ΩÜ‰πü‰∏çÂ•ΩËØ¥ËÉΩ‰øùËØÅÊ∂àÊÅØ100%ÁöÑÂèØÈù†„ÄÇ‰∏á‰∏ÄÁúüÁöÑMQÈÄöÁü•Â§±Ë¥•ËØ•ÊÄé‰πàÂäûÂë¢ÔºüÊúâÊ≤°ÊúâÂÖ∂ÂÆÉÂÖúÂ∫ïÊñπÊ°àÔºåËÉΩÂ§üÁ°Æ‰øùËÆ¢ÂçïÁöÑÊîØ‰ªòÁä∂ÊÄÅ‰∏ÄËá¥Âë¢Ôºü</p>
<p>Êó¢ÁÑ∂MQÈÄöÁü•‰∏ç‰∏ÄÂÆöÂèëÈÄÅÂà∞‰∫§ÊòìÊúçÂä°ÔºåÈÇ£‰πà<strong>‰∫§ÊòìÊúçÂä°Â∞±ÂøÖÈ°ªËá™Â∑±‰∏ªÂä®ÂéªÊü•ËØ¢ÊîØ‰ªòÁä∂ÊÄÅ</strong>„ÄÇËøôÊ†∑Âç≥‰æøÊîØ‰ªòÊúçÂä°ÁöÑMQÈÄöÁü•Â§±Ë¥•ÔºåÊàë‰ª¨‰æùÁÑ∂ËÉΩ<strong>ÈÄöËøá‰∏ªÂä®Êü•ËØ¢Êù•‰øùËØÅËÆ¢ÂçïÁä∂ÊÄÅÁöÑ‰∏ÄËá¥</strong>„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/mq.12.png" srcset="/img/loading.gif" lazyload></p>
<p>ÈÄöÂ∏∏Êàë‰ª¨ÈááÂèñÁöÑÊé™ÊñΩÂ∞±ÊòØÂà©Áî®<strong>ÂÆöÊó∂‰ªªÂä°ÂÆöÊúüÊü•ËØ¢</strong>Ôºå‰æãÂ¶ÇÊØèÈöî20ÁßíÂ∞±Êü•ËØ¢‰∏ÄÊ¨°Ôºå<strong>Âπ∂Âà§Êñ≠ÊîØ‰ªòÁä∂ÊÄÅ</strong>„ÄÇÂ¶ÇÊûúÂèëÁé∞ËÆ¢ÂçïÂ∑≤ÁªèÊîØ‰ªòÔºåÂàôÁ´ãÂàªÊõ¥Êñ∞ËÆ¢ÂçïÁä∂ÊÄÅ‰∏∫Â∑≤ÊîØ‰ªòÂç≥ÂèØ„ÄÇ</p>
<h3 id="4-6-ÊîØ‰ªòÊúçÂä°‰∏é‰∫§ÊòìÊúçÂä°‰πãÈó¥ÁöÑËÆ¢ÂçïÁä∂ÊÄÅ‰∏ÄËá¥ÊÄßÊòØÂ¶Ç‰Ωï‰øùËØÅÁöÑÔºü"><a href="#4-6-ÊîØ‰ªòÊúçÂä°‰∏é‰∫§ÊòìÊúçÂä°‰πãÈó¥ÁöÑËÆ¢ÂçïÁä∂ÊÄÅ‰∏ÄËá¥ÊÄßÊòØÂ¶Ç‰Ωï‰øùËØÅÁöÑÔºü" class="headerlink" title="4.6 ÊîØ‰ªòÊúçÂä°‰∏é‰∫§ÊòìÊúçÂä°‰πãÈó¥ÁöÑËÆ¢ÂçïÁä∂ÊÄÅ‰∏ÄËá¥ÊÄßÊòØÂ¶Ç‰Ωï‰øùËØÅÁöÑÔºü"></a>4.6 ÊîØ‰ªòÊúçÂä°‰∏é‰∫§ÊòìÊúçÂä°‰πãÈó¥ÁöÑËÆ¢ÂçïÁä∂ÊÄÅ‰∏ÄËá¥ÊÄßÊòØÂ¶Ç‰Ωï‰øùËØÅÁöÑÔºü</h3><ul>
<li>È¶ñÂÖàÔºåÊîØ‰ªòÊúçÂä°‰ºöÊ≠£Âú®Áî®Êà∑ÊîØ‰ªòÊàêÂäü‰ª•ÂêéÂà©Áî®MQÊ∂àÊÅØÈÄöÁü•‰∫§ÊòìÊúçÂä°ÔºåÂÆåÊàêËÆ¢ÂçïÁä∂ÊÄÅÂêåÊ≠•„ÄÇ</li>
<li>ÂÖ∂Ê¨°Ôºå‰∏∫‰∫Ü‰øùËØÅMQÊ∂àÊÅØÁöÑÂèØÈù†ÊÄßÔºåÊàë‰ª¨ÈááÁî®‰∫ÜÁîü‰∫ßËÄÖÁ°ÆËÆ§Êú∫Âà∂„ÄÅÊ∂àË¥πËÄÖÁ°ÆËÆ§„ÄÅÊ∂àË¥πËÄÖÂ§±Ë¥•ÈáçËØïÁ≠âÁ≠ñÁï•ÔºåÁ°Æ‰øùÊ∂àÊÅØÊäïÈÄíÁöÑÂèØÈù†ÊÄß</li>
<li>ÊúÄÂêéÔºåÊàë‰ª¨ËøòÂú®‰∫§ÊòìÊúçÂä°ËÆæÁΩÆ‰∫ÜÂÆöÊó∂‰ªªÂä°ÔºåÂÆöÊúüÊü•ËØ¢ËÆ¢ÂçïÊîØ‰ªòÁä∂ÊÄÅ„ÄÇËøôÊ†∑Âç≥‰æøMQÈÄöÁü•Â§±Ë¥•ÔºåËøòÂèØ‰ª•Âà©Áî®ÂÆöÊó∂‰ªªÂä°‰Ωú‰∏∫ÂÖúÂ∫ïÊñπÊ°àÔºåÁ°Æ‰øùËÆ¢ÂçïÊîØ‰ªòÁä∂ÊÄÅÁöÑÊúÄÁªà‰∏ÄËá¥ÊÄß„ÄÇ</li>
</ul>
<h2 id="5-Âª∂ËøüÊ∂àÊÅØ"><a href="#5-Âª∂ËøüÊ∂àÊÅØ" class="headerlink" title="5. Âª∂ËøüÊ∂àÊÅØ"></a>5. Âª∂ËøüÊ∂àÊÅØ</h2><p>ÂØπ‰∫éË∂ÖËøá‰∏ÄÂÆöÊó∂Èó¥Êú™ÊîØ‰ªòÁöÑËÆ¢ÂçïÔºåÂ∫îËØ•Á´ãÂàªÂèñÊ∂àËÆ¢ÂçïÂπ∂ÈáäÊîæÂç†Áî®ÁöÑÂ∫ìÂ≠ò„ÄÇÂÉèËøôÁßç<strong>Âú®‰∏ÄÊÆµÊó∂Èó¥‰ª•ÂêéÊâçÊâßË°åÁöÑ‰ªªÂä°ÔºåÊàë‰ª¨Áß∞‰πã‰∏∫Âª∂Ëøü‰ªªÂä°</strong>ÔºåËÄåË¶ÅÂÆûÁé∞Âª∂Ëøü‰ªªÂä°ÔºåÊúÄÁÆÄÂçïÁöÑÊñπÊ°àÂ∞±ÊòØÂà©Áî®MQÁöÑÂª∂ËøüÊ∂àÊÅØ‰∫Ü„ÄÇ</p>
<p>Âú®RabbitMQ‰∏≠ÂÆûÁé∞Âª∂ËøüÊ∂àÊÅØ‰πüÊúâ‰∏§ÁßçÊñπÊ°àÔºö</p>
<ul>
<li>Ê≠ª‰ø°‰∫§Êç¢Êú∫+TTL</li>
<li>Âª∂ËøüÊ∂àÊÅØÊèí‰ª∂(Êé®Ëçê)</li>
</ul>
<h3 id="5-1-Ê≠ª‰ø°‰∫§Êç¢Êú∫"><a href="#5-1-Ê≠ª‰ø°‰∫§Êç¢Êú∫" class="headerlink" title="5.1 Ê≠ª‰ø°‰∫§Êç¢Êú∫"></a>5.1 Ê≠ª‰ø°‰∫§Êç¢Êú∫</h3><p>ÂΩì‰∏Ä‰∏™ÈòüÂàó‰∏≠ÁöÑÊ∂àÊÅØÊª°Ë∂≥‰∏ãÂàóÊÉÖÂÜµ‰πã‰∏ÄÊó∂ÔºåÂèØ‰ª•Êàê‰∏∫Ê≠ª‰ø°Ôºàdead letterÔºâÔºö</p>
<ul>
<li>Ê∂àË¥πËÄÖ‰ΩøÁî®basic.rejectÊàñ basic.nackÂ£∞ÊòéÊ∂àË¥πÂ§±Ë¥•ÔºåÂπ∂‰∏îÊ∂àÊÅØÁöÑrequeueÂèÇÊï∞ËÆæÁΩÆ‰∏∫false</li>
<li>Ê∂àÊÅØÊòØ‰∏Ä‰∏™ËøáÊúüÊ∂àÊÅØÔºåË∂ÖÊó∂Êó†‰∫∫Ê∂àË¥π</li>
<li>Ë¶ÅÊäïÈÄíÁöÑÈòüÂàóÊ∂àÊÅØÊª°‰∫ÜÔºåÊó†Ê≥ïÊäïÈÄí</li>
</ul>
<p><img src="/img/blogs/java/springcloud/mq.13.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>Âà©Áî® TTL ËÆ©Ê∂àÊÅØÂú®ÊôÆÈÄöÈòüÂàó‰∏≠Âª∂Ëøü‰∏ÄÊÆµÊó∂Èó¥„ÄÇ</li>
<li>Ë∂ÖÊó∂ÂêéÔºåÊ∂àÊÅØËøõÂÖ•Ê≠ª‰ø°‰∫§Êç¢Êú∫ÔºåÂÜçËΩ¨ÂèëÂà∞ÁúüÊ≠£ÁöÑÁõÆÊ†áÈòüÂàó„ÄÇ</li>
<li>Ê∂àË¥πËÄÖÁõëÂê¨ÁõÆÊ†áÈòüÂàóÔºåÂª∂ËøüÊó∂Èó¥‰∏ÄÂà∞ÔºåÊâç‰ºöÊî∂Âà∞Ê∂àÊÅØ„ÄÇ</li>
</ul>
<h3 id="5-2-DelayExchangeÊèí‰ª∂-Êé®Ëçê"><a href="#5-2-DelayExchangeÊèí‰ª∂-Êé®Ëçê" class="headerlink" title="5.2 DelayExchangeÊèí‰ª∂(Êé®Ëçê)"></a>5.2 DelayExchangeÊèí‰ª∂(Êé®Ëçê)</h3><p>RabbitMQÁ§æÂå∫Êèê‰æõ‰∫Ü‰∏Ä‰∏™Âª∂ËøüÊ∂àÊÅØÊèí‰ª∂Êù•ÂÆûÁé∞Áõ∏ÂêåÁöÑÊïàÊûú</p>
<p><a target="_blank" rel="noopener" href="https://github.com/rabbitmq/rabbitmq-delayed-message-exchange">Êèí‰ª∂‰∏ãËΩΩÂú∞ÂùÄ</a></p>
<p><strong>Â£∞ÊòéÂª∂Ëøü‰∫§Êç¢Êú∫</strong>Ôºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RabbitListener(bindings = @QueueBinding(</span><br><span class="hljs-meta">        value = @Queue(name = &quot;delay.queue&quot;, durable = &quot;true&quot;),</span><br><span class="hljs-meta">        exchange = @Exchange(name = &quot;delay.direct&quot;, delayed = &quot;true&quot;),</span><br><span class="hljs-meta">        key = &quot;delay&quot;</span><br><span class="hljs-meta">))</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">listenDelayMessage</span><span class="hljs-params">(String msg)</span>&#123;<br>    log.info(<span class="hljs-string">&quot;Êé•Êî∂Âà∞delay.queueÁöÑÂª∂ËøüÊ∂àÊÅØÔºö&#123;&#125;&quot;</span>, msg);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ÂèëÈÄÅÂª∂ËøüÊ∂àÊÅØÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testPublisherDelayMessage</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-comment">// 1.ÂàõÂª∫Ê∂àÊÅØ</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">message</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;hello, delayed message&quot;</span>;<br>    <span class="hljs-comment">// 2.ÂèëÈÄÅÊ∂àÊÅØÔºåÂà©Áî®Ê∂àÊÅØÂêéÁΩÆÂ§ÑÁêÜÂô®Ê∑ªÂä†Ê∂àÊÅØÂ§¥</span><br>    rabbitTemplate.convertAndSend(<span class="hljs-string">&quot;delay.direct&quot;</span>, <span class="hljs-string">&quot;delay&quot;</span>, message, <span class="hljs-keyword">new</span> <span class="hljs-title class_">MessagePostProcessor</span>() &#123;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> Message <span class="hljs-title function_">postProcessMessage</span><span class="hljs-params">(Message message)</span> <span class="hljs-keyword">throws</span> AmqpException &#123;<br>            <span class="hljs-comment">// Ê∑ªÂä†Âª∂ËøüÊ∂àÊÅØÂ±ûÊÄß</span><br>            message.getMessageProperties().setDelay(<span class="hljs-number">5000</span>);<br>            <span class="hljs-keyword">return</span> message;<br>        &#125;<br>    &#125;);<br>&#125;<br></code></pre></td></tr></table></figure>

<p><strong>Ê≥®ÊÑè</strong>Ôºö</p>
<ul>
<li>Â¶ÇÊûúÊ∂àÊÅØÁöÑÂª∂ËøüÊó∂Èó¥ËÆæÁΩÆËæÉÈïøÔºåÂèØËÉΩ‰ºöÂØºËá¥Â†ÜÁßØÁöÑÂª∂ËøüÊ∂àÊÅØÈùûÂ∏∏Â§öÔºå‰ºöÂ∏¶Êù•ËæÉÂ§ßÁöÑCPUÂºÄÈîÄÔºå‰∏çÂª∫ËÆÆËÆæÁΩÆÂª∂ËøüÊó∂Èó¥ËøáÈïøÁöÑÂª∂ËøüÊ∂àÊÅØ„ÄÇ</li>
</ul>
<h3 id="5-3-Ë∂ÖÊó∂ËÆ¢ÂçïÈóÆÈ¢ò"><a href="#5-3-Ë∂ÖÊó∂ËÆ¢ÂçïÈóÆÈ¢ò" class="headerlink" title="5.3 Ë∂ÖÊó∂ËÆ¢ÂçïÈóÆÈ¢ò"></a>5.3 Ë∂ÖÊó∂ËÆ¢ÂçïÈóÆÈ¢ò</h3><p>Áî®Êà∑‰∏ãÂçïÂÆåÊàêÂêé,ÂèëÈÄÅ15ÂàÜÈíüÂª∂ËøüÊ∂àÊÅØ,Âú®15ÂàÜÈíüÂêéÊé•Êî∂Ê∂àÊÅØ,Ê£ÄÊü•ÊîØ‰ªòÁä∂ÊÄÅ:</p>
<ul>
<li>Â∑≤ÊîØ‰ªò:Êõ¥Êñ∞ËÆ¢ÂçïÁä∂ÊÄÅ‰∏∫Â∑≤ÊîØ‰ªò</li>
<li>Êú™ÊîØ‰ªò:Êõ¥Êñ∞ËÆ¢ÂçïÁä∂ÊÄÅ‰∏∫ÂÖ≥Èó≠ËÆ¢Âçï,ÊÅ¢Â§çÂïÜÂìÅÂ∫ìÂ≠ò</li>
</ul>
<p><img src="/img/blogs/java/springcloud/mq.14.png" srcset="/img/loading.gif" lazyload></p>
<h1 id="ÂÖ≠-Elasticsearch"><a href="#ÂÖ≠-Elasticsearch" class="headerlink" title="ÂÖ≠. Elasticsearch"></a>ÂÖ≠. Elasticsearch</h1><h2 id="1-Elasticsearch"><a href="#1-Elasticsearch" class="headerlink" title="1. Elasticsearch"></a>1. Elasticsearch</h2><p>ElasticsearchÊòØÁî±elasticÂÖ¨Âè∏ÂºÄÂèëÁöÑ‰∏ÄÂ•óÊêúÁ¥¢ÂºïÊìéÊäÄÊúØ</p>
<h3 id="1-1-ÂÄíÊéíÁ¥¢Âºï"><a href="#1-1-ÂÄíÊéíÁ¥¢Âºï" class="headerlink" title="1.1 ÂÄíÊéíÁ¥¢Âºï"></a>1.1 ÂÄíÊéíÁ¥¢Âºï</h3><p>ÂÄíÊéíÁ¥¢ÂºïÁöÑÊ¶ÇÂøµÊòØÂü∫‰∫éMySQLËøôÊ†∑ÁöÑÊ≠£ÂêëÁ¥¢ÂºïËÄåË®ÄÁöÑ</p>
<h4 id="1-1-1-Ê≠£ÂêëÁ¥¢Âºï"><a href="#1-1-1-Ê≠£ÂêëÁ¥¢Âºï" class="headerlink" title="1.1.1 Ê≠£ÂêëÁ¥¢Âºï"></a>1.1.1 Ê≠£ÂêëÁ¥¢Âºï</h4><ul>
<li>Ê≠£ÂêëÁ¥¢ÂºïÔºàForward IndexÔºâÈÄöÂ∏∏ÊåáÁöÑÊòØÊï∞ÊçÆÂ∫ìÁ¥¢ÂºïÊåâÁÖßÂ≠óÊÆµÁöÑËá™ÁÑ∂È°∫Â∫èËøõË°åÂ≠òÂÇ®ÂíåÊü•ÊâæÁöÑÁ¥¢ÂºïÊñπÂºè„ÄÇÂú® MySQL ‰∏≠ÔºåÂ∏∏ËßÅÁöÑÊ≠£ÂêëÁ¥¢Âºï‰∏ªË¶ÅÊòØB+ Ê†ëÁ¥¢Âºï„ÄÇ</li>
<li>ÂΩìÊêúÁ¥¢Êù°‰ª∂‰∏∫<strong>Ê®°Á≥äÂåπÈÖçÊó∂ÔºåÁî±‰∫éÁ¥¢ÂºïÊó†Ê≥ïÁîüÊïà</strong>ÔºåÂØºËá¥<strong>‰ªéÁ¥¢ÂºïÊü•ËØ¢ÈÄÄÂåñ‰∏∫ÂÖ®Ë°®Êâ´Êèè</strong>ÔºåÊïàÁéáÂæàÂ∑Æ„ÄÇ</li>
</ul>
<h4 id="1-1-2-ÂÄíÊéíÁ¥¢Âºï"><a href="#1-1-2-ÂÄíÊéíÁ¥¢Âºï" class="headerlink" title="1.1.2 ÂÄíÊéíÁ¥¢Âºï"></a>1.1.2 ÂÄíÊéíÁ¥¢Âºï</h4><p>‰∏§‰∏™Ê¶ÇÂøµÔºö</p>
<ul>
<li>ÊñáÊ°£ÔºàDocumentÔºâÔºöÁî®Êù•ÊêúÁ¥¢ÁöÑÊï∞ÊçÆÔºåÂÖ∂‰∏≠ÁöÑ<strong>ÊØè‰∏ÄÊù°Êï∞ÊçÆÂ∞±ÊòØ‰∏Ä‰∏™ÊñáÊ°£</strong>„ÄÇ‰æãÂ¶Ç‰∏Ä‰∏™ÁΩëÈ°µ„ÄÅ‰∏Ä‰∏™ÂïÜÂìÅ‰ø°ÊÅØ</li>
<li>ËØçÊù°ÔºàTermÔºâÔºöÂØπÊñáÊ°£Êï∞ÊçÆÊàñÁî®Êà∑ÊêúÁ¥¢Êï∞ÊçÆÔºåÂà©Áî®ÊüêÁßçÁÆóÊ≥ïÂàÜËØçÔºåÂæóÂà∞ÁöÑÂÖ∑Â§áÂê´‰πâÁöÑËØçËØ≠Â∞±ÊòØËØçÊù°„ÄÇ‰æãÂ¶ÇÔºöÊàëÊòØ‰∏≠ÂõΩ‰∫∫ÔºåÂ∞±ÂèØ‰ª•ÂàÜ‰∏∫ÔºöÊàë„ÄÅÊòØ„ÄÅ‰∏≠ÂõΩ‰∫∫„ÄÅ‰∏≠ÂõΩ„ÄÅÂõΩ‰∫∫ËøôÊ†∑ÁöÑÂá†‰∏™ËØçÊù°</li>
</ul>
<p><strong>ÂàõÂª∫ÂÄíÊéíÁ¥¢Âºï</strong>:</p>
<p><img src="/img/blogs/java/springcloud/es.1.png" srcset="/img/loading.gif" lazyload></p>
<p>ÂÄíÊéíÁ¥¢ÂºïÁöÑ<strong>ÊêúÁ¥¢ÊµÅÁ®ã</strong>:</p>
<p><img src="/img/blogs/java/springcloud/es.2.png" srcset="/img/loading.gif" lazyload></p>
<p>ÊµÅÁ®ãÊèèËø∞Ôºö</p>
<ol>
<li>Áî®Êà∑ËæìÂÖ•Êù°‰ª∂‚ÄùÂçé‰∏∫ÊâãÊú∫‚ÄùËøõË°åÊêúÁ¥¢„ÄÇ</li>
<li>ÂØπÁî®Êà∑ËæìÂÖ•Êù°‰ª∂ÂàÜËØçÔºåÂæóÂà∞ËØçÊù°ÔºöÂçé‰∏∫„ÄÅÊâãÊú∫„ÄÇ</li>
<li>ÊãøÁùÄËØçÊù°Âú®ÂÄíÊéíÁ¥¢Âºï‰∏≠Êü•ÊâæÔºàÁî±‰∫éËØçÊù°ÊúâÁ¥¢ÂºïÔºåÊü•ËØ¢ÊïàÁéáÂæàÈ´òÔºâÔºåÂç≥ÂèØÂæóÂà∞ÂåÖÂê´ËØçÊù°ÁöÑÊñáÊ°£idÔºö1„ÄÅ2„ÄÅ3„ÄÇ</li>
<li>ÊãøÁùÄÊñáÊ°£idÂà∞Ê≠£ÂêëÁ¥¢Âºï‰∏≠Êü•ÊâæÂÖ∑‰ΩìÊñáÊ°£Âç≥ÂèØÔºàÁî±‰∫éid‰πüÊúâÁ¥¢ÂºïÔºåÊü•ËØ¢ÊïàÁéá‰πüÂæàÈ´òÔºâ„ÄÇ</li>
</ol>
<h4 id="1-1-3-Ê≠£ÂêëÂíåÂÄíÊéí"><a href="#1-1-3-Ê≠£ÂêëÂíåÂÄíÊéí" class="headerlink" title="1.1.3 Ê≠£ÂêëÂíåÂÄíÊéí"></a>1.1.3 Ê≠£ÂêëÂíåÂÄíÊéí</h4><ul>
<li>Ê≠£ÂêëÁ¥¢ÂºïÊòØÊúÄ‰º†ÁªüÁöÑÔºåÊ†πÊçÆidÁ¥¢ÂºïÁöÑÊñπÂºè„ÄÇ‰ΩÜÊ†πÊçÆËØçÊù°Êü•ËØ¢Êó∂ÔºåÂøÖÈ°ªÂÖàÈÄêÊù°Ëé∑ÂèñÊØè‰∏™ÊñáÊ°£ÔºåÁÑ∂ÂêéÂà§Êñ≠ÊñáÊ°£‰∏≠ÊòØÂê¶ÂåÖÂê´ÊâÄÈúÄË¶ÅÁöÑËØçÊù°ÔºåÊòØ<strong>Ê†πÊçÆÊñáÊ°£ÊâæËØçÊù°ÁöÑËøáÁ®ã</strong>„ÄÇ </li>
<li>ËÄåÂÄíÊéíÁ¥¢ÂºïÂàôÁõ∏ÂèçÔºåÊòØ<strong>ÂÖàÊâæÂà∞Áî®Êà∑Ë¶ÅÊêúÁ¥¢ÁöÑËØçÊù°ÔºåÊ†πÊçÆËØçÊù°ÂæóÂà∞‰øùÊä§ËØçÊù°ÁöÑÊñáÊ°£ÁöÑidÔºåÁÑ∂ÂêéÊ†πÊçÆidËé∑ÂèñÊñáÊ°£</strong>„ÄÇÊòØÊ†πÊçÆËØçÊù°ÊâæÊñáÊ°£ÁöÑËøáÁ®ã„ÄÇ</li>
</ul>
<h3 id="1-2-IKÂàÜËØçÂô®"><a href="#1-2-IKÂàÜËØçÂô®" class="headerlink" title="1.2 IKÂàÜËØçÂô®"></a>1.2 IKÂàÜËØçÂô®</h3><p>Âú∞ÂùÄÔºö<a target="_blank" rel="noopener" href="https://github.com/medcl/elasticsearch-analysis-ik">https://github.com/medcl/elasticsearch-analysis-ik</a></p>
<p>IKÂàÜËØçÂô®ÂåÖÂê´‰∏§ÁßçÊ®°ÂºèÔºö</p>
<ul>
<li>ik_smartÔºöÊô∫ËÉΩËØ≠‰πâÂàáÂàÜ </li>
<li>ik_max_wordÔºöÊúÄÁªÜÁ≤íÂ∫¶ÂàáÂàÜ</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json">POST /_analyze<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;analyzer&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ik_smart&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;text&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÈªëÈ©¨Á®ãÂ∫èÂëòÂ≠¶‰π†javaÂ§™Ê£í‰∫Ü&quot;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>ÊâßË°åÁªìÊûúÔºö</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;tokens&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;token&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÈªëÈ©¨&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;start_offset&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;end_offset&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;type&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CN_WORD&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;position&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;token&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Á®ãÂ∫èÂëò&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;start_offset&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;end_offset&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;type&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CN_WORD&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;position&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;token&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Â≠¶‰π†&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;start_offset&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;end_offset&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;type&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CN_WORD&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;position&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;token&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;java&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;start_offset&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;end_offset&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">11</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;type&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ENGLISH&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;position&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;token&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Â§™Ê£í‰∫Ü&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;start_offset&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">11</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;end_offset&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">14</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;type&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;CN_WORD&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;position&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-number">4</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>


<p><strong>ÊãìÂ±ïËØçÂÖ∏</strong>:</p>
<ol>
<li>ÊâìÂºÄIKÂàÜËØçÂô®configÁõÆÂΩï</li>
<li>Âú®IKAnalyzer.cfg.xmlÈÖçÁΩÆÊñá‰ª∂ÂÜÖÂÆπÊ∑ªÂä†</li>
<li>Âú®IKÂàÜËØçÂô®ÁöÑconfigÁõÆÂΩïÊñ∞Âª∫‰∏Ä‰∏™ ext.dicÔºåÂèØ‰ª•ÂèÇËÄÉconfigÁõÆÂΩï‰∏ãÂ§çÂà∂‰∏Ä‰∏™ÈÖçÁΩÆÊñá‰ª∂ËøõË°å‰øÆÊîπ</li>
<li>ÈáçÂêØelasticsearch</li>
</ol>
<h3 id="1-3-ESÂü∫Á°ÄÊ¶ÇÂøµ"><a href="#1-3-ESÂü∫Á°ÄÊ¶ÇÂøµ" class="headerlink" title="1.3 ESÂü∫Á°ÄÊ¶ÇÂøµ"></a>1.3 ESÂü∫Á°ÄÊ¶ÇÂøµ</h3><p>elasticsearchÊòØ<strong>Èù¢ÂêëÊñáÊ°£ÔºàDocumentÔºâÂ≠òÂÇ®</strong>ÁöÑÔºåÂèØ‰ª•ÊòØÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑ‰∏ÄÊù°ÂïÜÂìÅÊï∞ÊçÆÔºå‰∏Ä‰∏™ËÆ¢Âçï‰ø°ÊÅØ„ÄÇÊñáÊ°£Êï∞ÊçÆ‰ºöË¢´Â∫èÂàóÂåñ‰∏∫jsonÊ†ºÂºèÂêéÂ≠òÂÇ®Âú®elasticsearch‰∏≠</p>
<p><img src="/img/blogs/java/springcloud/es.3.png" srcset="/img/loading.gif" lazyload></p>
<p>Â∞ÜÁ±ªÂûãÁõ∏ÂêåÁöÑÊñáÊ°£ÈõÜ‰∏≠Âú®‰∏ÄËµ∑ÁÆ°ÁêÜÔºåÁß∞‰∏∫Á¥¢ÂºïÔºàIndexÔºâ</p>
<p><img src="/img/blogs/java/springcloud/es.4.png" srcset="/img/loading.gif" lazyload></p>
<p><strong>MySQLÂíåESÁöÑÂØπÊØî</strong>Ôºö</p>
<p><img src="/img/blogs/java/springcloud/es.5.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>MysqlÔºöÊìÖÈïø‰∫ãÂä°Á±ªÂûãÊìç‰ΩúÔºåÂèØ‰ª•Á°Æ‰øùÊï∞ÊçÆÁöÑÂÆâÂÖ®Âíå‰∏ÄËá¥ÊÄß </li>
<li>ElasticsearchÔºöÊìÖÈïøÊµ∑ÈáèÊï∞ÊçÆÁöÑÊêúÁ¥¢„ÄÅÂàÜÊûê„ÄÅËÆ°ÁÆó<br>‰∏§ËÄÖÁªìÂêà‰ΩøÁî®Ôºö</li>
<li>ÂØπÂÆâÂÖ®ÊÄßË¶ÅÊ±ÇËæÉÈ´òÁöÑÂÜôÊìç‰ΩúÔºå‰ΩøÁî®mysqlÂÆûÁé∞</li>
<li>ÂØπÊü•ËØ¢ÊÄßËÉΩË¶ÅÊ±ÇËæÉÈ´òÁöÑÊêúÁ¥¢ÈúÄÊ±ÇÔºå‰ΩøÁî®elasticsearchÂÆûÁé∞</li>
<li>‰∏§ËÄÖÂÜçÂü∫‰∫éÊüêÁßçÊñπÂºèÔºåÂÆûÁé∞Êï∞ÊçÆÁöÑÂêåÊ≠•Ôºå‰øùËØÅ‰∏ÄËá¥ÊÄß</li>
</ul>
<h2 id="2-Á¥¢ÂºïÂ∫ìÊìç‰Ωú"><a href="#2-Á¥¢ÂºïÂ∫ìÊìç‰Ωú" class="headerlink" title="2. Á¥¢ÂºïÂ∫ìÊìç‰Ωú"></a>2. Á¥¢ÂºïÂ∫ìÊìç‰Ωú</h2><p>IndexÂ∞±Á±ª‰ººÊï∞ÊçÆÂ∫ìË°®ÔºåMappingÊò†Â∞ÑÂ∞±Á±ª‰ººË°®ÁöÑÁªìÊûÑ„ÄÇÊàë‰ª¨Ë¶ÅÂêëes‰∏≠Â≠òÂÇ®Êï∞ÊçÆÔºåÂøÖÈ°ªÂÖàÂàõÂª∫IndexÂíåMapping</p>
<h3 id="2-1-MappingÊò†Â∞ÑÂ±ûÊÄß"><a href="#2-1-MappingÊò†Â∞ÑÂ±ûÊÄß" class="headerlink" title="2.1 MappingÊò†Â∞ÑÂ±ûÊÄß"></a>2.1 MappingÊò†Â∞ÑÂ±ûÊÄß</h3><p>MappingÊòØÂØπÁ¥¢ÂºïÂ∫ì‰∏≠ÊñáÊ°£ÁöÑÁ∫¶ÊùüÔºåÂ∏∏ËßÅÁöÑMappingÂ±ûÊÄßÂåÖÊã¨Ôºö</p>
<ul>
<li>typeÔºöÂ≠óÊÆµÊï∞ÊçÆÁ±ªÂûãÔºåÂ∏∏ËßÅÁöÑÁÆÄÂçïÁ±ªÂûãÊúâÔºö <ul>
<li>Â≠óÁ¨¶‰∏≤ÔºötextÔºàÂèØÂàÜËØçÁöÑÊñáÊú¨Ôºâ„ÄÅkeywordÔºàÁ≤æÁ°ÆÂÄºÔºå‰æãÂ¶ÇÔºöÂìÅÁâå„ÄÅÂõΩÂÆ∂„ÄÅipÂú∞ÂùÄÔºâ</li>
<li>Êï∞ÂÄºÔºölong„ÄÅinteger„ÄÅshort„ÄÅbyte„ÄÅdouble„ÄÅfloat„ÄÅ</li>
<li>Â∏ÉÂ∞îÔºöboolean</li>
<li>Êó•ÊúüÔºödate</li>
<li>ÂØπË±°Ôºöobject</li>
</ul>
</li>
<li>indexÔºöÊòØÂê¶ÂàõÂª∫Á¥¢ÂºïÔºåÈªòËÆ§‰∏∫true</li>
<li>analyzerÔºö‰ΩøÁî®Âì™ÁßçÂàÜËØçÂô®</li>
<li>propertiesÔºöËØ•Â≠óÊÆµÁöÑÂ≠êÂ≠óÊÆµ</li>
</ul>
<h3 id="2-2-Á¥¢ÂºïÂ∫ìÁöÑÂ¢ûÂà†ÊîπÊü•"><a href="#2-2-Á¥¢ÂºïÂ∫ìÁöÑÂ¢ûÂà†ÊîπÊü•" class="headerlink" title="2.2 Á¥¢ÂºïÂ∫ìÁöÑÂ¢ûÂà†ÊîπÊü•"></a>2.2 Á¥¢ÂºïÂ∫ìÁöÑÂ¢ûÂà†ÊîπÊü•</h3><p>ElasticsearchÈááÁî®ÁöÑÊòØRestfulÈ£éÊ†ºÁöÑAPIÔºåËÄå‰∏îËØ∑Ê±ÇÂèÇÊï∞‰πüÈÉΩÈááÁî®JSONÈ£éÊ†º</p>
<table>
<thead>
<tr>
<th>Êé•Âè£Á±ªÂûã</th>
<th>ËØ∑Ê±ÇÊñπÂºè</th>
<th>ËØ∑Ê±ÇË∑ØÂæÑ</th>
<th>ËØ∑Ê±ÇÂèÇÊï∞</th>
</tr>
</thead>
<tbody><tr>
<td>Êü•ËØ¢Áî®Êà∑</td>
<td>GET</td>
<td>&#x2F;users&#x2F;{id}</td>
<td>Ë∑ØÂæÑ‰∏≠ÁöÑ id</td>
</tr>
<tr>
<td>Êñ∞Â¢ûÁî®Êà∑</td>
<td>POST</td>
<td>&#x2F;users</td>
<td>json Ê†ºÂºè user ÂØπË±°</td>
</tr>
<tr>
<td>‰øÆÊîπÁî®Êà∑</td>
<td>PUT</td>
<td>&#x2F;users&#x2F;{id}</td>
<td>Ë∑ØÂæÑ‰∏≠ÁöÑ id<br>json Ê†ºÂºèÂØπË±°</td>
</tr>
<tr>
<td>Âà†Èô§Áî®Êà∑</td>
<td>DELETE</td>
<td>&#x2F;users&#x2F;{id}</td>
<td>Ë∑ØÂæÑ‰∏≠ÁöÑ id</td>
</tr>
</tbody></table>
<h4 id="2-2-1-ÂàõÂª∫Á¥¢ÂºïÂ∫ì"><a href="#2-2-1-ÂàõÂª∫Á¥¢ÂºïÂ∫ì" class="headerlink" title="2.2.1 ÂàõÂª∫Á¥¢ÂºïÂ∫ì"></a>2.2.1 ÂàõÂª∫Á¥¢ÂºïÂ∫ì</h4><p>Âü∫Êú¨ËØ≠Ê≥ïÔºö</p>
<ul>
<li>ËØ∑Ê±ÇÊñπÂºèÔºöPUT</li>
<li>ËØ∑Ê±ÇË∑ØÂæÑÔºö&#x2F;Á¥¢ÂºïÂ∫ìÂêçÔºåÂèØ‰ª•Ëá™ÂÆö‰πâ</li>
<li>ËØ∑Ê±ÇÂèÇÊï∞ÔºömappingÊò†Â∞Ñ</li>
</ul>
<p><strong>Ê†ºÂºè</strong>Ôºö</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs json">PUT /Á¥¢ÂºïÂ∫ìÂêçÁß∞<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;mappings&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;Â≠óÊÆµÂêç&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;analyzer&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ik_smart&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;Â≠óÊÆµÂêç2&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;keyword&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;index&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;false&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;Â≠óÊÆµÂêç3&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;Â≠êÂ≠óÊÆµ&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;keyword&quot;</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-comment">// ...Áï•</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>
<p>Á§∫‰æãÔºö</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs json"># PUT /heima<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;mappings&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;info&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;analyzer&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ik_smart&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;email&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;keyword&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;index&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;false&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;firstName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;keyword&quot;</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h4 id="2-2-2-Êü•ËØ¢„ÄÅÂà†Èô§Á¥¢ÂºïÂ∫ì"><a href="#2-2-2-Êü•ËØ¢„ÄÅÂà†Èô§Á¥¢ÂºïÂ∫ì" class="headerlink" title="2.2.2 Êü•ËØ¢„ÄÅÂà†Èô§Á¥¢ÂºïÂ∫ì"></a>2.2.2 Êü•ËØ¢„ÄÅÂà†Èô§Á¥¢ÂºïÂ∫ì</h4><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /Á¥¢ÂºïÂ∫ìÂêç<br>DELETE /Á¥¢ÂºïÂ∫ìÂêç<br></code></pre></td></tr></table></figure>

<h4 id="2-2-3-‰øÆÊîπÁ¥¢ÂºïÂ∫ì"><a href="#2-2-3-‰øÆÊîπÁ¥¢ÂºïÂ∫ì" class="headerlink" title="2.2.3 ‰øÆÊîπÁ¥¢ÂºïÂ∫ì"></a>2.2.3 ‰øÆÊîπÁ¥¢ÂºïÂ∫ì</h4><p>Á¥¢ÂºïÂ∫ì‰∏ÄÊó¶ÂàõÂª∫ÔºåÊó†Ê≥ï‰øÆÊîπmapping„ÄÇ‰ΩÜÊòØÂç¥ÂÖÅËÆ∏Ê∑ªÂä†Êñ∞ÁöÑÂ≠óÊÆµÂà∞mapping‰∏≠</p>
<p>ËØ≠Ê≥ïÔºö</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json">PUT /Á¥¢ÂºïÂ∫ìÂêç/_mapping<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;Êñ∞Â≠óÊÆµÂêç&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;integer&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>Á§∫‰æãÔºö</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json">PUT /heima/_mapping<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;age&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;integer&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h2 id="3-ÊñáÊ°£Êìç‰Ωú"><a href="#3-ÊñáÊ°£Êìç‰Ωú" class="headerlink" title="3. ÊñáÊ°£Êìç‰Ωú"></a>3. ÊñáÊ°£Êìç‰Ωú</h2><p>Êúâ‰∫ÜÁ¥¢ÂºïÂ∫ìÔºåÊé•‰∏ãÊù•Â∞±ÂèØ‰ª•ÂêëÁ¥¢ÂºïÂ∫ìÁöÑÊñáÊ°£‰∏≠Ê∑ªÂä†Êï∞ÊçÆ‰∫Ü„ÄÇ</p>
<h3 id="3-1-Êñ∞Â¢ûÊñáÊ°£"><a href="#3-1-Êñ∞Â¢ûÊñáÊ°£" class="headerlink" title="3.1 Êñ∞Â¢ûÊñáÊ°£"></a>3.1 Êñ∞Â¢ûÊñáÊ°£</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json">POST /Á¥¢ÂºïÂ∫ìÂêç/_doc/ÊñáÊ°£id<br><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;Â≠óÊÆµ1&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÂÄº1&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;Â≠óÊÆµ2&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÂÄº2&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;Â≠óÊÆµ3&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;Â≠êÂ±ûÊÄß1&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÂÄº3&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;Â≠êÂ±ûÊÄß2&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÂÄº4&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h3 id="3-2-Êü•ËØ¢ÊñáÊ°£"><a href="#3-2-Êü•ËØ¢ÊñáÊ°£" class="headerlink" title="3.2 Êü•ËØ¢ÊñáÊ°£"></a>3.2 Êü•ËØ¢ÊñáÊ°£</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /<span class="hljs-punctuation">&#123;</span>Á¥¢ÂºïÂ∫ìÂêçÁß∞<span class="hljs-punctuation">&#125;</span>/_doc/<span class="hljs-punctuation">&#123;</span>id<span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h3 id="3-3-Âà†Èô§ÊñáÊ°£"><a href="#3-3-Âà†Èô§ÊñáÊ°£" class="headerlink" title="3.3 Âà†Èô§ÊñáÊ°£"></a>3.3 Âà†Èô§ÊñáÊ°£</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json">DELETE /<span class="hljs-punctuation">&#123;</span>Á¥¢ÂºïÂ∫ìÂêç<span class="hljs-punctuation">&#125;</span>/_doc/idÂÄº<br></code></pre></td></tr></table></figure>

<h3 id="3-4-‰øÆÊîπÊñáÊ°£"><a href="#3-4-‰øÆÊîπÊñáÊ°£" class="headerlink" title="3.4 ‰øÆÊîπÊñáÊ°£"></a>3.4 ‰øÆÊîπÊñáÊ°£</h3><p>‰øÆÊîπÊúâ‰∏§ÁßçÊñπÂºèÔºö</p>
<ul>
<li>ÂÖ®Èáè‰øÆÊîπÔºöÁõ¥Êé•Ë¶ÜÁõñÂéüÊù•ÁöÑÊñáÊ°£</li>
<li>Â±ÄÈÉ®‰øÆÊîπÔºö‰øÆÊîπÊñáÊ°£‰∏≠ÁöÑÈÉ®ÂàÜÂ≠óÊÆµ</li>
</ul>
<h4 id="3-4-1-ÂÖ®Èáè‰øÆÊîπ"><a href="#3-4-1-ÂÖ®Èáè‰øÆÊîπ" class="headerlink" title="3.4.1 ÂÖ®Èáè‰øÆÊîπ"></a>3.4.1 ÂÖ®Èáè‰øÆÊîπ</h4><p>ÂÖ®Èáè‰øÆÊîπÊòØË¶ÜÁõñÂéüÊù•ÁöÑÊñáÊ°£ÔºåÂÖ∂Êú¨Ë¥®ÊòØ‰∏§Ê≠•Êìç‰ΩúÔºö</p>
<ul>
<li>Ê†πÊçÆÊåáÂÆöÁöÑidÂà†Èô§ÊñáÊ°£</li>
<li>Êñ∞Â¢û‰∏Ä‰∏™Áõ∏ÂêåidÁöÑÊñáÊ°£</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs json">PUT /<span class="hljs-punctuation">&#123;</span>Á¥¢ÂºïÂ∫ìÂêç<span class="hljs-punctuation">&#125;</span>/_doc/ÊñáÊ°£id<br><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;Â≠óÊÆµ1&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÂÄº1&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;Â≠óÊÆµ2&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÂÄº2&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-comment">// ... Áï•</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h4 id="3-4-2-Â±ÄÈÉ®‰øÆÊîπ"><a href="#3-4-2-Â±ÄÈÉ®‰øÆÊîπ" class="headerlink" title="3.4.2 Â±ÄÈÉ®‰øÆÊîπ"></a>3.4.2 Â±ÄÈÉ®‰øÆÊîπ</h4><p>Â±ÄÈÉ®‰øÆÊîπÊòØÂè™‰øÆÊîπÊåáÂÆöidÂåπÈÖçÁöÑÊñáÊ°£‰∏≠ÁöÑÈÉ®ÂàÜÂ≠óÊÆµ</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs json">POST /<span class="hljs-punctuation">&#123;</span>Á¥¢ÂºïÂ∫ìÂêç<span class="hljs-punctuation">&#125;</span>/_update/ÊñáÊ°£id<br><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;doc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>         <span class="hljs-attr">&quot;Â≠óÊÆµÂêç&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Êñ∞ÁöÑÂÄº&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h3 id="3-5-ÊâπÂ§ÑÁêÜ"><a href="#3-5-ÊâπÂ§ÑÁêÜ" class="headerlink" title="3.5 ÊâπÂ§ÑÁêÜ"></a>3.5 ÊâπÂ§ÑÁêÜ</h3><p>ÊâπÂ§ÑÁêÜÈááÁî®POSTËØ∑Ê±ÇÔºåÂü∫Êú¨ËØ≠Ê≥ïÂ¶Ç‰∏ã</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json">POST _bulk<br><span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;index&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;_index&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;test&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;_id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1&quot;</span> <span class="hljs-punctuation">&#125;</span> <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;field1&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;value1&quot;</span> <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;delete&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;_index&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;test&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;_id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2&quot;</span> <span class="hljs-punctuation">&#125;</span> <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;create&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;_index&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;test&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;_id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;3&quot;</span> <span class="hljs-punctuation">&#125;</span> <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;field1&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;value3&quot;</span> <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;update&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;_id&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;_index&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;test&quot;</span><span class="hljs-punctuation">&#125;</span> <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;doc&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;field2&quot;</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;value2&quot;</span><span class="hljs-punctuation">&#125;</span> <span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<ul>
<li>index‰ª£Ë°®Êñ∞Â¢ûÊìç‰Ωú<ul>
<li>_indexÔºöÊåáÂÆöÁ¥¢ÂºïÂ∫ìÂêç</li>
<li>_idÊåáÂÆöË¶ÅÊìç‰ΩúÁöÑÊñáÊ°£id</li>
<li>{ ‚Äúfield1‚Äù : ‚Äúvalue1‚Äù }ÔºöÂàôÊòØË¶ÅÊñ∞Â¢ûÁöÑÊñáÊ°£ÂÜÖÂÆπ</li>
</ul>
</li>
<li>delete‰ª£Ë°®Âà†Èô§Êìç‰Ωú<ul>
<li>_indexÔºöÊåáÂÆöÁ¥¢ÂºïÂ∫ìÂêç</li>
<li>_idÊåáÂÆöË¶ÅÊìç‰ΩúÁöÑÊñáÊ°£id</li>
</ul>
</li>
<li>update‰ª£Ë°®Êõ¥Êñ∞Êìç‰Ωú<ul>
<li>_indexÔºöÊåáÂÆöÁ¥¢ÂºïÂ∫ìÂêç</li>
<li>_idÊåáÂÆöË¶ÅÊìç‰ΩúÁöÑÊñáÊ°£id</li>
<li>{ ‚Äúdoc‚Äù : {‚Äúfield2‚Äù : ‚Äúvalue2‚Äù} }ÔºöË¶ÅÊõ¥Êñ∞ÁöÑÊñáÊ°£Â≠óÊÆµ</li>
</ul>
</li>
</ul>
<h3 id="3-6-Ê°à‰æã"><a href="#3-6-Ê°à‰æã" class="headerlink" title="3.6 Ê°à‰æã"></a>3.6 Ê°à‰æã</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs json"># Êñ∞Â¢ûÊñáÊ°£<br>POST /heima/_doc/<span class="hljs-number">1</span><br><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;info&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÈªëÈ©¨Á®ãÂ∫èÂëòJavaËÆ≤Â∏à&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;email&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zy@itcast.cn&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;firstName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;‰∫ë&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;lastName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Ëµµ&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br># Êü•ËØ¢ÊñáÊ°£<br>GET /heima/_doc/<span class="hljs-number">1</span><br><br># Âà†Èô§ÊñáÊ°£<br>DELETE /heima/_doc/<span class="hljs-number">1</span><br><br># ÂÖ®Èáè‰øÆÊîπÊñáÊ°£<br>PUT /heima/_doc/<span class="hljs-number">1</span><br><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;info&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÈªëÈ©¨Á®ãÂ∫èÂëòÈ´òÁ∫ßJavaËÆ≤Â∏à&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;email&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zy@itcast.cn&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;firstName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;‰∫ë&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;lastName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Ëµµ&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br># Â±ÄÈÉ®‰øÆÊîπÊñáÊ°£<br>POST /heima/_update/<span class="hljs-number">1</span><br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;doc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;email&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ZhaoYun@itcast.cn&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br># ÊâπÈáèÊñ∞Â¢ûÊñáÊ°£<br>POST /_bulk<br><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;index&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;_index&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;heima&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;3&quot;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;info&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÈªëÈ©¨Á®ãÂ∫èÂëòC++ËÆ≤Â∏à&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;email&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ww@itcast.cn&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;firstName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;‰∫î&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;lastName&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Áéã&quot;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;index&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;_index&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;heima&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;4&quot;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;info&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÈªëÈ©¨Á®ãÂ∫èÂëòÂâçÁ´ØËÆ≤Â∏à&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;email&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;zhangsan@itcast.cn&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;firstName&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;‰∏â&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;lastName&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Âº†&quot;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br><br># ÊâπÈáèÂà†Èô§ÊñáÊ°£<br>POST /_bulk<br><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;delete&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;_index&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;heima&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;3&quot;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;delete&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;_index&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;heima&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;_id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;4&quot;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h2 id="4-JavaRestClient"><a href="#4-JavaRestClient" class="headerlink" title="4. JavaRestClient"></a>4. JavaRestClient</h2><h3 id="4-1-ÂÆ¢Êà∑Á´ØÂàùÂßãÂåñRestClient"><a href="#4-1-ÂÆ¢Êà∑Á´ØÂàùÂßãÂåñRestClient" class="headerlink" title="4.1 ÂÆ¢Êà∑Á´ØÂàùÂßãÂåñRestClient"></a>4.1 ÂÆ¢Êà∑Á´ØÂàùÂßãÂåñRestClient</h3><ol>
<li>Âú®item-serviceÊ®°Âùó‰∏≠ÂºïÂÖ•esÁöÑRestHighLevelClient‰æùËµñÔºö</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.elasticsearch.client<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>elasticsearch-rest-high-level-client<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure>

<ol start="2">
<li>Âõ†‰∏∫SpringBootÈªòËÆ§ÁöÑESÁâàÊú¨ÊòØ7.17.10ÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅË¶ÜÁõñÈªòËÆ§ÁöÑESÁâàÊú¨Ôºö</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.source</span>&gt;</span>11<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.source</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">maven.compiler.target</span>&gt;</span>11<span class="hljs-tag">&lt;/<span class="hljs-name">maven.compiler.target</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">elasticsearch.version</span>&gt;</span>7.12.1<span class="hljs-tag">&lt;/<span class="hljs-name">elasticsearch.version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br></code></pre></td></tr></table></figure>

<ol start="3">
<li>ÂàùÂßãÂåñRestHighLevelClientÔºö</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">RestHighLevelClient</span> <span class="hljs-variable">client</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RestHighLevelClient</span>(RestClient.builder(<br>        HttpHost.create(<span class="hljs-string">&quot;http://192.168.150.101:9200&quot;</span>)<br>));<br></code></pre></td></tr></table></figure>

<h3 id="4-2-ÂàõÂª∫Á¥¢ÂºïÂ∫ì"><a href="#4-2-ÂàõÂª∫Á¥¢ÂºïÂ∫ì" class="headerlink" title="4.2 ÂàõÂª∫Á¥¢ÂºïÂ∫ì"></a>4.2 ÂàõÂª∫Á¥¢ÂºïÂ∫ì</h3><p>Ë¶ÅÂÆûÁé∞ÂØπÂïÜÂìÅÊêúÁ¥¢ÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅÂ∞ÜÂïÜÂìÅÊ∑ªÂä†Âà∞Elasticsearch‰∏≠Ôºå‰∏çËøáÈúÄË¶ÅÊ†πÊçÆÊêúÁ¥¢‰∏öÂä°ÁöÑÈúÄÊ±ÇÊù•ËÆæÂÆöÁ¥¢ÂºïÂ∫ìÁªìÊûÑÔºåËÄå‰∏çÊòØ‰∏ÄËÇ°ËÑëÁöÑÊääMySQLÊï∞ÊçÆÂÜôÂÖ•Elasticsearch.</p>
<h4 id="4-2-1-ÂïÜÂìÅMappingÊò†Â∞Ñ"><a href="#4-2-1-ÂïÜÂìÅMappingÊò†Â∞Ñ" class="headerlink" title="4.2.1 ÂïÜÂìÅMappingÊò†Â∞Ñ"></a>4.2.1 ÂïÜÂìÅMappingÊò†Â∞Ñ</h4><p>ÁªìÂêàÊï∞ÊçÆÂ∫ìË°®ÁªìÊûÑÔºåÂ≠óÊÆµÂØπÂ∫îÁöÑmappingÊò†Â∞ÑÂ±ûÊÄßÂ¶Ç‰∏ãÔºö</p>
<p><img src="/img/blogs/java/springcloud/es.6.png" srcset="/img/loading.gif" lazyload></p>
<p>Á¥¢ÂºïÂ∫ìÊñáÊ°£ÁªìÊûÑ:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs json">PUT /items<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;mappings&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;properties&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;keyword&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;text&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;analyzer&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ik_max_word&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;price&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;integer&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;stock&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;integer&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;image&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;keyword&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;index&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;category&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;keyword&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;brand&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;keyword&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;sold&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;integer&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;commentCount&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;integer&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;index&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">false</span></span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;isAD&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;boolean&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;updateTime&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;type&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;date&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h4 id="4-2-2-Âú®java‰∏≠ÂàõÂª∫Á¥¢ÂºïÂ∫ì"><a href="#4-2-2-Âú®java‰∏≠ÂàõÂª∫Á¥¢ÂºïÂ∫ì" class="headerlink" title="4.2.2 Âú®java‰∏≠ÂàõÂª∫Á¥¢ÂºïÂ∫ì"></a>4.2.2 Âú®java‰∏≠ÂàõÂª∫Á¥¢ÂºïÂ∫ì</h4><ol>
<li>ÂàõÂª∫RequestÂØπË±°„ÄÇ<br>  Âõ†‰∏∫ÊòØÂàõÂª∫Á¥¢ÂºïÂ∫ìÁöÑÊìç‰ΩúÔºåÂõ†Ê≠§RequestÊòØCreateIndexRequest„ÄÇ</li>
<li>Ê∑ªÂä†ËØ∑Ê±ÇÂèÇÊï∞<br>  ÂÖ∂ÂÆûÂ∞±ÊòØJsonÊ†ºÂºèÁöÑMappingÊò†Â∞ÑÂèÇÊï∞„ÄÇÂõ†‰∏∫jsonÂ≠óÁ¨¶‰∏≤ÂæàÈïøÔºåËøôÈáåÊòØÂÆö‰πâ‰∫ÜÈùôÊÄÅÂ≠óÁ¨¶‰∏≤Â∏∏ÈáèMAPPING_TEMPLATEÔºåËÆ©‰ª£Á†ÅÁúãËµ∑Êù•Êõ¥Âä†‰ºòÈõÖ„ÄÇ</li>
<li>ÂèëÈÄÅËØ∑Ê±Ç<br>  client.indices()ÊñπÊ≥ïÁöÑËøîÂõûÂÄºÊòØIndicesClientÁ±ªÂûãÔºåÂ∞ÅË£Ö‰∫ÜÊâÄÊúâ‰∏éÁ¥¢ÂºïÂ∫ìÊìç‰ΩúÊúâÂÖ≥ÁöÑÊñπÊ≥ï„ÄÇ‰æãÂ¶ÇÂàõÂª∫Á¥¢Âºï„ÄÅÂà†Èô§Á¥¢Âºï„ÄÅÂà§Êñ≠Á¥¢ÂºïÊòØÂê¶Â≠òÂú®Á≠â</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testCreateIndex</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// 1.ÂàõÂª∫RequestÂØπË±°</span><br>    <span class="hljs-type">CreateIndexRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">CreateIndexRequest</span>(<span class="hljs-string">&quot;items&quot;</span>);<br>    <span class="hljs-comment">// 2.ÂáÜÂ§áËØ∑Ê±ÇÂèÇÊï∞</span><br>    request.source(MAPPING_TEMPLATE, XContentType.JSON);<br>    <span class="hljs-comment">// 3.ÂèëÈÄÅËØ∑Ê±Ç</span><br>    client.indices().create(request, RequestOptions.DEFAULT);<br>&#125;<br><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">MAPPING_TEMPLATE</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;\n&quot;</span> +<br>            <span class="hljs-string">&quot;  \&quot;mappings\&quot;: &#123;\n&quot;</span> +<br>            <span class="hljs-string">&quot;    \&quot;properties\&quot;: &#123;\n&quot;</span> +<br>            <span class="hljs-string">&quot;      \&quot;id\&quot;: &#123;\n&quot;</span> +<br>            <span class="hljs-string">&quot;        \&quot;type\&quot;: \&quot;keyword\&quot;\n&quot;</span> +<br>            <span class="hljs-string">&quot;      &#125;,\n&quot;</span> +<br>            <span class="hljs-string">&quot;      \&quot;name\&quot;:&#123;\n&quot;</span> +<br>            <span class="hljs-string">&quot;        \&quot;type\&quot;: \&quot;text\&quot;,\n&quot;</span> +<br>            <span class="hljs-string">&quot;        \&quot;analyzer\&quot;: \&quot;ik_max_word\&quot;\n&quot;</span> +<br>            <span class="hljs-string">&quot;      &#125;,\n&quot;</span> +<br>            <span class="hljs-string">&quot;      \&quot;price\&quot;:&#123;\n&quot;</span> +<br>            <span class="hljs-string">&quot;        \&quot;type\&quot;: \&quot;integer\&quot;\n&quot;</span> +<br>            <span class="hljs-string">&quot;      &#125;,\n&quot;</span> +<br>            <span class="hljs-string">&quot;      \&quot;stock\&quot;:&#123;\n&quot;</span> +<br>            <span class="hljs-string">&quot;        \&quot;type\&quot;: \&quot;integer\&quot;\n&quot;</span> +<br>            <span class="hljs-string">&quot;      &#125;,\n&quot;</span> +<br>            <span class="hljs-string">&quot;      \&quot;image\&quot;:&#123;\n&quot;</span> +<br>            <span class="hljs-string">&quot;        \&quot;type\&quot;: \&quot;keyword\&quot;,\n&quot;</span> +<br>            <span class="hljs-string">&quot;        \&quot;index\&quot;: false\n&quot;</span> +<br>            <span class="hljs-string">&quot;      &#125;,\n&quot;</span> +<br>            <span class="hljs-string">&quot;      \&quot;category\&quot;:&#123;\n&quot;</span> +<br>            <span class="hljs-string">&quot;        \&quot;type\&quot;: \&quot;keyword\&quot;\n&quot;</span> +<br>            <span class="hljs-string">&quot;      &#125;,\n&quot;</span> +<br>            <span class="hljs-string">&quot;      \&quot;brand\&quot;:&#123;\n&quot;</span> +<br>            <span class="hljs-string">&quot;        \&quot;type\&quot;: \&quot;keyword\&quot;\n&quot;</span> +<br>            <span class="hljs-string">&quot;      &#125;,\n&quot;</span> +<br>            <span class="hljs-string">&quot;      \&quot;sold\&quot;:&#123;\n&quot;</span> +<br>            <span class="hljs-string">&quot;        \&quot;type\&quot;: \&quot;integer\&quot;\n&quot;</span> +<br>            <span class="hljs-string">&quot;      &#125;,\n&quot;</span> +<br>            <span class="hljs-string">&quot;      \&quot;commentCount\&quot;:&#123;\n&quot;</span> +<br>            <span class="hljs-string">&quot;        \&quot;type\&quot;: \&quot;integer\&quot;\n&quot;</span> +<br>            <span class="hljs-string">&quot;      &#125;,\n&quot;</span> +<br>            <span class="hljs-string">&quot;      \&quot;isAD\&quot;:&#123;\n&quot;</span> +<br>            <span class="hljs-string">&quot;        \&quot;type\&quot;: \&quot;boolean\&quot;\n&quot;</span> +<br>            <span class="hljs-string">&quot;      &#125;,\n&quot;</span> +<br>            <span class="hljs-string">&quot;      \&quot;updateTime\&quot;:&#123;\n&quot;</span> +<br>            <span class="hljs-string">&quot;        \&quot;type\&quot;: \&quot;date\&quot;\n&quot;</span> +<br>            <span class="hljs-string">&quot;      &#125;\n&quot;</span> +<br>            <span class="hljs-string">&quot;    &#125;\n&quot;</span> +<br>            <span class="hljs-string">&quot;  &#125;\n&quot;</span> +<br>            <span class="hljs-string">&quot;&#125;&quot;</span>;<br></code></pre></td></tr></table></figure>

<h3 id="4-3-Âú®java‰∏≠Âà†Èô§ÂíåÊü•ËØ¢Á¥¢ÂºïÂ∫ì"><a href="#4-3-Âú®java‰∏≠Âà†Èô§ÂíåÊü•ËØ¢Á¥¢ÂºïÂ∫ì" class="headerlink" title="4.3 Âú®java‰∏≠Âà†Èô§ÂíåÊü•ËØ¢Á¥¢ÂºïÂ∫ì"></a>4.3 Âú®java‰∏≠Âà†Èô§ÂíåÊü•ËØ¢Á¥¢ÂºïÂ∫ì</h3><h4 id="4-3-1-Âà†Èô§Á¥¢ÂºïÂ∫ì"><a href="#4-3-1-Âà†Èô§Á¥¢ÂºïÂ∫ì" class="headerlink" title="4.3.1 Âà†Èô§Á¥¢ÂºïÂ∫ì"></a>4.3.1 Âà†Èô§Á¥¢ÂºïÂ∫ì</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testDeleteIndex</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// 1.ÂàõÂª∫RequestÂØπË±°</span><br>    <span class="hljs-type">DeleteIndexRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DeleteIndexRequest</span>(<span class="hljs-string">&quot;items&quot;</span>);<br>    <span class="hljs-comment">// 2.ÂèëÈÄÅËØ∑Ê±Ç</span><br>    client.indices().delete(request, RequestOptions.DEFAULT);<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="4-3-2-Êü•ËØ¢Á¥¢ÂºïÂ∫ì"><a href="#4-3-2-Êü•ËØ¢Á¥¢ÂºïÂ∫ì" class="headerlink" title="4.3.2 Êü•ËØ¢Á¥¢ÂºïÂ∫ì"></a>4.3.2 Êü•ËØ¢Á¥¢ÂºïÂ∫ì</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testExistsIndex</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// 1.ÂàõÂª∫RequestÂØπË±°</span><br>    <span class="hljs-type">GetIndexRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GetIndexRequest</span>(<span class="hljs-string">&quot;items&quot;</span>);<br>    <span class="hljs-comment">// 2.ÂèëÈÄÅËØ∑Ê±Ç</span><br>    <span class="hljs-type">boolean</span> <span class="hljs-variable">exists</span> <span class="hljs-operator">=</span> client.indices().exists(request, RequestOptions.DEFAULT);<br>    <span class="hljs-comment">// 3.ËæìÂá∫</span><br>    System.err.println(exists ? <span class="hljs-string">&quot;Á¥¢ÂºïÂ∫ìÂ∑≤ÁªèÂ≠òÂú®ÔºÅ&quot;</span> : <span class="hljs-string">&quot;Á¥¢ÂºïÂ∫ì‰∏çÂ≠òÂú®ÔºÅ&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="4-4-ÊñáÊ°£Êìç‰Ωú"><a href="#4-4-ÊñáÊ°£Êìç‰Ωú" class="headerlink" title="4.4 ÊñáÊ°£Êìç‰Ωú"></a>4.4 ÊñáÊ°£Êìç‰Ωú</h3><h4 id="4-4-1-Êñ∞Â¢ûÊñáÊ°£"><a href="#4-4-1-Êñ∞Â¢ûÊñáÊ°£" class="headerlink" title="4.4.1 Êñ∞Â¢ûÊñáÊ°£"></a>4.4.1 Êñ∞Â¢ûÊñáÊ°£</h4><ol>
<li>ÂàõÂª∫RequestÂØπË±°ÔºåËøôÈáåÊòØIndexRequestÔºåÂõ†‰∏∫Ê∑ªÂä†ÊñáÊ°£Â∞±ÊòØÂàõÂª∫ÂÄíÊéíÁ¥¢ÂºïÁöÑËøáÁ®ã</li>
<li>ÂáÜÂ§áËØ∑Ê±ÇÂèÇÊï∞ÔºåÊú¨‰æã‰∏≠Â∞±ÊòØJsonÊñáÊ°£</li>
<li>ÂèëÈÄÅËØ∑Ê±Ç</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testAddDocument</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// 1.Ê†πÊçÆidÊü•ËØ¢ÂïÜÂìÅÊï∞ÊçÆ</span><br>    <span class="hljs-type">Item</span> <span class="hljs-variable">item</span> <span class="hljs-operator">=</span> itemService.getById(<span class="hljs-number">100002644680L</span>);<br>    <span class="hljs-comment">// 2.ËΩ¨Êç¢‰∏∫ÊñáÊ°£Á±ªÂûã</span><br>    <span class="hljs-type">ItemDoc</span> <span class="hljs-variable">itemDoc</span> <span class="hljs-operator">=</span> BeanUtil.copyProperties(item, ItemDoc.class);<br>    <span class="hljs-comment">// 3.Â∞ÜItemDTOËΩ¨json</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">doc</span> <span class="hljs-operator">=</span> JSONUtil.toJsonStr(itemDoc);<br><br>    <span class="hljs-comment">// 1.ÂáÜÂ§áRequestÂØπË±°</span><br>    <span class="hljs-type">IndexRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IndexRequest</span>(<span class="hljs-string">&quot;items&quot;</span>).id(itemDoc.getId());<br>    <span class="hljs-comment">// 2.ÂáÜÂ§áJsonÊñáÊ°£</span><br>    request.source(doc, XContentType.JSON);<br>    <span class="hljs-comment">// 3.ÂèëÈÄÅËØ∑Ê±Ç</span><br>    client.index(request, RequestOptions.DEFAULT);<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="4-4-2-Êü•ËØ¢ÊñáÊ°£"><a href="#4-4-2-Êü•ËØ¢ÊñáÊ°£" class="headerlink" title="4.4.2 Êü•ËØ¢ÊñáÊ°£"></a>4.4.2 Êü•ËØ¢ÊñáÊ°£</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testGetDocumentById</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// 1.ÂáÜÂ§áRequestÂØπË±°</span><br>    <span class="hljs-type">GetRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">GetRequest</span>(<span class="hljs-string">&quot;items&quot;</span>).id(<span class="hljs-string">&quot;100002644680&quot;</span>);<br>    <span class="hljs-comment">// 2.ÂèëÈÄÅËØ∑Ê±Ç</span><br>    <span class="hljs-type">GetResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> client.get(request, RequestOptions.DEFAULT);<br>    <span class="hljs-comment">// 3.Ëé∑ÂèñÂìçÂ∫îÁªìÊûú‰∏≠ÁöÑsource</span><br>    <span class="hljs-type">String</span> <span class="hljs-variable">json</span> <span class="hljs-operator">=</span> response.getSourceAsString();<br>    <br>    <span class="hljs-type">ItemDoc</span> <span class="hljs-variable">itemDoc</span> <span class="hljs-operator">=</span> JSONUtil.toBean(json, ItemDoc.class);<br>    System.out.println(<span class="hljs-string">&quot;itemDoc= &quot;</span> + ItemDoc);<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="4-4-3-Âà†Èô§ÊñáÊ°£"><a href="#4-4-3-Âà†Èô§ÊñáÊ°£" class="headerlink" title="4.4.3 Âà†Èô§ÊñáÊ°£"></a>4.4.3 Âà†Èô§ÊñáÊ°£</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testDeleteDocument</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// 1.ÂáÜÂ§áRequestÔºå‰∏§‰∏™ÂèÇÊï∞ÔºåÁ¨¨‰∏Ä‰∏™ÊòØÁ¥¢ÂºïÂ∫ìÂêçÔºåÁ¨¨‰∫å‰∏™ÊòØÊñáÊ°£id</span><br>    <span class="hljs-type">DeleteRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">DeleteRequest</span>(<span class="hljs-string">&quot;item&quot;</span>, <span class="hljs-string">&quot;100002644680&quot;</span>);<br>    <span class="hljs-comment">// 2.ÂèëÈÄÅËØ∑Ê±Ç</span><br>    client.delete(request, RequestOptions.DEFAULT);<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="4-4-4-‰øÆÊîπÊñáÊ°£"><a href="#4-4-4-‰øÆÊîπÊñáÊ°£" class="headerlink" title="4.4.4 ‰øÆÊîπÊñáÊ°£"></a>4.4.4 ‰øÆÊîπÊñáÊ°£</h4><ul>
<li>ÂÖ®Èáè‰øÆÊîπÔºöÊú¨Ë¥®ÊòØÂÖàÊ†πÊçÆidÂà†Èô§ÔºåÂÜçÊñ∞Â¢û</li>
<li>Â±ÄÈÉ®‰øÆÊîπÔºö‰øÆÊîπÊñáÊ°£‰∏≠ÁöÑÊåáÂÆöÂ≠óÊÆµÂÄº</li>
</ul>
<p>Êàë‰ª¨‰∏ªË¶ÅÂÖ≥Ê≥®Â±ÄÈÉ®‰øÆÊîπÁöÑAPI:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testUpdateDocument</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// 1.ÂáÜÂ§áRequest</span><br>    <span class="hljs-type">UpdateRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UpdateRequest</span>(<span class="hljs-string">&quot;items&quot;</span>, <span class="hljs-string">&quot;100002644680&quot;</span>);<br>    <span class="hljs-comment">// 2.ÂáÜÂ§áËØ∑Ê±ÇÂèÇÊï∞</span><br>    request.doc(<br>            <span class="hljs-string">&quot;price&quot;</span>, <span class="hljs-number">58800</span>,<br>            <span class="hljs-string">&quot;commentCount&quot;</span>, <span class="hljs-number">1</span><br>    );<br>    <span class="hljs-comment">// 3.ÂèëÈÄÅËØ∑Ê±Ç</span><br>    client.update(request, RequestOptions.DEFAULT);<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="4-4-5-ÊâπÈáèÂØºÂÖ•ÊñáÊ°£"><a href="#4-4-5-ÊâπÈáèÂØºÂÖ•ÊñáÊ°£" class="headerlink" title="4.4.5 ÊâπÈáèÂØºÂÖ•ÊñáÊ°£"></a>4.4.5 ÊâπÈáèÂØºÂÖ•ÊñáÊ°£</h4><p>Bulk‰∏≠Ê∑ªÂä†‰∫ÜÂ§ö‰∏™IndexRequestÔºåÂ∞±ÊòØÊâπÈáèÊñ∞Â¢ûÂäüËÉΩ:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testBulk</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// 1.ÂàõÂª∫Request</span><br>    <span class="hljs-type">BulkRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BulkRequest</span>();<br>    <span class="hljs-comment">// 2.ÂáÜÂ§áËØ∑Ê±ÇÂèÇÊï∞</span><br>    request.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">IndexRequest</span>(<span class="hljs-string">&quot;items&quot;</span>).id(<span class="hljs-string">&quot;1&quot;</span>).source(<span class="hljs-string">&quot;json doc1&quot;</span>, XContentType.JSON));<br>    request.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">IndexRequest</span>(<span class="hljs-string">&quot;items&quot;</span>).id(<span class="hljs-string">&quot;2&quot;</span>).source(<span class="hljs-string">&quot;json doc2&quot;</span>, XContentType.JSON));<br>    <span class="hljs-comment">// 3.ÂèëÈÄÅËØ∑Ê±Ç</span><br>    client.bulk(request, RequestOptions.DEFAULT);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ÈááÁî®Âæ™ÁéØÈÅçÂéÜÊñπÂºèÔºåÊØèÊ¨°ÂØºÂÖ•1000Êù°Â∑¶Âè≥ÁöÑÊï∞ÊçÆ:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testLoadItemDocs</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// ÂàÜÈ°µÊü•ËØ¢ÂïÜÂìÅÊï∞ÊçÆ</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">pageNo</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">size</span> <span class="hljs-operator">=</span> <span class="hljs-number">1000</span>;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>        Page&lt;Item&gt; page = itemService.lambdaQuery().eq(Item::getStatus, <span class="hljs-number">1</span>).page(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Page</span>&lt;Item&gt;(pageNo, size));<br>        <span class="hljs-comment">// ÈùûÁ©∫Ê†°È™å</span><br>        List&lt;Item&gt; items = page.getRecords();<br>        <span class="hljs-keyword">if</span> (CollUtils.isEmpty(items)) &#123;<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        log.info(<span class="hljs-string">&quot;Âä†ËΩΩÁ¨¨&#123;&#125;È°µÊï∞ÊçÆÔºåÂÖ±&#123;&#125;Êù°&quot;</span>, pageNo, items.size());<br>        <span class="hljs-comment">// 1.ÂàõÂª∫Request</span><br>        <span class="hljs-type">BulkRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BulkRequest</span>(<span class="hljs-string">&quot;items&quot;</span>);<br>        <span class="hljs-comment">// 2.ÂáÜÂ§áÂèÇÊï∞ÔºåÊ∑ªÂä†Â§ö‰∏™Êñ∞Â¢ûÁöÑRequest</span><br>        <span class="hljs-keyword">for</span> (Item item : items) &#123;<br>            <span class="hljs-comment">// 2.1.ËΩ¨Êç¢‰∏∫ÊñáÊ°£Á±ªÂûãItemDTO</span><br>            <span class="hljs-type">ItemDoc</span> <span class="hljs-variable">itemDoc</span> <span class="hljs-operator">=</span> BeanUtil.copyProperties(item, ItemDoc.class);<br>            <span class="hljs-comment">// 2.2.ÂàõÂª∫Êñ∞Â¢ûÊñáÊ°£ÁöÑRequestÂØπË±°</span><br>            request.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">IndexRequest</span>()<br>                            .id(itemDoc.getId())<br>                            .source(JSONUtil.toJsonStr(itemDoc), XContentType.JSON));<br>        &#125;<br>        <span class="hljs-comment">// 3.ÂèëÈÄÅËØ∑Ê±Ç</span><br>        client.bulk(request, RequestOptions.DEFAULT);<br><br>        <span class="hljs-comment">// ÁøªÈ°µ</span><br>        pageNo++;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="5-DSLÊü•ËØ¢"><a href="#5-DSLÊü•ËØ¢" class="headerlink" title="5. DSLÊü•ËØ¢"></a>5. DSLÊü•ËØ¢</h2><p>ElasticsearchÁöÑÊü•ËØ¢ÂèØ‰ª•ÂàÜ‰∏∫‰∏§Â§ßÁ±ªÔºö</p>
<ul>
<li>Âè∂Â≠êÊü•ËØ¢ÔºàLeaf query clausesÔºâÔºö‰∏ÄËà¨ÊòØÂú®ÁâπÂÆöÁöÑÂ≠óÊÆµÈáåÊü•ËØ¢ÁâπÂÆöÂÄºÔºåÂ±û‰∫éÁÆÄÂçïÊü•ËØ¢ÔºåÂæàÂ∞ëÂçïÁã¨‰ΩøÁî®„ÄÇ</li>
<li>Â§çÂêàÊü•ËØ¢ÔºàCompound query clausesÔºâÔºö‰ª•ÈÄªËæëÊñπÂºèÁªÑÂêàÂ§ö‰∏™Âè∂Â≠êÊü•ËØ¢ÊàñËÄÖÊõ¥ÊîπÂè∂Â≠êÊü•ËØ¢ÁöÑË°å‰∏∫ÊñπÂºè„ÄÇ</li>
</ul>
<h3 id="5-1-Âè∂Â≠êÊü•ËØ¢"><a href="#5-1-Âè∂Â≠êÊü•ËØ¢" class="headerlink" title="5.1 Âè∂Â≠êÊü•ËØ¢"></a>5.1 Âè∂Â≠êÊü•ËØ¢</h3><p>Âè∂Â≠êÊü•ËØ¢ÁöÑÁ±ªÂûãÔºö</p>
<ul>
<li>ÂÖ®ÊñáÊ£ÄÁ¥¢Êü•ËØ¢ÔºàFull Text QueriesÔºâÔºöÂà©Áî®ÂàÜËØçÂô®ÂØπÁî®Êà∑ËæìÂÖ•ÊêúÁ¥¢Êù°‰ª∂ÂÖàÂàÜËØçÔºåÂæóÂà∞ËØçÊù°ÔºåÁÑ∂ÂêéÂÜçÂà©Áî®ÂÄíÊéíÁ¥¢ÂºïÊêúÁ¥¢ËØçÊù°„ÄÇ‰æãÂ¶ÇÔºö<ul>
<li>matchÔºö</li>
<li>multi_match</li>
</ul>
</li>
<li>Á≤æÁ°ÆÊü•ËØ¢ÔºàTerm-level queriesÔºâÔºö‰∏çÂØπÁî®Êà∑ËæìÂÖ•ÊêúÁ¥¢Êù°‰ª∂ÂàÜËØçÔºåÊ†πÊçÆÂ≠óÊÆµÂÜÖÂÆπÁ≤æÁ°ÆÂÄºÂåπÈÖç„ÄÇ‰ΩÜÂè™ËÉΩÊü•Êâækeyword„ÄÅÊï∞ÂÄº„ÄÅÊó•Êúü„ÄÅbooleanÁ±ªÂûãÁöÑÂ≠óÊÆµ„ÄÇ‰æãÂ¶ÇÔºö<ul>
<li>ids</li>
<li>term</li>
<li>range</li>
</ul>
</li>
<li>Âú∞ÁêÜÂùêÊ†áÊü•ËØ¢ÔºöÁî®‰∫éÊêúÁ¥¢Âú∞ÁêÜ‰ΩçÁΩÆÔºåÊêúÁ¥¢ÊñπÂºèÂæàÂ§öÔºå‰æãÂ¶ÇÔºö<ul>
<li>geo_bounding_boxÔºöÊåâÁü©ÂΩ¢ÊêúÁ¥¢</li>
<li>geo_distanceÔºöÊåâÁÇπÂíåÂçäÂæÑÊêúÁ¥¢</li>
</ul>
</li>
</ul>
<h4 id="5-1-1-ÂÖ®ÊñáÊ£ÄÁ¥¢Êü•ËØ¢"><a href="#5-1-1-ÂÖ®ÊñáÊ£ÄÁ¥¢Êü•ËØ¢" class="headerlink" title="5.1.1 ÂÖ®ÊñáÊ£ÄÁ¥¢Êü•ËØ¢"></a>5.1.1 ÂÖ®ÊñáÊ£ÄÁ¥¢Êü•ËØ¢</h4><p>matchËØ≠Ê≥ïÔºö</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /<span class="hljs-punctuation">&#123;</span>Á¥¢ÂºïÂ∫ìÂêç<span class="hljs-punctuation">&#125;</span>/_search<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;match&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;Â≠óÊÆµÂêç&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÊêúÁ¥¢Êù°‰ª∂&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>multi_matchËØ≠Ê≥ïÔºö</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /<span class="hljs-punctuation">&#123;</span>Á¥¢ÂºïÂ∫ìÂêç<span class="hljs-punctuation">&#125;</span>/_search<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;multi_match&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÊêúÁ¥¢Êù°‰ª∂&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;fields&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;Â≠óÊÆµ1&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Â≠óÊÆµ2&quot;</span><span class="hljs-punctuation">]</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>
<p>Á§∫‰æãÔºö</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /items/_search<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;multi_match&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Âçé‰∏∫&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;fields&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-string">&quot;name&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;brand&quot;</span><span class="hljs-punctuation">]</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h4 id="5-1-2-Á≤æÁ°ÆÊü•ËØ¢"><a href="#5-1-2-Á≤æÁ°ÆÊü•ËØ¢" class="headerlink" title="5.1.2 Á≤æÁ°ÆÊü•ËØ¢"></a>5.1.2 Á≤æÁ°ÆÊü•ËØ¢</h4><p>ËØçÊù°Á∫ßÂà´ÁöÑÊü•ËØ¢Ôºõ‰Ωú‰∏∫‰∏Ä‰∏™ËØçÊù°Ôºå‰∏éÊêúÁ¥¢ÁöÑÂ≠óÊÆµÂÜÖÂÆπÁ≤æÁ°ÆÂÄºÂåπÈÖç„ÄÇÂõ†Ê≠§Êé®ËçêÊü•Êâækeyword„ÄÅÊï∞ÂÄº„ÄÅÊó•Êúü„ÄÅbooleanÁ±ªÂûãÁöÑÂ≠óÊÆµ„ÄÇ</p>
<p>termÊü•ËØ¢:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /<span class="hljs-punctuation">&#123;</span>Á¥¢ÂºïÂ∫ìÂêç<span class="hljs-punctuation">&#125;</span>/_search<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;term&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;Â≠óÊÆµÂêç&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÊêúÁ¥¢Êù°‰ª∂&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>rangeÊü•ËØ¢:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /<span class="hljs-punctuation">&#123;</span>Á¥¢ÂºïÂ∫ìÂêç<span class="hljs-punctuation">&#125;</span>/_search<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;range&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;Â≠óÊÆµÂêç&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;gte&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>ÊúÄÂ∞èÂÄº<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;lte&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span>ÊúÄÂ§ßÂÄº<span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h3 id="5-2-Â§çÂêàÊü•ËØ¢"><a href="#5-2-Â§çÂêàÊü•ËØ¢" class="headerlink" title="5.2 Â§çÂêàÊü•ËØ¢"></a>5.2 Â§çÂêàÊü•ËØ¢</h3><ul>
<li>Á¨¨‰∏ÄÁ±ªÔºöÂü∫‰∫éÈÄªËæëËøêÁÆóÁªÑÂêàÂè∂Â≠êÊü•ËØ¢ÔºåÂÆûÁé∞ÁªÑÂêàÊù°‰ª∂Ôºå‰æãÂ¶Ç<ul>
<li>bool</li>
</ul>
</li>
<li>Á¨¨‰∫åÁ±ªÔºöÂü∫‰∫éÊüêÁßçÁÆóÊ≥ï‰øÆÊîπÊü•ËØ¢Êó∂ÁöÑÊñáÊ°£Áõ∏ÂÖ≥ÊÄßÁÆóÂàÜÔºå‰ªéËÄåÊîπÂèòÊñáÊ°£ÊéíÂêç„ÄÇ‰æãÂ¶ÇÔºö<ul>
<li>function_score</li>
<li>dis_max</li>
</ul>
</li>
</ul>
<h4 id="boolÊü•ËØ¢"><a href="#boolÊü•ËØ¢" class="headerlink" title="boolÊü•ËØ¢"></a>boolÊü•ËØ¢</h4><p>boolÊü•ËØ¢ÔºåÂç≥Â∏ÉÂ∞îÊü•ËØ¢„ÄÇÂ∞±ÊòØÂà©Áî®ÈÄªËæëËøêÁÆóÊù•ÁªÑÂêà‰∏Ä‰∏™ÊàñÂ§ö‰∏™Êü•ËØ¢Â≠êÂè•ÁöÑÁªÑÂêà„ÄÇboolÊü•ËØ¢ÊîØÊåÅÁöÑÈÄªËæëËøêÁÆóÊúâÔºö</p>
<ul>
<li>mustÔºöÂøÖÈ°ªÂåπÈÖçÊØè‰∏™Â≠êÊü•ËØ¢ÔºåÁ±ª‰ºº‚Äú‰∏é‚Äù</li>
<li>shouldÔºöÈÄâÊã©ÊÄßÂåπÈÖçÂ≠êÊü•ËØ¢ÔºåÁ±ª‰ºº‚ÄúÊàñ‚Äù</li>
<li>must_notÔºöÂøÖÈ°ª‰∏çÂåπÈÖçÔºå‰∏çÂèÇ‰∏éÁÆóÂàÜÔºåÁ±ª‰ºº‚ÄúÈùû‚Äù</li>
<li>filterÔºöÂøÖÈ°ªÂåπÈÖçÔºå‰∏çÂèÇ‰∏éÁÆóÂàÜ</li>
</ul>
<p>ËØ≠Ê≥ïÔºö</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /items/_search<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;bool&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;must&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;match&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÊâãÊú∫&quot;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;should&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;term&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;brand&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;vivo&quot;</span> <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;term&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;brand&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Â∞èÁ±≥&quot;</span> <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;must_not&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;range&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;price&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;gte&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2500</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;filter&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;range&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;price&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;lte&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1000</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">]</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>ÊêúÁ¥¢ÊâãÊú∫Ôºå‰ΩÜÂìÅÁâåÂøÖÈ°ªÊòØÂçé‰∏∫Ôºå‰ª∑Ê†ºÂøÖÈ°ªÊòØ900~1599Ôºö</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /items/_search<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;bool&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;must&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;match&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÊâãÊú∫&quot;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;filter&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;term&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;brand&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span> <span class="hljs-attr">&quot;value&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;Âçé‰∏∫&quot;</span> <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;range&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;price&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;gte&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">90000</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;lt&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">159900</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">]</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h3 id="5-3-ÊéíÂ∫è"><a href="#5-3-ÊéíÂ∫è" class="headerlink" title="5.3 ÊéíÂ∫è"></a>5.3 ÊéíÂ∫è</h3><p>elasticsearchÈªòËÆ§ÊòØÊ†πÊçÆÁõ∏ÂÖ≥Â∫¶ÁÆóÂàÜÔºà_scoreÔºâÊù•ÊéíÂ∫èÔºå‰ΩÜÊòØ‰πüÊîØÊåÅËá™ÂÆö‰πâÊñπÂºèÂØπÊêúÁ¥¢ÁªìÊûúÊéíÂ∫è„ÄÇ‰∏çËøáÂàÜËØçÂ≠óÊÆµÊó†Ê≥ïÊéíÂ∫èÔºå<strong>ËÉΩÂèÇ‰∏éÊéíÂ∫èÂ≠óÊÆµÁ±ªÂûãÊúâÔºökeywordÁ±ªÂûã„ÄÅÊï∞ÂÄºÁ±ªÂûã„ÄÅÂú∞ÁêÜÂùêÊ†áÁ±ªÂûã„ÄÅÊó•ÊúüÁ±ªÂûã</strong>Á≠â„ÄÇ</p>
<p>ËØ≠Ê≥ïÔºö</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /indexName/_search<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;match_all&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;sort&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;ÊéíÂ∫èÂ≠óÊÆµ&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;order&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÊéíÂ∫èÊñπÂºèascÂíådesc&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>ÊåâÁÖßÂïÜÂìÅ‰ª∑Ê†ºÊéíÂ∫è:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /items/_search<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;match_all&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;sort&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;price&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;order&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;desc&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h3 id="5-4-ÂàÜÈ°µ"><a href="#5-4-ÂàÜÈ°µ" class="headerlink" title="5.4 ÂàÜÈ°µ"></a>5.4 ÂàÜÈ°µ</h3><p>elasticsearch ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÂè™ËøîÂõûtop10ÁöÑÊï∞ÊçÆ„ÄÇËÄåÂ¶ÇÊûúË¶ÅÊü•ËØ¢Êõ¥Â§öÊï∞ÊçÆÂ∞±ÈúÄË¶Å‰øÆÊîπÂàÜÈ°µÂèÇÊï∞‰∫Ü</p>
<h4 id="5-4-1-Âü∫Á°ÄÂàÜÈ°µ"><a href="#5-4-1-Âü∫Á°ÄÂàÜÈ°µ" class="headerlink" title="5.4.1 Âü∫Á°ÄÂàÜÈ°µ"></a>5.4.1 Âü∫Á°ÄÂàÜÈ°µ</h4><p>elasticsearch‰∏≠ÈÄöËøá‰øÆÊîπfrom„ÄÅsizeÂèÇÊï∞Êù•ÊéßÂà∂Ë¶ÅËøîÂõûÁöÑÂàÜÈ°µÁªìÊûúÔºö</p>
<ul>
<li>fromÔºö‰ªéÁ¨¨Âá†‰∏™ÊñáÊ°£ÂºÄÂßã</li>
<li>sizeÔºöÊÄªÂÖ±Êü•ËØ¢Âá†‰∏™ÊñáÊ°£</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /items/_search<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;match_all&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;from&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-comment">// ÂàÜÈ°µÂºÄÂßãÁöÑ‰ΩçÁΩÆÔºåÈªòËÆ§‰∏∫0</span><br>  <span class="hljs-attr">&quot;size&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">10</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment">// ÊØèÈ°µÊñáÊ°£Êï∞ÈáèÔºåÈªòËÆ§10</span><br>  <span class="hljs-attr">&quot;sort&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;price&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;order&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;desc&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h4 id="5-4-2-Ê∑±Â∫¶ÂàÜÈ°µ"><a href="#5-4-2-Ê∑±Â∫¶ÂàÜÈ°µ" class="headerlink" title="5.4.2 Ê∑±Â∫¶ÂàÜÈ°µ"></a>5.4.2 Ê∑±Â∫¶ÂàÜÈ°µ</h4><p>elasticsearchÁöÑÊï∞ÊçÆ‰∏ÄËà¨‰ºöÈááÁî®ÂàÜÁâáÂ≠òÂÇ®Ôºå‰πüÂ∞±ÊòØÊää‰∏Ä‰∏™Á¥¢Âºï‰∏≠ÁöÑÊï∞ÊçÆÂàÜÊàêN‰ªΩÔºåÂ≠òÂÇ®Âà∞‰∏çÂêåËäÇÁÇπ‰∏ä„ÄÇËøôÁßçÂ≠òÂÇ®ÊñπÂºèÊØîËæÉÊúâÂà©‰∫éÊï∞ÊçÆÊâ©Â±ïÔºå‰ΩÜÁªôÂàÜÈ°µÂ∏¶Êù•‰∫Ü‰∏Ä‰∫õÈ∫ªÁÉ¶„ÄÇ<br>ËØïÊÉ≥‰∏Ä‰∏ãÔºåÂÅáÂ¶ÇÊàë‰ª¨Áé∞Âú®Ë¶ÅÊü•ËØ¢ÁöÑÊòØÁ¨¨999È°µÊï∞ÊçÆÂë¢ÔºåÊòØ‰∏çÊòØË¶ÅÊâæÁ¨¨9990~10000ÁöÑÊï∞ÊçÆÔºåÈÇ£Â≤Ç‰∏çÊòØÈúÄË¶ÅÊääÊØè‰∏™ÂàÜÁâá‰∏≠ÁöÑÂâç10000ÂêçÊï∞ÊçÆÈÉΩÊü•ËØ¢Âá∫Êù•ÔºåÊ±áÊÄªÂú®‰∏ÄËµ∑ÔºåÂú®ÂÜÖÂ≠ò‰∏≠ÊéíÂ∫èÔºüÂ¶ÇÊûúÊü•ËØ¢ÁöÑÂàÜÈ°µÊ∑±Â∫¶Êõ¥Ê∑±Âë¢ÔºåÈúÄË¶Å‰∏ÄÊ¨°Ê£ÄÁ¥¢ÁöÑÊï∞ÊçÆÂ≤Ç‰∏çÊòØÊõ¥Â§öÔºü</p>
<p><img src="/img/blogs/java/springcloud/es.7.png" srcset="/img/loading.gif" lazyload></p>
<p>ÈíàÂØπÊ∑±Â∫¶ÂàÜÈ°µÔºåelasticsearchÊèê‰æõ‰∫ÜËß£ÂÜ≥ÊñπÊ°àÔºö</p>
<ul>
<li>search afterÔºöÂàÜÈ°µÊó∂ÈúÄË¶ÅÊéíÂ∫èÔºåÂéüÁêÜÊòØ‰ªé‰∏ä‰∏ÄÊ¨°ÁöÑÊéíÂ∫èÂÄºÂºÄÂßãÔºåÊü•ËØ¢‰∏ã‰∏ÄÈ°µÊï∞ÊçÆ„ÄÇÂÆòÊñπÊé®Ëçê‰ΩøÁî®ÁöÑÊñπÂºè„ÄÇ</li>
</ul>
<h3 id="5-5-È´ò‰∫Æ"><a href="#5-5-È´ò‰∫Æ" class="headerlink" title="5.5 È´ò‰∫Æ"></a>5.5 È´ò‰∫Æ</h3><p>ËØçÊù°ÁöÑÈ´ò‰∫ÆÊ†áÁ≠æËÇØÂÆöÊòØÁî±ÊúçÂä°Á´ØÊèê‰æõÊï∞ÊçÆÁöÑÊó∂ÂÄôÂ∑≤ÁªèÂä†‰∏äÁöÑ„ÄÇ</p>
<p>ÂÆûÁé∞È´ò‰∫ÆÁöÑÊÄùË∑ØÂ∞±ÊòØÔºö</p>
<ul>
<li>Áî®Êà∑ËæìÂÖ•ÊêúÁ¥¢ÂÖ≥ÈîÆÂ≠óÊêúÁ¥¢Êï∞ÊçÆ</li>
<li>ÊúçÂä°Á´ØÊ†πÊçÆÊêúÁ¥¢ÂÖ≥ÈîÆÂ≠óÂà∞elasticsearchÊêúÁ¥¢ÔºåÂπ∂ÁªôÊêúÁ¥¢ÁªìÊûú‰∏≠ÁöÑÂÖ≥ÈîÆÂ≠óËØçÊù°Ê∑ªÂä†htmlÊ†áÁ≠æ</li>
<li>ÂâçÁ´ØÊèêÂâçÁªôÁ∫¶ÂÆöÂ•ΩÁöÑhtmlÊ†áÁ≠æÊ∑ªÂä†CSSÊ†∑Âºè</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /<span class="hljs-punctuation">&#123;</span>Á¥¢ÂºïÂ∫ìÂêç<span class="hljs-punctuation">&#125;</span>/_search<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;match&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;ÊêúÁ¥¢Â≠óÊÆµ&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÊêúÁ¥¢ÂÖ≥ÈîÆÂ≠ó&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;highlight&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;fields&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;È´ò‰∫ÆÂ≠óÊÆµÂêçÁß∞&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;pre_tags&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&lt;em&gt;&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;post_tags&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&lt;/em&gt;&quot;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h2 id="6-JavaRestClientÊü•ËØ¢"><a href="#6-JavaRestClientÊü•ËØ¢" class="headerlink" title="6. JavaRestClientÊü•ËØ¢"></a>6. JavaRestClientÊü•ËØ¢</h2><h3 id="6-1-ÊñáÊ°£ÊêúÁ¥¢ÁöÑÂü∫Êú¨Ê≠•È™§"><a href="#6-1-ÊñáÊ°£ÊêúÁ¥¢ÁöÑÂü∫Êú¨Ê≠•È™§" class="headerlink" title="6.1 ÊñáÊ°£ÊêúÁ¥¢ÁöÑÂü∫Êú¨Ê≠•È™§"></a>6.1 ÊñáÊ°£ÊêúÁ¥¢ÁöÑÂü∫Êú¨Ê≠•È™§</h3><ol>
<li>ÂàõÂª∫SearchRequestÂØπË±°</li>
<li>ÂáÜÂ§árequest.source()Ôºå‰πüÂ∞±ÊòØDSL„ÄÇ</li>
<li>QueryBuildersÊù•ÊûÑÂª∫Êü•ËØ¢Êù°‰ª∂</li>
<li>‰º†ÂÖ•request.source() ÁöÑ query() ÊñπÊ≥ï</li>
<li>ÂèëÈÄÅËØ∑Ê±ÇÔºåÂæóÂà∞ÁªìÊûú</li>
<li>Ëß£ÊûêÁªìÊûúÔºàÂèÇËÄÉJSONÁªìÊûúÔºå‰ªéÂ§ñÂà∞ÂÜÖÔºåÈÄêÂ±ÇËß£ÊûêÔºâ</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testMatchAll</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// 1.ÂàõÂª∫Request</span><br>    <span class="hljs-type">SearchRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SearchRequest</span>(<span class="hljs-string">&quot;items&quot;</span>);<br>    <span class="hljs-comment">// 2.ÁªÑÁªáËØ∑Ê±ÇÂèÇÊï∞</span><br>    request.source().query(QueryBuilders.matchAllQuery());<br>    <span class="hljs-comment">// 3.ÂèëÈÄÅËØ∑Ê±Ç</span><br>    <span class="hljs-type">SearchResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> client.search(request, RequestOptions.DEFAULT);<br>    <span class="hljs-comment">// 4.Ëß£ÊûêÂìçÂ∫î</span><br>    handleResponse(response);<br>&#125;<br><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleResponse</span><span class="hljs-params">(SearchResponse response)</span> &#123;<br>    <span class="hljs-type">SearchHits</span> <span class="hljs-variable">searchHits</span> <span class="hljs-operator">=</span> response.getHits();<br>    <span class="hljs-comment">// 1.Ëé∑ÂèñÊÄªÊù°Êï∞</span><br>    <span class="hljs-type">long</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> searchHits.getTotalHits().value;<br>    System.out.println(<span class="hljs-string">&quot;ÂÖ±ÊêúÁ¥¢Âà∞&quot;</span> + total + <span class="hljs-string">&quot;Êù°Êï∞ÊçÆ&quot;</span>);<br>    <span class="hljs-comment">// 2.ÈÅçÂéÜÁªìÊûúÊï∞ÁªÑ</span><br>    SearchHit[] hits = searchHits.getHits();<br>    <span class="hljs-keyword">for</span> (SearchHit hit : hits) &#123;<br>        <span class="hljs-comment">// 3.ÂæóÂà∞_sourceÔºå‰πüÂ∞±ÊòØÂéüÂßãjsonÊñáÊ°£</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">source</span> <span class="hljs-operator">=</span> hit.getSourceAsString();<br>        <span class="hljs-comment">// 4.ÂèçÂ∫èÂàóÂåñÂπ∂ÊâìÂç∞</span><br>        <span class="hljs-type">ItemDoc</span> <span class="hljs-variable">item</span> <span class="hljs-operator">=</span> JSONUtil.toBean(source, ItemDoc.class);<br>        System.out.println(item);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="6-2-Âè∂Â≠êÊü•ËØ¢"><a href="#6-2-Âè∂Â≠êÊü•ËØ¢" class="headerlink" title="6.2 Âè∂Â≠êÊü•ËØ¢"></a>6.2 Âè∂Â≠êÊü•ËØ¢</h3><p>matchÊü•ËØ¢Ôºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testMatch</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// 1.ÂàõÂª∫Request</span><br>    <span class="hljs-type">SearchRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SearchRequest</span>(<span class="hljs-string">&quot;items&quot;</span>);<br>    <span class="hljs-comment">// 2.ÁªÑÁªáËØ∑Ê±ÇÂèÇÊï∞</span><br>    request.source().query(QueryBuilders.matchQuery(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;ËÑ±ËÑÇÁâõÂ•∂&quot;</span>));<br>    <span class="hljs-comment">// 3.ÂèëÈÄÅËØ∑Ê±Ç</span><br>    <span class="hljs-type">SearchResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> client.search(request, RequestOptions.DEFAULT);<br>    <span class="hljs-comment">// 4.Ëß£ÊûêÂìçÂ∫î</span><br>    handleResponse(response);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>multi_matchÊü•ËØ¢Ôºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testMultiMatch</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// 1.ÂàõÂª∫Request</span><br>    <span class="hljs-type">SearchRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SearchRequest</span>(<span class="hljs-string">&quot;items&quot;</span>);<br>    <span class="hljs-comment">// 2.ÁªÑÁªáËØ∑Ê±ÇÂèÇÊï∞</span><br>    request.source().query(QueryBuilders.multiMatchQuery(<span class="hljs-string">&quot;ËÑ±ËÑÇÁâõÂ•∂&quot;</span>, <span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;category&quot;</span>));<br>    <span class="hljs-comment">// 3.ÂèëÈÄÅËØ∑Ê±Ç</span><br>    <span class="hljs-type">SearchResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> client.search(request, RequestOptions.DEFAULT);<br>    <span class="hljs-comment">// 4.Ëß£ÊûêÂìçÂ∫î</span><br>    handleResponse(response);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>rangeÊü•ËØ¢Ôºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testRange</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// 1.ÂàõÂª∫Request</span><br>    <span class="hljs-type">SearchRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SearchRequest</span>(<span class="hljs-string">&quot;items&quot;</span>);<br>    <span class="hljs-comment">// 2.ÁªÑÁªáËØ∑Ê±ÇÂèÇÊï∞</span><br>    request.source().query(QueryBuilders.rangeQuery(<span class="hljs-string">&quot;price&quot;</span>).gte(<span class="hljs-number">10000</span>).lte(<span class="hljs-number">30000</span>));<br>    <span class="hljs-comment">// 3.ÂèëÈÄÅËØ∑Ê±Ç</span><br>    <span class="hljs-type">SearchResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> client.search(request, RequestOptions.DEFAULT);<br>    <span class="hljs-comment">// 4.Ëß£ÊûêÂìçÂ∫î</span><br>    handleResponse(response);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>termÊü•ËØ¢Ôºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testTerm</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// 1.ÂàõÂª∫Request</span><br>    <span class="hljs-type">SearchRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SearchRequest</span>(<span class="hljs-string">&quot;items&quot;</span>);<br>    <span class="hljs-comment">// 2.ÁªÑÁªáËØ∑Ê±ÇÂèÇÊï∞</span><br>    request.source().query(QueryBuilders.termQuery(<span class="hljs-string">&quot;brand&quot;</span>, <span class="hljs-string">&quot;Âçé‰∏∫&quot;</span>));<br>    <span class="hljs-comment">// 3.ÂèëÈÄÅËØ∑Ê±Ç</span><br>    <span class="hljs-type">SearchResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> client.search(request, RequestOptions.DEFAULT);<br>    <span class="hljs-comment">// 4.Ëß£ÊûêÂìçÂ∫î</span><br>    handleResponse(response);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="6-3-Â§çÂêàÊü•ËØ¢"><a href="#6-3-Â§çÂêàÊü•ËØ¢" class="headerlink" title="6.3 Â§çÂêàÊü•ËØ¢"></a>6.3 Â§çÂêàÊü•ËØ¢</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testBool</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// 1.ÂàõÂª∫Request</span><br>    <span class="hljs-type">SearchRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SearchRequest</span>(<span class="hljs-string">&quot;items&quot;</span>);<br>    <span class="hljs-comment">// 2.ÁªÑÁªáËØ∑Ê±ÇÂèÇÊï∞</span><br>    <span class="hljs-comment">// 2.1.ÂáÜÂ§áboolÊü•ËØ¢</span><br>    <span class="hljs-type">BoolQueryBuilder</span> <span class="hljs-variable">bool</span> <span class="hljs-operator">=</span> QueryBuilders.boolQuery();<br>    <span class="hljs-comment">// 2.2.ÂÖ≥ÈîÆÂ≠óÊêúÁ¥¢</span><br>    bool.must(QueryBuilders.matchQuery(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;ËÑ±ËÑÇÁâõÂ•∂&quot;</span>));<br>    <span class="hljs-comment">// 2.3.ÂìÅÁâåËøáÊª§</span><br>    bool.filter(QueryBuilders.termQuery(<span class="hljs-string">&quot;brand&quot;</span>, <span class="hljs-string">&quot;Âæ∑‰∫ö&quot;</span>));<br>    <span class="hljs-comment">// 2.4.‰ª∑Ê†ºËøáÊª§</span><br>    bool.filter(QueryBuilders.rangeQuery(<span class="hljs-string">&quot;price&quot;</span>).lte(<span class="hljs-number">30000</span>));<br>    request.source().query(bool);<br>    <span class="hljs-comment">// 3.ÂèëÈÄÅËØ∑Ê±Ç</span><br>    <span class="hljs-type">SearchResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> client.search(request, RequestOptions.DEFAULT);<br>    <span class="hljs-comment">// 4.Ëß£ÊûêÂìçÂ∫î</span><br>    handleResponse(response);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="6-4-ÊéíÂ∫èÂíåÂàÜÈ°µ"><a href="#6-4-ÊéíÂ∫èÂíåÂàÜÈ°µ" class="headerlink" title="6.4 ÊéíÂ∫èÂíåÂàÜÈ°µ"></a>6.4 ÊéíÂ∫èÂíåÂàÜÈ°µ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testPageAndSort</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">pageNo</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>, pageSize = <span class="hljs-number">5</span>;<br><br>    <span class="hljs-comment">// 1.ÂàõÂª∫Request</span><br>    <span class="hljs-type">SearchRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SearchRequest</span>(<span class="hljs-string">&quot;items&quot;</span>);<br>    <span class="hljs-comment">// 2.ÁªÑÁªáËØ∑Ê±ÇÂèÇÊï∞</span><br>    <span class="hljs-comment">// 2.1.ÊêúÁ¥¢Êù°‰ª∂ÂèÇÊï∞</span><br>    request.source().query(QueryBuilders.matchQuery(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;ËÑ±ËÑÇÁâõÂ•∂&quot;</span>));<br>    <span class="hljs-comment">// 2.2.ÊéíÂ∫èÂèÇÊï∞</span><br>    request.source().sort(<span class="hljs-string">&quot;price&quot;</span>, SortOrder.ASC);<br>    <span class="hljs-comment">// 2.3.ÂàÜÈ°µÂèÇÊï∞</span><br>    request.source().from((pageNo - <span class="hljs-number">1</span>) * pageSize).size(pageSize);<br>    <span class="hljs-comment">// 3.ÂèëÈÄÅËØ∑Ê±Ç</span><br>    <span class="hljs-type">SearchResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> client.search(request, RequestOptions.DEFAULT);<br>    <span class="hljs-comment">// 4.Ëß£ÊûêÂìçÂ∫î</span><br>    handleResponse(response);<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="6-5-È´ò‰∫Æ"><a href="#6-5-È´ò‰∫Æ" class="headerlink" title="6.5 È´ò‰∫Æ"></a>6.5 È´ò‰∫Æ</h3><ul>
<li>Êù°‰ª∂ÂêåÊ†∑ÊòØÂú®request.source()‰∏≠ÊåáÂÆöÔºåÂè™‰∏çËøáÈ´ò‰∫ÆÊù°‰ª∂Ë¶ÅÂü∫‰∫éHighlightBuilderÊù•ÊûÑÈÄ†</li>
<li>È´ò‰∫ÆÂìçÂ∫îÁªìÊûú‰∏éÊêúÁ¥¢ÁöÑÊñáÊ°£ÁªìÊûú‰∏çÂú®‰∏ÄËµ∑ÔºåÈúÄË¶ÅÂçïÁã¨Ëß£Êûê</li>
</ul>
<p>Êü•ËØ¢:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testHighlight</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// 1.ÂàõÂª∫Request</span><br>    <span class="hljs-type">SearchRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SearchRequest</span>(<span class="hljs-string">&quot;items&quot;</span>);<br>    <span class="hljs-comment">// 2.ÁªÑÁªáËØ∑Ê±ÇÂèÇÊï∞</span><br>    <span class="hljs-comment">// 2.1.queryÊù°‰ª∂</span><br>    request.source().query(QueryBuilders.matchQuery(<span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-string">&quot;ËÑ±ËÑÇÁâõÂ•∂&quot;</span>));<br>    <span class="hljs-comment">// 2.2.È´ò‰∫ÆÊù°‰ª∂</span><br>    request.source().highlighter(<br>            SearchSourceBuilder.highlight()<br>                    .field(<span class="hljs-string">&quot;name&quot;</span>)<br>                    .preTags(<span class="hljs-string">&quot;&lt;em&gt;&quot;</span>)<br>                    .postTags(<span class="hljs-string">&quot;&lt;/em&gt;&quot;</span>)<br>    );<br>    <span class="hljs-comment">// 3.ÂèëÈÄÅËØ∑Ê±Ç</span><br>    <span class="hljs-type">SearchResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> client.search(request, RequestOptions.DEFAULT);<br>    <span class="hljs-comment">// 4.Ëß£ÊûêÂìçÂ∫î</span><br>    handleResponse(response);<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Ëß£ÊûêÊï∞ÊçÆÔºö</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">handleResponse</span><span class="hljs-params">(SearchResponse response)</span> &#123;<br>    <span class="hljs-type">SearchHits</span> <span class="hljs-variable">searchHits</span> <span class="hljs-operator">=</span> response.getHits();<br>    <span class="hljs-comment">// 1.Ëé∑ÂèñÊÄªÊù°Êï∞</span><br>    <span class="hljs-type">long</span> <span class="hljs-variable">total</span> <span class="hljs-operator">=</span> searchHits.getTotalHits().value;<br>    System.out.println(<span class="hljs-string">&quot;ÂÖ±ÊêúÁ¥¢Âà∞&quot;</span> + total + <span class="hljs-string">&quot;Êù°Êï∞ÊçÆ&quot;</span>);<br>    <span class="hljs-comment">// 2.ÈÅçÂéÜÁªìÊûúÊï∞ÁªÑ</span><br>    SearchHit[] hits = searchHits.getHits();<br>    <span class="hljs-keyword">for</span> (SearchHit hit : hits) &#123;<br>        <span class="hljs-comment">// 3.ÂæóÂà∞_sourceÔºå‰πüÂ∞±ÊòØÂéüÂßãjsonÊñáÊ°£</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">source</span> <span class="hljs-operator">=</span> hit.getSourceAsString();<br>        <span class="hljs-comment">// 4.ÂèçÂ∫èÂàóÂåñ</span><br>        <span class="hljs-type">ItemDoc</span> <span class="hljs-variable">item</span> <span class="hljs-operator">=</span> JSONUtil.toBean(source, ItemDoc.class);<br>        <span class="hljs-comment">// 5.Ëé∑ÂèñÈ´ò‰∫ÆÁªìÊûú</span><br>        Map&lt;String, HighlightField&gt; hfs = hit.getHighlightFields();<br>        <span class="hljs-keyword">if</span> (CollUtils.isNotEmpty(hfs)) &#123;<br>            <span class="hljs-comment">// 5.1.ÊúâÈ´ò‰∫ÆÁªìÊûúÔºåËé∑ÂèñnameÁöÑÈ´ò‰∫ÆÁªìÊûú</span><br>            <span class="hljs-type">HighlightField</span> <span class="hljs-variable">hf</span> <span class="hljs-operator">=</span> hfs.get(<span class="hljs-string">&quot;name&quot;</span>);<br>            <span class="hljs-keyword">if</span> (hf != <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-comment">// 5.2.Ëé∑ÂèñÁ¨¨‰∏Ä‰∏™È´ò‰∫ÆÁªìÊûúÁâáÊÆµÔºåÂ∞±ÊòØÂïÜÂìÅÂêçÁß∞ÁöÑÈ´ò‰∫ÆÂÄº</span><br>                <span class="hljs-type">String</span> <span class="hljs-variable">hfName</span> <span class="hljs-operator">=</span> hf.getFragments()[<span class="hljs-number">0</span>].string();<br>                item.setName(hfName);<br>            &#125;<br>        &#125;<br>        System.out.println(item);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="7-Êï∞ÊçÆËÅöÂêà"><a href="#7-Êï∞ÊçÆËÅöÂêà" class="headerlink" title="7. Êï∞ÊçÆËÅöÂêà"></a>7. Êï∞ÊçÆËÅöÂêà</h2><h3 id="7-1-ËÅöÂêàÁöÑÊ¶ÇÂøµ"><a href="#7-1-ËÅöÂêàÁöÑÊ¶ÇÂøµ" class="headerlink" title="7.1 ËÅöÂêàÁöÑÊ¶ÇÂøµ"></a>7.1 ËÅöÂêàÁöÑÊ¶ÇÂøµ</h3><p>ËÅöÂêàÔºàaggregationsÔºâÂèØ‰ª•ËÆ©Êàë‰ª¨ÊûÅÂÖ∂Êñπ‰æøÁöÑÂÆûÁé∞ÂØπÊï∞ÊçÆÁöÑÁªüËÆ°„ÄÅÂàÜÊûê„ÄÅËøêÁÆó</p>
<p>ËÅöÂêàÂ∏∏ËßÅÁöÑÊúâ‰∏âÁ±ªÔºö</p>
<ul>
<li>Ê°∂ÔºàBucketÔºâËÅöÂêàÔºöÁî®Êù•ÂØπÊñáÊ°£ÂÅöÂàÜÁªÑ </li>
<li>TermAggregationÔºöÊåâÁÖßÊñáÊ°£Â≠óÊÆµÂÄºÂàÜÁªÑÔºå‰æãÂ¶ÇÊåâÁÖßÂìÅÁâåÂÄºÂàÜÁªÑ„ÄÅÊåâÁÖßÂõΩÂÆ∂ÂàÜÁªÑ</li>
<li>Date HistogramÔºöÊåâÁÖßÊó•ÊúüÈò∂Ê¢ØÂàÜÁªÑÔºå‰æãÂ¶Ç‰∏ÄÂë®‰∏∫‰∏ÄÁªÑÔºåÊàñËÄÖ‰∏ÄÊúà‰∏∫‰∏ÄÁªÑ</li>
<li>Â∫¶ÈáèÔºàMetricÔºâËÅöÂêàÔºöÁî®‰ª•ËÆ°ÁÆó‰∏Ä‰∫õÂÄºÔºåÊØîÂ¶ÇÔºöÊúÄÂ§ßÂÄº„ÄÅÊúÄÂ∞èÂÄº„ÄÅÂπ≥ÂùáÂÄºÁ≠â </li>
<li>AvgÔºöÊ±ÇÂπ≥ÂùáÂÄº</li>
<li>MaxÔºöÊ±ÇÊúÄÂ§ßÂÄº</li>
<li>MinÔºöÊ±ÇÊúÄÂ∞èÂÄº</li>
<li>StatsÔºöÂêåÊó∂Ê±Çmax„ÄÅmin„ÄÅavg„ÄÅsumÁ≠â</li>
<li>ÁÆ°ÈÅìÔºàpipelineÔºâËÅöÂêàÔºöÂÖ∂ÂÆÉËÅöÂêàÁöÑÁªìÊûú‰∏∫Âü∫Á°ÄÂÅöËøõ‰∏ÄÊ≠•ËøêÁÆó</li>
</ul>
<p><strong>Ê≥®ÊÑè</strong>ÔºöÂèÇÂä†ËÅöÂêàÁöÑ<strong>Â≠óÊÆµÂøÖÈ°ªÊòØkeyword„ÄÅÊó•Êúü„ÄÅÊï∞ÂÄº„ÄÅÂ∏ÉÂ∞îÁ±ªÂûã</strong></p>
<h3 id="7-2-DSLÂÆûÁé∞ËÅöÂêà"><a href="#7-2-DSLÂÆûÁé∞ËÅöÂêà" class="headerlink" title="7.2 DSLÂÆûÁé∞ËÅöÂêà"></a>7.2 DSLÂÆûÁé∞ËÅöÂêà</h3><h4 id="7-2-1-BucketËÅöÂêà"><a href="#7-2-1-BucketËÅöÂêà" class="headerlink" title="7.2.1 BucketËÅöÂêà"></a>7.2.1 BucketËÅöÂêà</h4><p>Êàë‰ª¨Ë¶ÅÁªüËÆ°ÊâÄÊúâÂïÜÂìÅ‰∏≠ÂÖ±ÊúâÂì™‰∫õÂïÜÂìÅÂàÜÁ±ªÔºåÂÖ∂ÂÆûÂ∞±ÊòØ‰ª•ÂàÜÁ±ªÔºàcategoryÔºâÂ≠óÊÆµÂØπÊï∞ÊçÆÂàÜÁªÑ</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /items/_search<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;size&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <br>  <span class="hljs-attr">&quot;aggs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;category_agg&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;terms&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;field&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;category&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;size&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">20</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<ul>
<li>sizeÔºöËÆæÁΩÆsize‰∏∫0ÔºåÂ∞±ÊòØÊØèÈ°µÊü•0Êù°ÔºåÂàôÁªìÊûú‰∏≠Â∞±‰∏çÂåÖÂê´ÊñáÊ°£ÔºåÂè™ÂåÖÂê´ËÅöÂêà</li>
<li>aggsÔºöÂÆö‰πâËÅöÂêà<ul>
<li>category_aggÔºöËÅöÂêàÂêçÁß∞ÔºåËá™ÂÆö‰πâÔºå‰ΩÜ‰∏çËÉΩÈáçÂ§ç<ul>
<li>termsÔºöËÅöÂêàÁöÑÁ±ªÂûãÔºåÊåâÂàÜÁ±ªËÅöÂêàÔºåÊâÄ‰ª•Áî®term<ul>
<li>fieldÔºöÂèÇ‰∏éËÅöÂêàÁöÑÂ≠óÊÆµÂêçÁß∞</li>
<li>sizeÔºöÂ∏åÊúõËøîÂõûÁöÑËÅöÂêàÁªìÊûúÁöÑÊúÄÂ§ßÊï∞Èáè</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="7-2-2-Â∏¶Êù°‰ª∂ËÅöÂêà"><a href="#7-2-2-Â∏¶Êù°‰ª∂ËÅöÂêà" class="headerlink" title="7.2.2 Â∏¶Êù°‰ª∂ËÅöÂêà"></a>7.2.2 Â∏¶Êù°‰ª∂ËÅöÂêà</h4><p>‰ª∑Ê†ºÈ´ò‰∫é3000ÂÖÉÁöÑÊâãÊú∫ÂìÅÁâåÊúâÂì™‰∫õ</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /items/_search<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;bool&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;filter&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;term&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;category&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÊâãÊú∫&quot;</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;range&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;price&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>              <span class="hljs-attr">&quot;gte&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">300000</span><br>            <span class="hljs-punctuation">&#125;</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">]</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <br>  <span class="hljs-attr">&quot;size&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <br>  <span class="hljs-attr">&quot;aggs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;brand_agg&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;terms&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;field&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;brand&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;size&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">20</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h4 id="7-2-3-MetricËÅöÂêà"><a href="#7-2-3-MetricËÅöÂêà" class="headerlink" title="7.2.3 MetricËÅöÂêà"></a>7.2.3 MetricËÅöÂêà</h4><p>Êàë‰ª¨ÈúÄË¶ÅÂØπÊ°∂ÂÜÖÁöÑÂïÜÂìÅÂÅöËøêÁÆóÔºåËé∑ÂèñÊØè‰∏™ÂìÅÁâå‰ª∑Ê†ºÁöÑÊúÄÂ∞èÂÄº„ÄÅÊúÄÂ§ßÂÄº„ÄÅÂπ≥ÂùáÂÄº„ÄÇ</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs json">GET /items/_search<br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;query&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;bool&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;filter&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;term&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;category&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ÊâãÊú∫&quot;</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;range&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;price&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>              <span class="hljs-attr">&quot;gte&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">300000</span><br>            <span class="hljs-punctuation">&#125;</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">]</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> <br>  <span class="hljs-attr">&quot;size&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <br>  <span class="hljs-attr">&quot;aggs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;brand_agg&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;terms&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;field&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;brand&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;size&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">20</span><br>      <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;aggs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;stats_meric&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>          <span class="hljs-attr">&quot;stats&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;field&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;price&quot;</span><br>          <span class="hljs-punctuation">&#125;</span><br>        <span class="hljs-punctuation">&#125;</span><br>      <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<ul>
<li>stats_mericÔºöËÅöÂêàÂêçÁß∞<ul>
<li>statsÔºöËÅöÂêàÁ±ªÂûãÔºåstatsÊòØmetricËÅöÂêàÁöÑ‰∏ÄÁßç<ul>
<li>fieldÔºöËÅöÂêàÂ≠óÊÆµÔºåËøôÈáåÈÄâÊã©priceÔºåÁªüËÆ°‰ª∑Ê†º</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="7-3-JavaRestClientÂÆûÁé∞ËÅöÂêà"><a href="#7-3-JavaRestClientÂÆûÁé∞ËÅöÂêà" class="headerlink" title="7.3 JavaRestClientÂÆûÁé∞ËÅöÂêà"></a>7.3 JavaRestClientÂÆûÁé∞ËÅöÂêà</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">testAgg</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-comment">// 1.ÂàõÂª∫Request</span><br>    <span class="hljs-type">SearchRequest</span> <span class="hljs-variable">request</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">SearchRequest</span>(<span class="hljs-string">&quot;items&quot;</span>);<br>    <span class="hljs-comment">// 2.ÂáÜÂ§áËØ∑Ê±ÇÂèÇÊï∞</span><br>    <span class="hljs-type">BoolQueryBuilder</span> <span class="hljs-variable">bool</span> <span class="hljs-operator">=</span> QueryBuilders.boolQuery()<br>            .filter(QueryBuilders.termQuery(<span class="hljs-string">&quot;category&quot;</span>, <span class="hljs-string">&quot;ÊâãÊú∫&quot;</span>))<br>            .filter(QueryBuilders.rangeQuery(<span class="hljs-string">&quot;price&quot;</span>).gte(<span class="hljs-number">300000</span>));<br>    request.source().query(bool).size(<span class="hljs-number">0</span>);<br>    <span class="hljs-comment">// 3.ËÅöÂêàÂèÇÊï∞</span><br>    request.source().aggregation(<br>            AggregationBuilders.terms(<span class="hljs-string">&quot;brand_agg&quot;</span>).field(<span class="hljs-string">&quot;brand&quot;</span>).size(<span class="hljs-number">5</span>)<br>    );<br>    <span class="hljs-comment">// 4.ÂèëÈÄÅËØ∑Ê±Ç</span><br>    <span class="hljs-type">SearchResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> client.search(request, RequestOptions.DEFAULT);<br><br><br><br>    <span class="hljs-comment">// 5.Ëß£ÊûêËÅöÂêàÁªìÊûú</span><br>    <span class="hljs-type">Aggregations</span> <span class="hljs-variable">aggregations</span> <span class="hljs-operator">=</span> response.getAggregations();<br>    <span class="hljs-comment">// 5.1.Ëé∑ÂèñÂìÅÁâåËÅöÂêà</span><br>    <span class="hljs-type">Terms</span> <span class="hljs-variable">brandTerms</span> <span class="hljs-operator">=</span> aggregations.get(<span class="hljs-string">&quot;brand_agg&quot;</span>);<br>    <span class="hljs-comment">// 5.2.Ëé∑ÂèñËÅöÂêà‰∏≠ÁöÑÊ°∂</span><br>    List&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Terms</span>.Bucket&gt; buckets = brandTerms.getBuckets();<br>    <span class="hljs-comment">// 5.3.ÈÅçÂéÜÊ°∂ÂÜÖÊï∞ÊçÆ</span><br>    <span class="hljs-keyword">for</span> (Terms.Bucket bucket : buckets) &#123;<br>        <span class="hljs-comment">// 5.4.Ëé∑ÂèñÊ°∂ÂÜÖkey</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">brand</span> <span class="hljs-operator">=</span> bucket.getKeyAsString();<br>        System.out.print(<span class="hljs-string">&quot;brand = &quot;</span> + brand);<br>        <span class="hljs-type">long</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> bucket.getDocCount();<br>        System.out.println(<span class="hljs-string">&quot;; count = &quot;</span> + count);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h1 id="‰∏É-ÂæÆÊúçÂä°Èù¢ËØïÁØá"><a href="#‰∏É-ÂæÆÊúçÂä°Èù¢ËØïÁØá" class="headerlink" title="‰∏É. ÂæÆÊúçÂä°Èù¢ËØïÁØá"></a>‰∏É. ÂæÆÊúçÂä°Èù¢ËØïÁØá</h1><h2 id="1-ÂàÜÂ∏ÉÂºè‰∫ãÂä°"><a href="#1-ÂàÜÂ∏ÉÂºè‰∫ãÂä°" class="headerlink" title="1. ÂàÜÂ∏ÉÂºè‰∫ãÂä°"></a>1. ÂàÜÂ∏ÉÂºè‰∫ãÂä°</h2><h3 id="1-1-CAPÂÆöÁêÜ"><a href="#1-1-CAPÂÆöÁêÜ" class="headerlink" title="1.1 CAPÂÆöÁêÜ"></a>1.1 CAPÂÆöÁêÜ</h3><p>Âä†Â∑ûÂ§ßÂ≠¶ÁöÑËÆ°ÁÆóÊú∫ÁßëÂ≠¶ÂÆ∂ Eric Brewer ÊèêÂá∫ÔºåÂàÜÂ∏ÉÂºèÁ≥ªÁªüÊúâ‰∏â‰∏™ÊåáÊ†áÔºö</p>
<ul>
<li>ConsistencyÔºà‰∏ÄËá¥ÊÄßÔºâ</li>
<li>AvailabilityÔºàÂèØÁî®ÊÄßÔºâ</li>
<li>Partition tolerance ÔºàÂàÜÂå∫ÂÆπÈîôÊÄßÔºâ<br>ÂÆÉ‰ª¨ÁöÑÁ¨¨‰∏Ä‰∏™Â≠óÊØçÂàÜÂà´ÊòØ C„ÄÅA„ÄÅP„ÄÇEric BrewerËÆ§‰∏∫‰ªª‰ΩïÂàÜÂ∏ÉÂºèÁ≥ªÁªüÊû∂ÊûÑÊñπÊ°àÈÉΩ‰∏çÂèØËÉΩÂêåÊó∂Êª°Ë∂≥Ëøô3‰∏™ÁõÆÊ†áÔºåËøô‰∏™ÁªìËÆ∫Â∞±Âè´ÂÅö CAP ÂÆöÁêÜ„ÄÇ</li>
</ul>
<h4 id="1-1-1-‰∏ÄËá¥ÊÄß"><a href="#1-1-1-‰∏ÄËá¥ÊÄß" class="headerlink" title="1.1.1.‰∏ÄËá¥ÊÄß"></a>1.1.1.‰∏ÄËá¥ÊÄß</h4><p>ConsistencyÔºà‰∏ÄËá¥ÊÄßÔºâÔºöÁî®Êà∑ËÆøÈóÆÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠ÁöÑ‰ªªÊÑèËäÇÁÇπÔºåÂæóÂà∞ÁöÑÊï∞ÊçÆÂøÖÈ°ª‰∏ÄËá¥„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/7.1.1.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="1-1-2-ÂèØÁî®ÊÄß"><a href="#1-1-2-ÂèØÁî®ÊÄß" class="headerlink" title="1.1.2.ÂèØÁî®ÊÄß"></a>1.1.2.ÂèØÁî®ÊÄß</h4><p>Availability ÔºàÂèØÁî®ÊÄßÔºâÔºöÁî®Êà∑ËÆøÈóÆÂàÜÂ∏ÉÂºèÁ≥ªÁªüÊó∂ÔºåËØªÊàñÂÜôÊìç‰ΩúÊÄªËÉΩÊàêÂäü„ÄÇ<br>Âè™ËÉΩËØª‰∏çËÉΩÂÜôÔºåÊàñËÄÖÂè™ËÉΩÂÜô‰∏çËÉΩËØªÔºåÊàñËÄÖ‰∏§ËÄÖÈÉΩ‰∏çËÉΩÊâßË°åÔºåÂ∞±ËØ¥ÊòéÁ≥ªÁªüÂº±ÂèØÁî®Êàñ‰∏çÂèØÁî®„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/7.1.2.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="1-1-3-ÂàÜÂå∫ÂÆπÈîôÊÄß"><a href="#1-1-3-ÂàÜÂå∫ÂÆπÈîôÊÄß" class="headerlink" title="1.1.3 ÂàÜÂå∫ÂÆπÈîôÊÄß"></a>1.1.3 ÂàÜÂå∫ÂÆπÈîôÊÄß</h4><ul>
<li>PartitionÔºàÂàÜÂå∫ÔºâÔºöÂõ†‰∏∫ÁΩëÁªúÊïÖÈöúÊàñÂÖ∂ÂÆÉÂéüÂõ†ÂØºËá¥ÂàÜÂ∏ÉÂºèÁ≥ªÁªü‰∏≠ÁöÑÈÉ®ÂàÜËäÇÁÇπ‰∏éÂÖ∂ÂÆÉËäÇÁÇπÂ§±ÂéªËøûÊé•ÔºåÂΩ¢ÊàêÁã¨Á´ãÂàÜÂå∫„ÄÇ</li>
<li>ToleranceÔºàÂÆπÈîôÔºâÔºöÁ≥ªÁªüË¶ÅËÉΩÂÆπÂøçÁΩëÁªúÂàÜÂå∫Áé∞Ë±°ÔºåÂá∫Áé∞ÂàÜÂå∫Êó∂ÔºåÊï¥‰∏™Á≥ªÁªü‰πüË¶ÅÊåÅÁª≠ÂØπÂ§ñÊèê‰æõÊúçÂä°<ul>
<li>Â¶ÇÊûúÊ≠§Êó∂Âè™ÂÖÅËÆ∏ËØªÔºå‰∏çÂÖÅËÆ∏ÂÜôÔºåÊª°Ë∂≥ÊâÄÊúâËäÇÁÇπ‰∏ÄËá¥ÊÄß„ÄÇ‰ΩÜÊòØÁâ∫Áâ≤‰∫ÜÂèØÁî®ÊÄß„ÄÇÁ¨¶ÂêàCP</li>
<li>Â¶ÇÊûúÊ≠§Êó∂ÂÖÅËÆ∏‰ªªÊÑèËØªÂÜôÔºåÊª°Ë∂≥‰∫ÜÂèØÁî®ÊÄß„ÄÇ‰ΩÜÁî±‰∫énode3Êó†Ê≥ïÂêåÊ≠•ÔºåÂØºËá¥Êï∞ÊçÆ‰∏ç‰∏ÄËá¥ÔºåÁâ∫Áâ≤‰∫Ü‰∏ÄËá¥ÊÄß„ÄÇÁ¨¶ÂêàAP</li>
</ul>
</li>
</ul>
<p><img src="/img/blogs/java/springcloud/7.1.3.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="1-2-BASEÁêÜËÆ∫"><a href="#1-2-BASEÁêÜËÆ∫" class="headerlink" title="1.2 BASEÁêÜËÆ∫"></a>1.2 BASEÁêÜËÆ∫</h3><p>BASEÁêÜËÆ∫ÊòØÂØπCAPÁöÑ‰∏ÄÁßçËß£ÂÜ≥ÊÄùË∑ØÔºåÂåÖÂê´‰∏â‰∏™ÊÄùÊÉ≥Ôºö</p>
<ul>
<li>Basically Available Ôºà<strong>Âü∫Êú¨ÂèØÁî®</strong>ÔºâÔºöÂàÜÂ∏ÉÂºèÁ≥ªÁªüÂú®Âá∫Áé∞ÊïÖÈöúÊó∂ÔºåÂÖÅËÆ∏ÊçüÂ§±ÈÉ®ÂàÜÂèØÁî®ÊÄßÔºåÂç≥‰øùËØÅÊ†∏ÂøÉÂèØÁî®„ÄÇ</li>
<li>Soft StateÔºà<strong>ËΩØÁä∂ÊÄÅ</strong>ÔºâÔºöÂú®‰∏ÄÂÆöÊó∂Èó¥ÂÜÖÔºåÂÖÅËÆ∏Âá∫Áé∞‰∏≠Èó¥Áä∂ÊÄÅÔºåÊØîÂ¶Ç‰∏¥Êó∂ÁöÑ‰∏ç‰∏ÄËá¥Áä∂ÊÄÅ„ÄÇ</li>
<li>Eventually ConsistentÔºà<strong>ÊúÄÁªà‰∏ÄËá¥ÊÄß</strong>ÔºâÔºöËôΩÁÑ∂Êó†Ê≥ï‰øùËØÅÂº∫‰∏ÄËá¥ÊÄßÔºå‰ΩÜÊòØÂú®ËΩØÁä∂ÊÄÅÁªìÊùüÂêéÔºåÊúÄÁªàËææÂà∞Êï∞ÊçÆ‰∏ÄËá¥„ÄÇ</li>
</ul>
<p>ËÄåÂàÜÂ∏ÉÂºè‰∫ãÂä°ÊúÄÂ§ßÁöÑÈóÆÈ¢òÊòØÂêÑ‰∏™Â≠ê‰∫ãÂä°ÁöÑ‰∏ÄËá¥ÊÄßÈóÆÈ¢òÔºåÂõ†Ê≠§ÂèØ‰ª•ÂÄüÈâ¥CAPÂÆöÁêÜÂíåBASEÁêÜËÆ∫Ôºö</p>
<ul>
<li><strong>CPÊ®°Âºè</strong>ÔºöÂêÑ‰∏™Â≠ê‰∫ãÂä°ÊâßË°åÂêé‰∫íÁõ∏Á≠âÂæÖÔºåÂêåÊó∂Êèê‰∫§ÔºåÂêåÊó∂ÂõûÊªöÔºåËææÊàê<strong>Âº∫‰∏ÄËá¥</strong>„ÄÇ‰ΩÜ‰∫ãÂä°Á≠âÂæÖËøáÁ®ã‰∏≠ÔºåÂ§Ñ‰∫éÂº±ÂèØÁî®Áä∂ÊÄÅ„ÄÇ‰æãÂ¶ÇXAÊ®°Âºè</li>
<li><strong>APÊ®°Âºè</strong>ÔºöÂêÑÂ≠ê‰∫ãÂä°ÂàÜÂà´ÊâßË°åÂíåÊèê‰∫§ÔºåÂÖÅËÆ∏Âá∫Áé∞ÁªìÊûú‰∏ç‰∏ÄËá¥ÔºåÁÑ∂ÂêéÈááÁî®Âº•Ë°•Êé™ÊñΩÊÅ¢Â§çÊï∞ÊçÆÂç≥ÂèØÔºåÂÆûÁé∞ÊúÄÁªà‰∏ÄËá¥„ÄÇ‰æãÂ¶ÇATÊ®°ÂºèÂ∞±ÊòØÂ¶ÇÊ≠§</li>
</ul>
<h3 id="1-3-ATÊ®°ÂºèÁöÑËÑèÂÜôÈóÆÈ¢ò"><a href="#1-3-ATÊ®°ÂºèÁöÑËÑèÂÜôÈóÆÈ¢ò" class="headerlink" title="1.3 ATÊ®°ÂºèÁöÑËÑèÂÜôÈóÆÈ¢ò"></a>1.3 ATÊ®°ÂºèÁöÑËÑèÂÜôÈóÆÈ¢ò</h3><p>ATÊ®°Âºè‰πüÂàÜ‰∏∫‰∏§‰∏™Èò∂ÊÆµÔºöÁ¨¨‰∏ÄÈò∂ÊÆµÊòØËÆ∞ÂΩïÊï∞ÊçÆÂø´ÁÖßÔºåÊâßË°åÂπ∂Êèê‰∫§‰∫ãÂä°Ôºö</p>
<p><img src="/img/blogs/java/springcloud/7.1.4.png" srcset="/img/loading.gif" lazyload></p>
<p>Á¨¨‰∫åÈò∂ÊÆµÊ†πÊçÆÈò∂ÊÆµ‰∏ÄÁöÑÁªìÊûúÊù•Âà§Êñ≠Ôºö</p>
<ul>
<li>Â¶ÇÊûúÊØè‰∏Ä‰∏™ÂàÜÊîØ‰∫ãÂä°ÈÉΩÊàêÂäüÔºåÂàô‰∫ãÂä°Â∑≤ÁªèÁªìÊùüÔºàÂõ†‰∏∫Èò∂ÊÆµ‰∏ÄÂ∑≤ÁªèÊèê‰∫§ÔºâÔºåÂõ†Ê≠§Âà†Èô§Èò∂ÊÆµ‰∏ÄÁöÑÂø´ÁÖßÂç≥ÂèØ</li>
<li>Â¶ÇÊûúÊúâ‰ªªÊÑèÂàÜÊîØ‰∫ãÂä°Â§±Ë¥•ÔºåÂàôÈúÄË¶ÅÊ†πÊçÆÂø´ÁÖßÊÅ¢Â§çÂà∞Êõ¥Êñ∞ÂâçÊï∞ÊçÆ„ÄÇÁÑ∂ÂêéÂà†Èô§Âø´ÁÖß</li>
</ul>
<p><img src="/img/blogs/java/springcloud/7.1.5.png" srcset="/img/loading.gif" lazyload></p>
<p>ËøôÁßçÊ®°ÂºèÂú®Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºà99%ÔºâÂπ∂‰∏ç‰ºöÊúâ‰ªÄ‰πàÈóÆÈ¢òÔºå‰∏çËøáÂú®ÊûÅÁ´ØÊÉÖÂÜµ‰∏ãÔºåÁâπÂà´ÊòØÂ§öÁ∫øÁ®ãÂπ∂ÂèëËÆøÈóÆATÊ®°ÂºèÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°Êó∂ÔºåÊúâÂèØËÉΩÂá∫Áé∞ËÑèÂÜôÈóÆÈ¢òÔºåÂ¶ÇÂõæÔºö</p>
<p><img src="/img/blogs/java/springcloud/7.1.6.png" srcset="/img/loading.gif" lazyload></p>
<p>Ëß£ÂÜ≥ÊÄùË∑ØÂ∞±ÊòØÂºïÂÖ•‰∫ÜÂÖ®Â±ÄÈîÅÁöÑÊ¶ÇÂøµ„ÄÇÂú®ÈáäÊîæDBÈîÅ‰πãÂâçÔºåÂÖàÊãøÂà∞ÂÖ®Â±ÄÈîÅ„ÄÇÈÅøÂÖçÂêå‰∏ÄÊó∂ÂàªÊúâÂè¶Â§ñ‰∏Ä‰∏™‰∫ãÂä°Êù•Êìç‰ΩúÂΩìÂâçÊï∞ÊçÆ„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/7.1.7.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="1-4-TCCÊ®°Âºè"><a href="#1-4-TCCÊ®°Âºè" class="headerlink" title="1.4 TCCÊ®°Âºè"></a>1.4 TCCÊ®°Âºè</h3><p>TCCÊ®°Âºè‰∏éATÊ®°ÂºèÈùûÂ∏∏Áõ∏‰ººÔºåÊØèÈò∂ÊÆµÈÉΩÊòØÁã¨Á´ã‰∫ãÂä°Ôºå‰∏çÂêåÁöÑÊòØTCCÈÄöËøá‰∫∫Â∑•ÁºñÁ†ÅÊù•ÂÆûÁé∞Êï∞ÊçÆÊÅ¢Â§ç„ÄÇÈúÄË¶ÅÂÆûÁé∞‰∏â‰∏™ÊñπÊ≥ïÔºö</p>
<ul>
<li>tryÔºöËµÑÊ∫êÁöÑÊ£ÄÊµãÂíåÈ¢ÑÁïôÔºõ </li>
<li>confirmÔºöÂÆåÊàêËµÑÊ∫êÊìç‰Ωú‰∏öÂä°ÔºõË¶ÅÊ±Ç try ÊàêÂäü confirm ‰∏ÄÂÆöË¶ÅËÉΩÊàêÂäü„ÄÇ </li>
<li>cancelÔºöÈ¢ÑÁïôËµÑÊ∫êÈáäÊîæÔºåÂèØ‰ª•ÁêÜËß£‰∏∫tryÁöÑÂèçÂêëÊìç‰Ωú„ÄÇ</li>
</ul>
<p>‰∏æ‰æã:</p>
<p><img src="/img/blogs/java/springcloud/7.1.8.png" srcset="/img/loading.gif" lazyload></p>
<p>TCCÂ∑•‰ΩúÊ®°ÂûãÂõæÔºö</p>
<p><img src="/img/blogs/java/springcloud/7.1.9.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>ÂÅáÂ¶Ç‰∏Ä‰∏™ÂàÜÂ∏ÉÂºè‰∫ãÂä°‰∏≠ÂåÖÂê´‰∏§‰∏™ÂàÜÊîØ‰∫ãÂä°ÔºåtryÈò∂ÊÆµÔºå‰∏Ä‰∏™ÂàÜÊîØÊàêÂäüÊâßË°åÔºåÂè¶‰∏Ä‰∏™ÂàÜÊîØ‰∫ãÂä°ÈòªÂ°û</li>
<li>Â¶ÇÊûúÈòªÂ°ûÊó∂Èó¥Â§™ÈïøÔºåÂèØËÉΩÂØºËá¥ÂÖ®Â±Ä‰∫ãÂä°Ë∂ÖÊó∂ËÄåËß¶Âèë‰∫åÈò∂ÊÆµÁöÑcancelÊìç‰Ωú„ÄÇ‰∏§‰∏™ÂàÜÊîØ‰∫ãÂä°ÈÉΩ‰ºöÊâßË°åcancelÊìç‰Ωú</li>
<li>Ë¶ÅÁü•ÈÅìÔºåÂÖ∂‰∏≠‰∏Ä‰∏™ÂàÜÊîØÊòØÊú™ÊâßË°åtryÊìç‰ΩúÁöÑÔºåÁõ¥Êé•ÊâßË°å‰∫ÜcancelÊìç‰ΩúÔºåÂèçËÄå‰ºöÂØºËá¥Êï∞ÊçÆÈîôËØØ„ÄÇÂõ†Ê≠§ÔºåËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÂ∞ΩÁÆ°cancelÊñπÊ≥ïË¶ÅÊâßË°åÔºå‰ΩÜÂÖ∂‰∏≠‰∏çËÉΩÂÅö‰ªª‰ΩïÂõûÊªöÊìç‰ΩúÔºåËøôÂ∞±ÊòØÁ©∫ÂõûÊªö</li>
<li>ÂØπ‰∫éÊï¥‰∏™Á©∫ÂõûÊªöÁöÑÂàÜÊîØ‰∫ãÂä°ÔºåÂ∞ÜÊù•tryÊñπÊ≥ïÈòªÂ°ûÁªìÊùü‰æùÁÑ∂‰ºöÊâßË°å„ÄÇ‰ΩÜÊòØÊï¥‰∏™ÂÖ®Â±Ä‰∫ãÂä°ÂÖ∂ÂÆûÂ∑≤ÁªèÁªìÊùü‰∫ÜÔºåÂõ†Ê≠§Ê∞∏Ëøú‰∏ç‰ºöÂÜçÊúâconfirmÊàñcancelÔºå‰πüÂ∞±ÊòØËØ¥Ëøô‰∏™‰∫ãÂä°ÊâßË°å‰∫Ü‰∏ÄÂçäÔºåÂ§Ñ‰∫éÊÇ¨ÊåÇÁä∂ÊÄÅÔºåËøôÂ∞±ÊòØ‰∏öÂä°ÊÇ¨ÊåÇÈóÆÈ¢ò</li>
</ul>
<h4 id="ÊÄªÁªì"><a href="#ÊÄªÁªì" class="headerlink" title="ÊÄªÁªì"></a>ÊÄªÁªì</h4><p>TCCÊ®°ÂºèÁöÑÊØè‰∏™Èò∂ÊÆµÊòØÂÅö‰ªÄ‰πàÁöÑÔºü</p>
<ul>
<li>TryÔºöËµÑÊ∫êÊ£ÄÊü•ÂíåÈ¢ÑÁïô</li>
<li>ConfirmÔºö‰∏öÂä°ÊâßË°åÂíåÊèê‰∫§</li>
<li>CancelÔºöÈ¢ÑÁïôËµÑÊ∫êÁöÑÈáäÊîæ</li>
</ul>
<p>TCCÁöÑ‰ºòÁÇπÊòØ‰ªÄ‰πàÔºü</p>
<ul>
<li>‰∏ÄÈò∂ÊÆµÂÆåÊàêÁõ¥Êé•Êèê‰∫§‰∫ãÂä°ÔºåÈáäÊîæÊï∞ÊçÆÂ∫ìËµÑÊ∫êÔºåÊÄßËÉΩÂ•Ω</li>
<li>Áõ∏ÊØîATÊ®°ÂûãÔºåÊó†ÈúÄÁîüÊàêÂø´ÁÖßÔºåÊó†ÈúÄ‰ΩøÁî®ÂÖ®Â±ÄÈîÅÔºåÊÄßËÉΩÊúÄÂº∫</li>
<li>‰∏ç‰æùËµñÊï∞ÊçÆÂ∫ì‰∫ãÂä°ÔºåËÄåÊòØ‰æùËµñË°•ÂÅøÊìç‰ΩúÔºåÂèØ‰ª•Áî®‰∫éÈùû‰∫ãÂä°ÂûãÊï∞ÊçÆÂ∫ì</li>
</ul>
<p>TCCÁöÑÁº∫ÁÇπÊòØ‰ªÄ‰πàÔºü</p>
<ul>
<li>Êúâ‰ª£Á†Å‰æµÂÖ•ÔºåÈúÄË¶Å‰∫∫‰∏∫ÁºñÂÜôtry„ÄÅConfirmÂíåCancelÊé•Âè£ÔºåÂ§™È∫ªÁÉ¶</li>
<li>ËΩØÁä∂ÊÄÅÔºå‰∫ãÂä°ÊòØÊúÄÁªà‰∏ÄËá¥</li>
<li>ÈúÄË¶ÅËÄÉËôëConfirmÂíåCancelÁöÑÂ§±Ë¥•ÊÉÖÂÜµÔºåÂÅöÂ•ΩÂπÇÁ≠âÂ§ÑÁêÜ„ÄÅ‰∫ãÂä°ÊÇ¨ÊåÇÂíåÁ©∫ÂõûÊªöÂ§ÑÁêÜ</li>
</ul>
<h3 id="1-5-ÊúÄÂ§ßÂä™ÂäõÈÄöÁü•"><a href="#1-5-ÊúÄÂ§ßÂä™ÂäõÈÄöÁü•" class="headerlink" title="1.5 ÊúÄÂ§ßÂä™ÂäõÈÄöÁü•"></a>1.5 ÊúÄÂ§ßÂä™ÂäõÈÄöÁü•</h3><p>ÊúÄÂ§ßÂä™ÂäõÈÄöÁü•ÊòØ‰∏ÄÁßçÊúÄÁªà‰∏ÄËá¥ÊÄßÁöÑÂàÜÂ∏ÉÂºè‰∫ãÂä°Ëß£ÂÜ≥ÊñπÊ°à„ÄÇÈ°æÊòéÊÄùËÆÆÔºåÂ∞±ÊòØÈÄöËøáÊ∂àÊÅØÈÄöÁü•ÁöÑÊñπÂºèÊù•ÈÄöÁü•‰∫ãÂä°ÂèÇ‰∏éËÄÖÂÆåÊàê‰∏öÂä°ÊâßË°åÔºåÂ¶ÇÊûúÊâßË°åÂ§±Ë¥•‰ºöÂ§öÊ¨°ÈÄöÁü•„ÄÇÊó†ÈúÄ‰ªª‰ΩïÂàÜÂ∏ÉÂºè‰∫ãÂä°ÁªÑ‰ª∂‰ªãÂÖ•„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/7.1.10.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="2-Ê≥®ÂÜå‰∏≠ÂøÉ"><a href="#2-Ê≥®ÂÜå‰∏≠ÂøÉ" class="headerlink" title="2. Ê≥®ÂÜå‰∏≠ÂøÉ"></a>2. Ê≥®ÂÜå‰∏≠ÂøÉ</h2><h3 id="2-1-ÁéØÂ¢ÉÈöîÁ¶ª"><a href="#2-1-ÁéØÂ¢ÉÈöîÁ¶ª" class="headerlink" title="2.1 ÁéØÂ¢ÉÈöîÁ¶ª"></a>2.1 ÁéØÂ¢ÉÈöîÁ¶ª</h3><p>‰ºÅ‰∏öÂÆûÈôÖÂºÄÂèë‰∏≠ÔºåÂæÄÂæÄ‰ºöÊê≠Âª∫Â§ö‰∏™ËøêË°åÁéØÂ¢ÉÔºå‰æãÂ¶ÇÔºöÂºÄÂèëÁéØÂ¢É„ÄÅÊµãËØïÁéØÂ¢É„ÄÅÂèëÂ∏ÉÁéØÂ¢É„ÄÇ‰∏çÂêåÁéØÂ¢É‰πãÈó¥ÈúÄË¶ÅÈöîÁ¶ª„ÄÇÊàñËÄÖ‰∏çÂêåÈ°πÁõÆ‰ΩøÁî®‰∫Ü‰∏ÄÂ•óNacosÔºå‰∏çÂêåÈ°πÁõÆ‰πãÈó¥Ë¶ÅÂÅöÁéØÂ¢ÉÈöîÁ¶ª„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/7.2.1.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>Nacos‰∏≠ÂèØ‰ª•ÈÖçÁΩÆÂ§ö‰∏™namespaceÔºåÁõ∏‰∫í‰πãÈó¥ÂÆåÂÖ®ÈöîÁ¶ª„ÄÇÈªòËÆ§ÁöÑnamespaceÂêç‰∏∫public</li>
<li>namespace‰∏ãËøòÂèØ‰ª•ÁªßÁª≠ÂàÜÁªÑÔºå‰πüÂ∞±ÊòØgroup ÔºåÁõ∏‰∫íÈöîÁ¶ª„ÄÇ ÈªòËÆ§ÁöÑgroupÊòØDEFAULT_GROUP</li>
<li>group‰πã‰∏ãÂ∞±ÊòØÊúçÂä°ÂíåÈÖçÁΩÆ‰∫Ü</li>
</ul>
<h3 id="2-2-ÂàÜÁ∫ßÊ®°Âûã"><a href="#2-2-ÂàÜÁ∫ßÊ®°Âûã" class="headerlink" title="2.2 ÂàÜÁ∫ßÊ®°Âûã"></a>2.2 ÂàÜÁ∫ßÊ®°Âûã</h3><p>Âú®‰∏Ä‰∫õÂ§ßÂûãÂ∫îÁî®‰∏≠ÔºåÂêå‰∏Ä‰∏™ÊúçÂä°ÂèØ‰ª•ÈÉ®ÁΩ≤ÂæàÂ§öÂÆû‰æã„ÄÇËÄåËøô‰∫õÂÆû‰æãÂèØËÉΩÂàÜÂ∏ÉÂú®ÂÖ®ÂõΩÂêÑÂú∞ÁöÑ‰∏çÂêåÊú∫Êàø„ÄÇÁî±‰∫éÂ≠òÂú®Âú∞ÂüüÂ∑ÆÂºÇÔºåÁΩëÁªú‰º†ËæìÁöÑÈÄüÂ∫¶‰ºöÊúâÂæàÂ§ß‰∏çÂêåÔºåÂõ†Ê≠§Âú®ÂÅöÊúçÂä°Ê≤ªÁêÜÊó∂ÈúÄË¶ÅÂå∫ÂàÜ‰∏çÂêåÊú∫ÊàøÁöÑÂÆû‰æã„ÄÇ</p>
<p>Nacos‰∏≠Êèê‰æõ‰∫ÜÈõÜÁæ§ÔºàclusterÔºâÁöÑÊ¶ÇÂøµÔºåÊù•ÂØπÂ∫î‰∏çÂêåÊú∫Êàø„ÄÇ‰πüÂ∞±ÊòØËØ¥Ôºå‰∏Ä‰∏™ÊúçÂä°ÔºàserviceÔºâ‰∏ãÂèØ‰ª•ÊúâÂæàÂ§öÈõÜÁæ§ÔºàclusterÔºâÔºåËÄå‰∏Ä‰∏™ÈõÜÁæ§ÔºàclusterÔºâ‰∏≠‰∏ãÂèàÂèØ‰ª•ÂåÖÂê´ÂæàÂ§öÂÆû‰æãÔºàinstanceÔºâ„ÄÇ</p>
<p><img src="/img/blogs/java/springcloud/7.2.2.png" srcset="/img/loading.gif" lazyload></p>
<p>‰ªª‰Ωï‰∏Ä‰∏™ÂæÆÊúçÂä°ÁöÑÂÆû‰æãÂú®Ê≥®ÂÜåÂà∞NacosÊó∂ÔºåÈÉΩ‰ºöÁîüÊàê‰ª•‰∏ãÂá†‰∏™‰ø°ÊÅØÔºåÁî®Êù•Á°ÆËÆ§ÂΩìÂâçÂÆû‰æãÁöÑË∫´‰ªΩÔºå‰ªéÂ§ñÂà∞ÂÜÖ‰æùÊ¨°ÊòØÔºö</p>
<ul>
<li><p>namespaceÔºöÂëΩÂêçÁ©∫Èó¥</p>
</li>
<li><p>groupÔºöÂàÜÁªÑ</p>
</li>
<li><p>serviceÔºöÊúçÂä°Âêç</p>
</li>
<li><p>clusterÔºöÈõÜÁæ§</p>
</li>
<li><p>instanceÔºöÂÆû‰æãÔºåÂåÖÂê´ipÂíåÁ´ØÂè£<br>ËøôÂ∞±ÊòØnacos‰∏≠ÁöÑÊúçÂä°ÂàÜÁ∫ßÊ®°Âûã„ÄÇ</p>
</li>
<li><p>Âú®NacosÂÜÖÈÉ®‰ºöÊúâ‰∏Ä‰∏™ÊúçÂä°ÂÆû‰æãÁöÑÊ≥®ÂÜåË°®ÔºåÊòØÂü∫‰∫éMapÂÆûÁé∞ÁöÑÔºåÂÖ∂ÁªìÊûÑ‰∏éÂàÜÁ∫ßÊ®°ÂûãÁöÑÂØπÂ∫îÂÖ≥Á≥ªÂ¶Ç‰∏ãÔºö</p>
</li>
</ul>
<p><img src="/img/blogs/java/springcloud/7.2.3.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="3-ËøúÁ®ãË∞ÉÁî®"><a href="#3-ËøúÁ®ãË∞ÉÁî®" class="headerlink" title="3. ËøúÁ®ãË∞ÉÁî®"></a>3. ËøúÁ®ãË∞ÉÁî®</h2><h3 id="3-1-Ë¥üËΩΩÂùáË°°ÂéüÁêÜ"><a href="#3-1-Ë¥üËΩΩÂùáË°°ÂéüÁêÜ" class="headerlink" title="3.1 Ë¥üËΩΩÂùáË°°ÂéüÁêÜ"></a>3.1 Ë¥üËΩΩÂùáË°°ÂéüÁêÜ</h3><p>OpenFeignÂú®Êï¥ÂêàSpringCloudLoadBalancerÊó∂Ôºå‰∏éÊàë‰ª¨ÊâãÂä®ÊúçÂä°ÂèëÁé∞„ÄÅÂ§çÊùÇÂùáË°°ÁöÑÊµÅÁ®ãÁ±ª‰ºº„ÄÇ</p>
<ol>
<li>Ëé∑ÂèñserviceIdÔºå‰πüÂ∞±ÊòØÊúçÂä°ÂêçÁß∞</li>
<li>Ê†πÊçÆserviceIdÊãâÂèñÊúçÂä°ÂàóË°®</li>
<li>Âà©Áî®Ë¥üËΩΩÂùáË°°ÁÆóÊ≥ïÈÄâÊã©‰∏Ä‰∏™ÊúçÂä°</li>
<li>ÈáçÊûÑËØ∑Ê±ÇÁöÑURLË∑ØÂæÑÔºåÂèëËµ∑ËøúÁ®ãË∞ÉÁî®</li>
</ol>
<p><strong>Ë¥üËΩΩÂùáË°°ÂéüÁêÜ</strong>Ôºö</p>
<p><img src="/img/blogs/java/springcloud/7.3.1.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="ÂàáÊç¢Ë¥üËΩΩÂùáË°°Á≠ñÁï•"><a href="#ÂàáÊç¢Ë¥üËΩΩÂùáË°°Á≠ñÁï•" class="headerlink" title="ÂàáÊç¢Ë¥üËΩΩÂùáË°°Á≠ñÁï•"></a>ÂàáÊç¢Ë¥üËΩΩÂùáË°°Á≠ñÁï•</h4><h2 id="4-ÊúçÂä°‰øùÊä§"><a href="#4-ÊúçÂä°‰øùÊä§" class="headerlink" title="4. ÊúçÂä°‰øùÊä§"></a>4. ÊúçÂä°‰øùÊä§</h2><h3 id="4-1-Á∫øÁ®ãÈöîÁ¶ª"><a href="#4-1-Á∫øÁ®ãÈöîÁ¶ª" class="headerlink" title="4.1 Á∫øÁ®ãÈöîÁ¶ª"></a>4.1 Á∫øÁ®ãÈöîÁ¶ª</h3><p>Á∫øÁ®ãÈöîÁ¶ªÊúâ‰∏§ÁßçÊñπÂºèÂÆûÁé∞Ôºö</p>
<ul>
<li>Á∫øÁ®ãÊ±†ÈöîÁ¶ª(HystixÈªòËÆ§ÈááÁî®)ÔºöÁªôÊØè‰∏™ÊúçÂä°Ë∞ÉÁî®‰∏öÂä°ÂàÜÈÖç‰∏Ä‰∏™Á∫øÁ®ãÊ±†ÔºåÂà©Áî®Á∫øÁ®ãÊ±†Êú¨Ë∫´ÂÆûÁé∞ÈöîÁ¶ªÊïàÊûú</li>
<li>‰ø°Âè∑ÈáèÈöîÁ¶ª(SentinelÈªòËÆ§‰ΩøÁî®)Ôºö‰∏çÂàõÂª∫Á∫øÁ®ãÊ±†ÔºåËÄåÊòØËÆ°Êï∞Âô®Ê®°ÂºèÔºåËÆ∞ÂΩï‰∏öÂä°‰ΩøÁî®ÁöÑÁ∫øÁ®ãÊï∞ÈáèÔºåËææÂà∞‰ø°Âè∑Èáè‰∏äÈôêÊó∂ÔºåÁ¶ÅÊ≠¢Êñ∞ÁöÑËØ∑Ê±Ç</li>
</ul>
<p><img src="/img/blogs/java/springcloud/7.4.1.png" srcset="/img/loading.gif" lazyload></p>
<p><strong>SentinelÁöÑÁ∫øÁ®ãÈöîÁ¶ª‰∏éHystixÁöÑÁ∫øÁ®ãÈöîÁ¶ªÊúâ‰ªÄ‰πàÂ∑ÆÂà´?</strong></p>
<ul>
<li>ÈóÆÈ¢òËØ¥ÊòéÔºöËÄÉÂØüÂØπÁ∫øÁ®ãÈöîÁ¶ªÊñπÊ°àÁöÑÊéåÊè°ÊÉÖÂÜµ</li>
<li>ÈöæÊòìÁ®ãÂ∫¶Ôºö‰∏ÄËà¨</li>
<li>ÂèÇËÄÉËØùÊúØÔºö<ul>
<li>Á≠îÔºöÁ∫øÁ®ãÈöîÁ¶ªÂèØ‰ª•ÈááÁî®Á∫øÁ®ãÊ±†ÈöîÁ¶ªÊàñËÄÖ‰ø°Âè∑ÈáèÈöîÁ¶ª„ÄÇ<ul>
<li>HystixÈªòËÆ§ÊòØÂü∫‰∫éÁ∫øÁ®ãÊ±†ÂÆûÁé∞ÁöÑÁ∫øÁ®ãÈöîÁ¶ªÔºåÊØè‰∏Ä‰∏™Ë¢´ÈöîÁ¶ªÁöÑ‰∏öÂä°ÈÉΩË¶ÅÂàõÂª∫‰∏Ä‰∏™Áã¨Á´ãÁöÑÁ∫øÁ®ãÊ±†ÔºåÁ∫øÁ®ãËøáÂ§ö‰ºöÂ∏¶Êù•È¢ùÂ§ñÁöÑCPUÂºÄÈîÄÔºåÊÄßËÉΩ‰∏ÄËà¨Ôºå‰ΩÜÊòØÈöîÁ¶ªÊÄßÊõ¥Âº∫„ÄÇ</li>
<li>SentinelÂàôÊòØÂü∫‰∫é‰ø°Âè∑ÈáèÈöîÁ¶ªÁöÑÂéüÁêÜÔºåËøôÁßçÊñπÂºè‰∏çÁî®ÂàõÂª∫Á∫øÁ®ãÊ±†ÔºåÊÄßËÉΩËæÉÂ•ΩÔºå‰ΩÜÊòØÈöîÁ¶ªÊÄß‰∏ÄËà¨„ÄÇ</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="4-2-ÊªëÂä®Á™óÂè£ÁÆóÊ≥ï"><a href="#4-2-ÊªëÂä®Á™óÂè£ÁÆóÊ≥ï" class="headerlink" title="4.2 ÊªëÂä®Á™óÂè£ÁÆóÊ≥ï"></a>4.2 ÊªëÂä®Á™óÂè£ÁÆóÊ≥ï</h3><p>Âú®ÁÜîÊñ≠ÂäüËÉΩ‰∏≠ÔºåÈúÄË¶ÅÁªüËÆ°ÂºÇÂ∏∏ËØ∑Ê±ÇÊàñÊÖ¢ËØ∑Ê±ÇÊØî‰æãÔºå‰πüÂ∞±ÊòØËÆ°Êï∞„ÄÇÂú®ÈôêÊµÅÁöÑÊó∂ÂÄôÔºåË¶ÅÁªüËÆ°ÊØèÁßíÈíüÁöÑQPSÔºåÂêåÊ†∑ÊòØËÆ°Êï∞„ÄÇÂèØËßÅËÆ°Êï∞ÁÆóÊ≥ïÂú®ÁÜîÊñ≠ÈôêÊµÅ‰∏≠ÁöÑÂ∫îÁî®ÈùûÂ∏∏Â§ö„ÄÇsentinel‰∏≠ÈááÁî®ÁöÑËÆ°Êï∞Âô®ÁÆóÊ≥ïÂ∞±ÊòØÊªëÂä®Á™óÂè£ËÆ°Êï∞ÁÆóÊ≥ï„ÄÇ</p>
<h4 id="4-2-1-Âõ∫ÂÆöÁ™óÂè£ËÆ°Êï∞"><a href="#4-2-1-Âõ∫ÂÆöÁ™óÂè£ËÆ°Êï∞" class="headerlink" title="4.2.1 Âõ∫ÂÆöÁ™óÂè£ËÆ°Êï∞"></a>4.2.1 Âõ∫ÂÆöÁ™óÂè£ËÆ°Êï∞</h4><p>Âõ∫ÂÆöÁ™óÂè£ËÆ°Êï∞Âô®ÁÆóÊ≥ïÊ¶ÇÂøµÂ¶Ç‰∏ãÔºö</p>
<ul>
<li>Â∞ÜÊó∂Èó¥ÂàíÂàÜ‰∏∫Â§ö‰∏™Á™óÂè£ÔºåÁ™óÂè£Êó∂Èó¥Ë∑®Â∫¶Áß∞‰∏∫IntervalÔºåÊú¨‰æã‰∏≠‰∏∫1000msÔºõ</li>
<li>ÊØè‰∏™Á™óÂè£ÂàÜÂà´ËÆ°Êï∞ÁªüËÆ°ÔºåÊØèÊúâ‰∏ÄÊ¨°ËØ∑Ê±ÇÂ∞±Â∞ÜËÆ°Êï∞Âô®Âä†‰∏ÄÔºåÈôêÊµÅÂ∞±ÊòØËÆæÁΩÆËÆ°Êï∞Âô®ÈòàÂÄºÔºåÊú¨‰æã‰∏∫3</li>
<li>Â¶ÇÊûúËÆ°Êï∞Âô®Ë∂ÖËøá‰∫ÜÈôêÊµÅÈòàÂÄºÔºåÂàôË∂ÖÂá∫ÈòàÂÄºÁöÑËØ∑Ê±ÇÈÉΩË¢´‰∏¢ÂºÉ„ÄÇ</li>
</ul>
<p><img src="/img/blogs/java/springcloud/7.4.2.png" srcset="/img/loading.gif" lazyload></p>
<h4 id="4-2-2-ÊªëÂä®Á™óÂè£ÁÆóÊ≥ï"><a href="#4-2-2-ÊªëÂä®Á™óÂè£ÁÆóÊ≥ï" class="headerlink" title="4.2.2 ÊªëÂä®Á™óÂè£ÁÆóÊ≥ï"></a>4.2.2 ÊªëÂä®Á™óÂè£ÁÆóÊ≥ï</h4><p>Âõ∫ÂÆöÊó∂Èó¥Á™óÂè£ÁÆóÊ≥ï‰∏≠Á™óÂè£ÊúâÂæàÂ§öÔºåÂÖ∂Ë∑®Â∫¶Âíå‰ΩçÁΩÆÊòØ‰∏éÊó∂Èó¥Âå∫Èó¥ÁªëÂÆöÔºåÂõ†Ê≠§ÊòØÂæàÂ§öÂõ∫ÂÆö‰∏çÂä®ÁöÑÁ™óÂè£„ÄÇËÄåÊªëÂä®Êó∂Èó¥Á™óÂè£ÁÆóÊ≥ï‰∏≠Âè™ÂåÖÂê´1‰∏™Âõ∫ÂÆöË∑®Â∫¶ÁöÑÁ™óÂè£Ôºå‰ΩÜÁ™óÂè£ÊòØÂèØÁßªÂä®Âä®ÁöÑÔºå‰∏éÊó∂Èó¥Âå∫Èó¥Êó†ÂÖ≥„ÄÇ</p>
<p>ÊªëÂä®Á™óÂè£ËÆ°Êï∞Âô®ÁÆóÊ≥ï‰ºöÂ∞Ü‰∏Ä‰∏™Á™óÂè£ÂàíÂàÜ‰∏∫n‰∏™Êõ¥Â∞èÁöÑÂå∫Èó¥Ôºå‰æãÂ¶Ç</p>
<ul>
<li>Á™óÂè£Êó∂Èó¥Ë∑®Â∫¶Interval‰∏∫1ÁßíÔºõÂå∫Èó¥Êï∞Èáè n &#x3D; 2 ÔºåÂàôÊØè‰∏™Â∞èÂå∫Èó¥Êó∂Èó¥Ë∑®Â∫¶‰∏∫500msÔºåÊØè‰∏™Âå∫Èó¥ÈÉΩÊúâËÆ°Êï∞Âô®</li>
<li>ÈôêÊµÅÈòàÂÄº‰æùÁÑ∂‰∏∫3ÔºåÊó∂Èó¥Á™óÂè£Ôºà1ÁßíÔºâÂÜÖËØ∑Ê±ÇË∂ÖËøáÈòàÂÄºÊó∂ÔºåË∂ÖÂá∫ÁöÑËØ∑Ê±ÇË¢´ÈôêÊµÅ</li>
<li>Á™óÂè£‰ºöÊ†πÊçÆÂΩìÂâçËØ∑Ê±ÇÊâÄÂú®Êó∂Èó¥ÔºàcurrentTimeÔºâÁßªÂä®ÔºåÁ™óÂè£ËåÉÂõ¥ÊòØ‰ªéÔºàcurrentTime-IntervalÔºâ‰πãÂêéÁöÑÁ¨¨‰∏Ä‰∏™Êó∂Âå∫ÂºÄÂßãÔºåÂà∞currentTimeÊâÄÂú®Êó∂Âå∫ÁªìÊùü„ÄÇ</li>
</ul>
<p><img src="/img/blogs/java/springcloud/7.4.3.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="4-3-ÊºèÊ°∂ÁÆóÊ≥ï"><a href="#4-3-ÊºèÊ°∂ÁÆóÊ≥ï" class="headerlink" title="4.3 ÊºèÊ°∂ÁÆóÊ≥ï"></a>4.3 ÊºèÊ°∂ÁÆóÊ≥ï</h3><p>ÊºèÊ°∂ÁÆóÊ≥ïËØ¥ÊòéÔºö</p>
<ul>
<li>Â∞ÜÊØè‰∏™ËØ∑Ê±ÇËßÜ‰Ωú‚ÄùÊ∞¥Êª¥‚ÄùÊîæÂÖ•‚ÄùÊºèÊ°∂‚ÄùËøõË°åÂ≠òÂÇ®Ôºõ</li>
<li>‚ÄúÊºèÊ°∂‚Äù‰ª•Âõ∫ÂÆöÈÄüÁéáÂêëÂ§ñ‚ÄùÊºè‚ÄùÂá∫ËØ∑Ê±ÇÊù•ÊâßË°åÔºåÂ¶ÇÊûú‚ÄùÊºèÊ°∂‚ÄùÁ©∫‰∫ÜÂàôÂÅúÊ≠¢‚ÄùÊºèÊ∞¥‚ÄùÔºõ</li>
<li>Â¶ÇÊûú‚ÄùÊºèÊ°∂‚ÄùÊª°‰∫ÜÂàôÂ§ö‰ΩôÁöÑ‚ÄùÊ∞¥Êª¥‚Äù‰ºöË¢´Áõ¥Êé•‰∏¢ÂºÉ„ÄÇ</li>
<li>ÂèØ‰ª•ÁêÜËß£ÊàêËØ∑Ê±ÇÂú®Ê°∂ÂÜÖÊéíÈòüÁ≠âÂæÖ</li>
</ul>
<p><img src="/img/blogs/java/springcloud/7.4.4.png" srcset="/img/loading.gif" lazyload></p>
<p>SentinelÂÜÖÈÉ®Âü∫‰∫éÊºèÊ°∂ÁÆóÊ≥ïÂÆûÁé∞‰∫ÜÊéíÈòüÁ≠âÂæÖÊïàÊûúÔºåÊ°∂ÁöÑÂÆπÈáèÂèñÂÜ≥ÈôêÊµÅÁöÑQPSÈòàÂÄº‰ª•ÂèäÂÖÅËÆ∏Á≠âÂæÖÁöÑÊúÄÂ§ßË∂ÖÊó∂Êó∂Èó¥Ôºö<br>‰æãÂ¶ÇÔºöÈôêÊµÅQPS&#x3D;5ÔºåÈòüÂàóË∂ÖÊó∂Êó∂Èó¥‰∏∫2000ms„ÄÇÊàë‰ª¨ËÆ©ÊâÄÊúâËØ∑Ê±ÇËøõÂÖ•‰∏Ä‰∏™ÈòüÂàó‰∏≠ÔºåÂ¶ÇÂêåËøõÂÖ•ÊºèÊ°∂‰∏≠„ÄÇÁî±‰∫éÊºèÊ°∂ÊòØÂõ∫ÂÆöÈ¢ëÁéáÊâßË°åÔºåÂõ†Ê≠§QPS‰∏∫5Â∞±ÊòØÊØè200msÊâßË°å‰∏Ä‰∏™ËØ∑Ê±Ç„ÄÇÈÇ£Á¨¨N‰∏™ËØ∑Ê±ÇÁöÑÈ¢ÑÊúüÁöÑÊâßË°åÊó∂Èó¥ ÊòØÁ¨¨(N - 1) * 200ms„ÄÇÂ¶ÇÊûúËØ∑Ê±ÇÈ¢ÑÊúüÁöÑÊâßË°åÊó∂Èó¥Ë∂ÖÂá∫ÊúÄÂ§ßÊó∂Èïø2000msÔºåËØ¥Êòé‚ÄúÊ°∂Êª°‰∫Ü‚ÄùÔºåÊñ∞ÁöÑËØ∑Ê±ÇÂàô‰ºöË¢´ÊãíÁªù„ÄÇ</p>
<h3 id="4-4-‰ª§ÁâåÊ°∂ÁÆóÊ≥ï"><a href="#4-4-‰ª§ÁâåÊ°∂ÁÆóÊ≥ï" class="headerlink" title="4.4 ‰ª§ÁâåÊ°∂ÁÆóÊ≥ï"></a>4.4 ‰ª§ÁâåÊ°∂ÁÆóÊ≥ï</h3><p>ÈôêÊµÅÁöÑÂè¶‰∏ÄÁßçÂ∏∏ËßÅÁÆóÊ≥ïÊòØ‰ª§ÁâåÊ°∂ÁÆóÊ≥ï„ÄÇSentinel‰∏≠ÁöÑÁÉ≠ÁÇπÂèÇÊï∞ÈôêÊµÅÊ≠£ÊòØÂü∫‰∫é‰ª§ÁâåÊ°∂ÁÆóÊ≥ïÂÆûÁé∞ÁöÑ„ÄÇ</p>
<p>‰ª§ÁâåÊ°∂ÁÆóÊ≥ïËØ¥ÊòéÔºö</p>
<ul>
<li>‰ª•Âõ∫ÂÆöÁöÑÈÄüÁéáÁîüÊàê‰ª§ÁâåÔºåÂ≠òÂÖ•‰ª§ÁâåÊ°∂‰∏≠ÔºåÂ¶ÇÊûú‰ª§ÁâåÊ°∂Êª°‰∫Ü‰ª•ÂêéÔºåÂÅúÊ≠¢ÁîüÊàê</li>
<li>ËØ∑Ê±ÇËøõÂÖ•ÂêéÔºåÂøÖÈ°ªÂÖàÂ∞ùËØï‰ªéÊ°∂‰∏≠Ëé∑Âèñ‰ª§ÁâåÔºåËé∑ÂèñÂà∞‰ª§ÁâåÂêéÊâçÂèØ‰ª•Ë¢´Â§ÑÁêÜ</li>
<li>Â¶ÇÊûú‰ª§ÁâåÊ°∂‰∏≠Ê≤°Êúâ‰ª§ÁâåÔºåÂàôËØ∑Ê±ÇÁ≠âÂæÖÊàñ‰∏¢ÂºÉ</li>
</ul>
<p><img src="/img/blogs/java/springcloud/7.4.5.png" srcset="/img/loading.gif" lazyload></p>
<p>Âü∫‰∫é‰ª§ÁâåÊ°∂ÁÆóÊ≥ïÔºåÊØèÁßí‰∫ßÁîüÁöÑ‰ª§ÁâåÊï∞ÈáèÂü∫Êú¨Â∞±ÊòØQPS‰∏äÈôê„ÄÇ<br>ÂΩìÁÑ∂‰πüÊúâ‰æãÂ§ñÊÉÖÂÜµÔºå‰æãÂ¶ÇÔºö</p>
<ul>
<li>Êüê‰∏ÄÁßí‰ª§ÁâåÊ°∂‰∏≠‰∫ßÁîü‰∫ÜÂæàÂ§ö‰ª§ÁâåÔºåËææÂà∞‰ª§ÁâåÊ°∂‰∏äÈôêNÔºåÁºìÂ≠òÂú®‰ª§ÁâåÊ°∂‰∏≠Ôºå‰ΩÜÊòØËøô‰∏ÄÁßíÊ≤°ÊúâËØ∑Ê±ÇËøõÂÖ•„ÄÇ</li>
<li>‰∏ã‰∏ÄÁßíÁöÑÂâçÂçäÁßíÊ∂åÂÖ•‰∫ÜË∂ÖËøá2N‰∏™ËØ∑Ê±ÇÔºå‰πãÂâçÁºìÂ≠òÁöÑ‰ª§ÁâåÊ°∂ÁöÑ‰ª§ÁâåËÄóÂ∞ΩÔºåÂêåÊó∂Ëøô‰∏ÄÁßíÂèàÁîüÊàê‰∫ÜN‰∏™‰ª§ÁâåÔºå‰∫éÊòØÊÄªÂÖ±ÊîæË°å‰∫Ü2N‰∏™ËØ∑Ê±Ç„ÄÇË∂ÖÂá∫‰∫ÜÊàë‰ª¨ËÆæÂÆöÁöÑQPSÈòàÂÄº„ÄÇ<br>Âõ†Ê≠§ÔºåÂú®‰ΩøÁî®‰ª§ÁâåÊ°∂ÁÆóÊ≥ïÊó∂ÔºåÂ∞ΩÈáè‰∏çË¶ÅÂ∞Ü‰ª§Áâå‰∏äÈôêËÆæÂÆöÂà∞ÊúçÂä°ËÉΩÊâøÂèóÁöÑQPS‰∏äÈôê„ÄÇËÄåÊòØÈ¢ÑÁïô‰∏ÄÂÆöÁöÑÊ≥¢Âä®Á©∫Èó¥ÔºåËøôÊ†∑Êàë‰ª¨ÊâçËÉΩÂ∫îÂØπÁ™ÅÂèëÊµÅÈáè„ÄÇ</li>
</ul>
<h3 id="4-5-SentinelÁöÑÈôêÊµÅ‰∏éGatewayÁöÑÈôêÊµÅÊúâ‰ªÄ‰πàÂ∑ÆÂà´Ôºü"><a href="#4-5-SentinelÁöÑÈôêÊµÅ‰∏éGatewayÁöÑÈôêÊµÅÊúâ‰ªÄ‰πàÂ∑ÆÂà´Ôºü" class="headerlink" title="4.5 SentinelÁöÑÈôêÊµÅ‰∏éGatewayÁöÑÈôêÊµÅÊúâ‰ªÄ‰πàÂ∑ÆÂà´Ôºü"></a>4.5 SentinelÁöÑÈôêÊµÅ‰∏éGatewayÁöÑÈôêÊµÅÊúâ‰ªÄ‰πàÂ∑ÆÂà´Ôºü</h3><p>ÈóÆÈ¢òËØ¥ÊòéÔºöËÄÉÂØüÂØπÈôêÊµÅÁÆóÊ≥ïÁöÑÊéåÊè°ÊÉÖÂÜµ<br>ÈöæÊòìÁ®ãÂ∫¶ÔºöÈöæ<br>ÂèÇËÄÉËØùÊúØÔºö</p>
<ul>
<li>ÈôêÊµÅÁÆóÊ≥ïÂ∏∏ËßÅÁöÑÊúâ‰∏âÁßçÂÆûÁé∞ÔºöÊªëÂä®Êó∂Èó¥Á™óÂè£„ÄÅ‰ª§ÁâåÊ°∂ÁÆóÊ≥ï„ÄÅÊºèÊ°∂ÁÆóÊ≥ï„ÄÇGatewayÂàôÈááÁî®‰∫ÜÂü∫‰∫éRedisÂÆûÁé∞ÁöÑ‰ª§ÁâåÊ°∂ÁÆóÊ≥ï</li>
<li>ËÄåSentinelÂÜÖÈÉ®Âç¥ÊØîËæÉÂ§çÊùÇÔºö<ul>
<li>ÈªòËÆ§ÈôêÊµÅÊ®°ÂºèÊòØÂü∫‰∫éÊªëÂä®Êó∂Èó¥Á™óÂè£ÁÆóÊ≥ïÔºåÂè¶Â§ñSentinel‰∏≠Êñ≠Ë∑ØÂô®ÁöÑËÆ°Êï∞‰πüÊòØÂü∫‰∫éÊªëÂä®Êó∂Èó¥Á™óÂè£ÁÆóÊ≥ï</li>
<li>ÈôêÊµÅÂêéÂèØ‰ª•Âø´ÈÄüÂ§±Ë¥•ÂíåÊéíÈòüÁ≠âÂæÖÔºåÂÖ∂‰∏≠ÊéíÈòüÁ≠âÂæÖÂü∫‰∫éÊºèÊ°∂ÁÆóÊ≥ï</li>
<li>ËÄåÁÉ≠ÁÇπÂèÇÊï∞ÈôêÊµÅÂàôÊòØÂü∫‰∫é‰ª§ÁâåÊ°∂ÁÆóÊ≥ï</li>
</ul>
</li>
</ul>
<p>ÂºïÁî®Ôºö<a target="_blank" rel="noopener" href="https://b11et3un53m.feishu.cn/wiki/FYNkwb1i6i0qwCk7lF2caEq5nRe">https://b11et3un53m.feishu.cn/wiki/FYNkwb1i6i0qwCk7lF2caEq5nRe</a></p>
<h1 id="END"><a href="#END" class="headerlink" title="END"></a>END</h1>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/SpringCloud/" class="category-chain-item">SpringCloud</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/JAVA/" class="print-no-link">#JAVA</a>
      
        <a href="/tags/%E5%AD%A6%E4%B9%A0/" class="print-no-link">#Â≠¶‰π†</a>
      
        <a href="/tags/SpringCloud/" class="print-no-link">#SpringCloud</a>
      
    </div>
  
</div>


              

              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/04/08/JAVA/redis/" title="RedisÂ≠¶‰π†Á¨îËÆ∞ÂèäÈù¢ËØïÈóÆÈ¢òÂàÜÊûê">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">RedisÂ≠¶‰π†Á¨îËÆ∞ÂèäÈù¢ËØïÈóÆÈ¢òÂàÜÊûê</span>
                        <span class="visible-mobile">‰∏ä‰∏ÄÁØá</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/03/08/JAVA/SpringCloud/Elasticsearch/" title="ElasticsearchÂ≠¶‰π†Á¨îËÆ∞">
                        <span class="hidden-mobile">ElasticsearchÂ≠¶‰π†Á¨îËÆ∞</span>
                        <span class="visible-mobile">‰∏ã‰∏ÄÁØá</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"sj2tGuxMGSDhkN5hNuOIVta1-gzGzoHsz","appKey":"ysR5OTuTzoby2oNvNyGOtXFQ","path":"window.location.pathname","placeholder":"Â¶ÇÊúâÈóÆÈ¢òÔºåÊ¨¢ËøéÊåáÊ≠£~","avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>ÁõÆÂΩï</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">ÊêúÁ¥¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">ÂÖ≥ÈîÆËØç</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <span>AI</span> <i class="iconfont icon-love"></i> <span>CPP</span> <i class="iconfont icon-love"></i> <span>JAVA</span> <i class="iconfont icon-love"></i> <span>CyberSec</span> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        ÊÄªËÆøÈóÆÈáè 
        <span id="busuanzi_value_site_pv"></span>
         Ê¨°
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        ÊÄªËÆøÂÆ¢Êï∞ 
        <span id="busuanzi_value_site_uv"></span>
         ‰∫∫
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/love.js"></script>
<script src="//cdn.jsdelivr.net/gh/bynotes/texiao/source/js/xiaoxingxing.js"></script>
<script src="/js/bubble.js"></script>



<!-- ‰∏ªÈ¢òÁöÑÂêØÂä®È°πÔºåÂ∞ÜÂÆÉ‰øùÊåÅÂú®ÊúÄÂ∫ïÈÉ® -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">ÂçöÂÆ¢Âú®ÂÖÅËÆ∏ JavaScript ËøêË°åÁöÑÁéØÂ¢É‰∏ãÊµèËßàÊïàÊûúÊõ¥‰Ω≥</div>
  </noscript>
<!-- hexo injector body_end start --><script src="/js/backgroundize.js"></script><!-- hexo injector body_end end --></body>
</html>
